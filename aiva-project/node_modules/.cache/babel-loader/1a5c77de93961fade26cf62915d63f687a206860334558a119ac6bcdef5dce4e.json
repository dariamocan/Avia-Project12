{"ast":null,"code":"import React, { memo, useState, useRef, useEffect, useMemo } from 'react';\nfunction _extends() {\n  _extends = Object.assign || function (target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i];\n      for (var key in source) {\n        if (Object.prototype.hasOwnProperty.call(source, key)) {\n          target[key] = source[key];\n        }\n      }\n    }\n    return target;\n  };\n  return _extends.apply(this, arguments);\n}\nfunction _inheritsLoose(subClass, superClass) {\n  subClass.prototype = Object.create(superClass.prototype);\n  subClass.prototype.constructor = subClass;\n  _setPrototypeOf(subClass, superClass);\n}\nfunction _setPrototypeOf(o, p) {\n  _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) {\n    o.__proto__ = p;\n    return o;\n  };\n  return _setPrototypeOf(o, p);\n}\nfunction _objectWithoutPropertiesLoose(source, excluded) {\n  if (source == null) return {};\n  var target = {};\n  var sourceKeys = Object.keys(source);\n  var key, i;\n  for (i = 0; i < sourceKeys.length; i++) {\n    key = sourceKeys[i];\n    if (excluded.indexOf(key) >= 0) continue;\n    target[key] = source[key];\n  }\n  return target;\n}\nvar Remove = \"Quitar\";\nvar Quality = \"Calidad\";\nvar Format = \"Formato\";\nvar Crop = \"Recortar\";\nvar Save = \"Guardar\";\nvar Contrast = \"Contraste\";\nvar Blur = \"Blur\";\nvar Brightness = \"Brillo\";\nvar Grayscale = \"Scala de gris\";\nvar Saturate = \"Saturación\";\nvar Sepia = \"Sepia\";\nvar Rotate = \"Rotar\";\nvar Undo = \"Deshacer\";\nvar labelEs = {\n  \"Upload a image\": \"Suba una imagen\",\n  \"You must edit the image in order to resize it\": \"Debe editar la imagen para disminuir su tamaño\",\n  \"too large\": \"muy grande\",\n  \"Open the editor panel\": \"Abra el panel de edición\",\n  \"Download the image\": \"Descarge la imagen\",\n  \"Control Panel\": \"Panel de control\",\n  Remove: Remove,\n  Quality: Quality,\n  \"Max dimensions\": \"Dimensiones\",\n  \"aspect-ratio\": \"relación-aspecto\",\n  \"max-width(px)\": \"max. ancho\",\n  \"max-height(px)\": \"max. alto\",\n  Format: Format,\n  Crop: Crop,\n  \"width(px)\": \"ancho(px)\",\n  \"height(px)\": \"altura(px)\",\n  Save: Save,\n  Contrast: Contrast,\n  Blur: Blur,\n  Brightness: Brightness,\n  Grayscale: Grayscale,\n  Saturate: Saturate,\n  Sepia: Sepia,\n  Rotate: Rotate,\n  Undo: Undo\n};\nvar Quality$1 = \"Quality\";\nvar Format$1 = \"Format\";\nvar Crop$1 = \"Crop\";\nvar Remove$1 = \"Remove\";\nvar Save$1 = \"Save\";\nvar Contrast$1 = \"Contrast\";\nvar Blur$1 = \"Blur\";\nvar Brightness$1 = \"Brightness\";\nvar Grayscale$1 = \"Grayscale\";\nvar Saturate$1 = \"Saturate\";\nvar Sepia$1 = \"Sepia\";\nvar Rotate$1 = \"Rotate\";\nvar Undo$1 = \"Undo\";\nvar labelEn = {\n  \"Upload a image\": \"Upload a image\",\n  \"You must edit the image in order to resize it\": \"You must edit the image in order to resize it\",\n  \"too large\": \"too large\",\n  \"Open the editor panel\": \"Open the editor panel\",\n  \"Download the image\": \"Download the image\",\n  \"Control Panel\": \"Control Panel\",\n  Quality: Quality$1,\n  \"Max dimensions\": \"Max dimensions\",\n  \"aspect-ratio\": \"aspect-ratio\",\n  \"max-width(px)\": \"max-width(px)\",\n  \"max-height(px)\": \"max-height(px)\",\n  Format: Format$1,\n  Crop: Crop$1,\n  \"width(px)\": \"width(px)\",\n  \"height(px)\": \"height(px)\",\n  Remove: Remove$1,\n  Save: Save$1,\n  Contrast: Contrast$1,\n  Blur: Blur$1,\n  Brightness: Brightness$1,\n  Grayscale: Grayscale$1,\n  Saturate: Saturate$1,\n  Sepia: Sepia$1,\n  Rotate: Rotate$1,\n  Undo: Undo$1\n};\nvar Remove$2 = \"Supprimer\";\nvar Quality$2 = \"Qualité\";\nvar Format$2 = \"Format\";\nvar Crop$2 = \"Recadrer\";\nvar Save$2 = \"Sauvez\";\nvar Contrast$2 = \"Contraste\";\nvar Blur$2 = \"Blur\";\nvar Brightness$2 = \"Luminosité\";\nvar Grayscale$2 = \"Grayscale\";\nvar Saturate$2 = \"Saturer\";\nvar Sepia$2 = \"Seiche\";\nvar Undo$2 = \"Annuler\";\nvar labelFr = {\n  \"Upload a image\": \"Charger une image\",\n  \"You must edit the image in order to resize it\": \"Vous devez éditer l'image pour changer sa taille\",\n  \"too large\": \"Trop grande\",\n  \"Open the editor panel\": \"Ouvrir le panneau d'édition\",\n  \"Download the image\": \"Télécharger l'image\",\n  \"Control Panel\": \"Panneau de commande\",\n  Remove: Remove$2,\n  Quality: Quality$2,\n  \"Max dimensions\": \"Dimensions maximales\",\n  \"aspect-ratio\": \"rapport de forme\",\n  \"max-width(px)\": \"largeur max.\",\n  \"max-height(px)\": \"hauteur max\",\n  Format: Format$2,\n  Crop: Crop$2,\n  \"width(px)\": \"largeur(px)\",\n  \"height(px)\": \"hauteur(px)\",\n  Save: Save$2,\n  Contrast: Contrast$2,\n  Blur: Blur$2,\n  Brightness: Brightness$2,\n  Grayscale: Grayscale$2,\n  Saturate: Saturate$2,\n  Sepia: Sepia$2,\n  Undo: Undo$2\n};\nvar Quality$3 = \"Qualität\";\nvar Format$3 = \"Format\";\nvar Crop$3 = \"Zuschneiden\";\nvar Remove$3 = \"Entfernen\";\nvar Save$3 = \"Speichern\";\nvar Contrast$3 = \"Kontrast\";\nvar Blur$3 = \"Blur\";\nvar Brightness$3 = \"Helligkeit\";\nvar Grayscale$3 = \"Graustufen\";\nvar Saturer = \"Sättigen\";\nvar Sepia$3 = \"Tintenfisch\";\nvar Undo$3 = \"Undo\";\nvar labelDe = {\n  \"Upload a image\": \"Bild hochladen\",\n  \"You must edit the image in order to resize it\": \"Sie müssen das Bild bearbeiten, um seine Größe zu ändern\",\n  \"too large\": \"zu groß\",\n  \"Open the editor panel\": \"Editor-Fenster öffnen\",\n  \"Download the image\": \"Bild herunterladen\",\n  \"Control Panel\": \"Bedienfeld\",\n  Quality: Quality$3,\n  \"Max dimensions\": \"Maximale Größe\",\n  \"aspect-ratio\": \"Seitenverhältnis\",\n  \"max-width(px)\": \"Max. Breite(px)\",\n  \"max-height(px)\": \"Max. Höhe(px)\",\n  Format: Format$3,\n  Crop: Crop$3,\n  \"width(px)\": \"Breite(px)\",\n  \"height(px)\": \"Höhe(px)\",\n  Remove: Remove$3,\n  Save: Save$3,\n  Contrast: Contrast$3,\n  Blur: Blur$3,\n  Brightness: Brightness$3,\n  Grayscale: Grayscale$3,\n  Saturer: Saturer,\n  Sepia: Sepia$3,\n  Undo: Undo$3\n};\nvar MAX_BUFFER_UNDO_MEMORY = 25;\nvar convertImageUsingCanvas = function convertImageUsingCanvas(dataSrc, changeHeight, state, options) {\n  if (changeHeight === void 0) {\n    changeHeight = false;\n  }\n  return new Promise(function (resolve, _) {\n    try {\n      var img = document.createElement('img');\n      img.src = dataSrc + '';\n      img.crossOrigin = 'Anonymous';\n      var quality = state.quality / 100;\n      var maintainRatio = state.maintainAspectRatio;\n      img.onload = function () {\n        var canvas = document.createElement('canvas');\n        var ctx = canvas.getContext('2d');\n        var ratio = img.width / img.height;\n        var width = state.maxWidth;\n        var height = state.maxHeight;\n        if (options !== null && options !== void 0 && options.getDimFromImage) {\n          width = img.width;\n          height = img.height;\n        }\n        if (maintainRatio) {\n          canvas.width = width;\n          canvas.height = width / ratio;\n          if (changeHeight) {\n            canvas.width = height * ratio;\n            canvas.height = height;\n          }\n        } else {\n          canvas.width = width;\n          canvas.height = height;\n        }\n        if (state.basicFilters) {\n          ctx.filter = processFilter(state.basicFilters);\n        }\n        ctx.drawImage(img, 0, 0, canvas.width, canvas.height);\n        var type = state.format;\n        var dataURI = canvas.toDataURL(\"image/\" + type, quality);\n        resolve({\n          dataUri: dataURI,\n          width: canvas.width,\n          height: canvas.height\n        });\n      };\n      return Promise.resolve();\n    } catch (e) {\n      return Promise.reject(e);\n    }\n  }).then(function (data) {\n    state.maxHeight = data.height;\n    state.maxWidth = data.width;\n    return {\n      imageUri: data.dataUri,\n      state: saveState(state, data.dataUri)\n    };\n  });\n  function processFilter(data) {\n    return Object.keys(data).map(function (key) {\n      if (['blur'].includes(key)) {\n        return key + \"(\" + data[key] + \"px)\";\n      } else {\n        return key + \"(\" + data[key] + \")\";\n      }\n    }).join('');\n  }\n};\nvar saveState = function saveState(state, lastImage) {\n  if (state.arrayCopiedImages.length <= MAX_BUFFER_UNDO_MEMORY) {\n    state.arrayCopiedImages.push({\n      lastImage: lastImage,\n      width: state.maxWidth,\n      height: state.maxHeight,\n      quality: state.quality,\n      format: state.format,\n      originImageSrc: state.originImageSrc,\n      basicFilters: state.basicFilters\n    });\n  } else {\n    state.arrayCopiedImages[state.arrayCopiedImages.length - 1] = {\n      lastImage: lastImage,\n      width: state.maxWidth,\n      height: state.maxHeight,\n      quality: state.quality,\n      format: state.format,\n      originImageSrc: state.originImageSrc,\n      basicFilters: state.basicFilters\n    };\n  }\n  return JSON.parse(JSON.stringify(state));\n};\n\n// A type of promise-like that resolves synchronously and supports only one observer\n\nconst _iteratorSymbol = /*#__PURE__*/typeof Symbol !== \"undefined\" ? Symbol.iterator || (Symbol.iterator = Symbol(\"Symbol.iterator\")) : \"@@iterator\";\nconst _asyncIteratorSymbol = /*#__PURE__*/typeof Symbol !== \"undefined\" ? Symbol.asyncIterator || (Symbol.asyncIterator = Symbol(\"Symbol.asyncIterator\")) : \"@@asyncIterator\";\n\n// Asynchronously call a function and send errors to recovery continuation\nfunction _catch(body, recover) {\n  try {\n    var result = body();\n  } catch (e) {\n    return recover(e);\n  }\n  if (result && result.then) {\n    return result.then(void 0, recover);\n  }\n  return result;\n}\nvar TabContainer = memo(function (_ref) {\n  var _ref$activeIndex = _ref.activeIndex,\n    activeIndex = _ref$activeIndex === void 0 ? 0 : _ref$activeIndex,\n    children = _ref.children,\n    _ref$backgroundColor = _ref.backgroundColor,\n    backgroundColor = _ref$backgroundColor === void 0 ? 'inherit' : _ref$backgroundColor,\n    _ref$color = _ref.color,\n    color = _ref$color === void 0 ? '#428CFF' : _ref$color,\n    _ref$indicatorStyle = _ref.indicatorStyle,\n    indicatorStyle = _ref$indicatorStyle === void 0 ? 'bottomLine' : _ref$indicatorStyle,\n    _ref$onTabChange = _ref.onTabChange,\n    onTabChange = _ref$onTabChange === void 0 ? function (index) {} : _ref$onTabChange,\n    _ref$transitionMs = _ref.transitionMs,\n    transitionMs = _ref$transitionMs === void 0 ? 375 : _ref$transitionMs,\n    _ref$borderLine = _ref.borderLine,\n    borderLine = _ref$borderLine === void 0 ? false : _ref$borderLine,\n    _ref$fontColor = _ref.fontColor,\n    fontColor = _ref$fontColor === void 0 ? 'inherit' : _ref$fontColor,\n    _ref$lazy = _ref.lazy,\n    lazy = _ref$lazy === void 0 ? false : _ref$lazy;\n  var _useState = useState([]),\n    header = _useState[0],\n    setHeader = _useState[1];\n  var _useState2 = useState(activeIndex),\n    activeTab = _useState2[0],\n    setActiveTab = _useState2[1];\n  var tabContainerRef = useRef(null);\n  useEffect(function () {\n    var tabsItems = children instanceof Array ? children : [children];\n    checkChildrens(tabsItems);\n    var tabs = tabsItems.map(function (el) {\n      return {\n        label: el.props.name,\n        icon: el.props.icon,\n        disabled: el.props.disabled\n      };\n    });\n    if (activeIndex > tabs.length - 1 || activeIndex < 0) throw new Error(\"Invalid range for activeIndex \" + activeIndex);\n    setHeader(tabs);\n  }, [children]);\n  useEffect(function () {\n    var _tabsItems$activeInde, _tabsItems$activeInde2;\n    var tabsItems = children instanceof Array ? children : [children];\n    if (activeIndex > tabsItems.length - 1 || activeIndex < 0) throw new Error(\"Invalid range for activeIndex \" + activeIndex);\n    setActiveTab((_tabsItems$activeInde = tabsItems[activeIndex]) !== null && _tabsItems$activeInde !== void 0 && (_tabsItems$activeInde2 = _tabsItems$activeInde.props) !== null && _tabsItems$activeInde2 !== void 0 && _tabsItems$activeInde2.disabled ? 0 : activeIndex);\n  }, [activeIndex]);\n  useEffect(function () {\n    if (header && header.length) {\n      onTabChange(activeTab);\n    }\n  }, [activeTab]);\n  function checkChildrens(data) {\n    try {\n      data.map(function (el) {\n        if (!el.props.name) throw new Error('Inside of TabContainer component only can be rendered TabItem component, and its need a name prop');\n        return true;\n      });\n    } catch (e) {\n      throw new Error(\"The TabContainer Component must has a TabItem as child component\");\n    }\n  }\n  var tabsItems = children instanceof Array ? children : [children];\n  return React.createElement(\"div\", {\n    ref: tabContainerRef,\n    className: \"tab-pp\"\n  }, React.createElement(\"div\", {\n    className: \"header\",\n    style: {\n      backgroundColor: backgroundColor,\n      borderBottom: borderLine ? '1px solid #323232' : 'undet'\n    }\n  }, header.map(function (el, index) {\n    return React.createElement(\"button\", {\n      onClick: function onClick() {\n        if (el.disabled) return;\n        setActiveTab(index);\n      },\n      key: el.label,\n      style: {\n        color: index == activeTab && (indicatorStyle === 'simple' || indicatorStyle === 'bottomLine') ? color : fontColor,\n        backgroundColor: index == activeTab && indicatorStyle === 'button' ? color : 'inherit'\n      },\n      className: index == activeTab ? \"itemlabel \" + indicatorStyle + \" active\" : 'itemlabel',\n      disabled: el.disabled\n    }, el.icon, \" \", el.label, indicatorStyle === 'bottomLine' && React.createElement(\"div\", {\n      style: {\n        backgroundColor: color\n      }\n    }));\n  })), React.createElement(\"div\", {\n    className: \"body\"\n  }, tabsItems.map(function (tabEl, index) {\n    if (index < activeTab) {\n      return React.createElement(\"div\", {\n        style: {\n          transform: 'translate3d(-100%, 0px, 0px)',\n          height: '0px',\n          overflow: 'hidden',\n          transition: \"transform \" + transitionMs / 1000 + \"s ease\"\n        },\n        key: index,\n        className: 'body-content'\n      }, !lazy && tabEl);\n    }\n    if (index > activeTab) {\n      return React.createElement(\"div\", {\n        style: {\n          transform: 'translate3d(100%, 0px, 0px)',\n          height: '0px',\n          overflow: 'hidden',\n          transition: \"transform \" + transitionMs / 1000 + \"s ease\"\n        },\n        key: index,\n        className: 'body-content'\n      }, !lazy && tabEl);\n    } else {\n      return React.createElement(\"div\", {\n        style: {\n          visibility: 'inherit',\n          overflow: 'auto',\n          height: 'auto',\n          position: 'relative',\n          transition: \"transform \" + transitionMs / 1000 + \"s ease\"\n        },\n        key: index,\n        className: 'body-content'\n      }, tabEl);\n    }\n  })));\n});\nvar TabItem = memo(function (_ref2) {\n  var children = _ref2.children;\n  return React.createElement(\"div\", {\n    style: {\n      padding: '1rem 0.5rem'\n    }\n  }, children);\n});\nvar _excluded = [\"onInputChangedEnd\", \"onChangedDelayed\", \"onChangedValue\", \"delayMs\"];\nvar Input = memo(function (props) {\n  var onInputChangedEnd = props.onInputChangedEnd,\n    onChangedDelayed = props.onChangedDelayed,\n    onChangedValue = props.onChangedValue,\n    delayMs = props.delayMs,\n    restProps = _objectWithoutPropertiesLoose(props, _excluded);\n  var _useState = useState(props.value),\n    state = _useState[0],\n    setState = _useState[1];\n  var timerRef = useRef();\n  var mountRef = useRef(true);\n  var flagRef = useRef(false);\n  useEffect(function () {\n    if (!onChangedDelayed) return;\n    if (mountRef.current) {\n      mountRef.current = false;\n      return;\n    }\n    if (flagRef.current) {\n      return;\n    }\n    timerRef.current = setTimeout(function () {\n      flagRef.current = true;\n      clearTimeout(timerRef.current);\n      onChangedDelayed(state);\n      flagRef.current = false;\n    }, delayMs || 100);\n    return function () {\n      clearTimeout(timerRef.current);\n    };\n  }, [state]);\n  function changeValue(e) {\n    if (['checkbox', 'radio'].includes(props.type)) {\n      setState(e.target.checked);\n      onChangedValue && onChangedValue(e.target.checked);\n    } else {\n      setState(e.target.value);\n      onChangedValue && onChangedValue(e.target.value);\n    }\n  }\n  return React.createElement(React.Fragment, null, onInputChangedEnd && React.createElement(\"input\", Object.assign({}, restProps, {\n    className: restProps === null || restProps === void 0 ? void 0 : restProps.className,\n    style: restProps.style,\n    value: props.value,\n    onChange: changeValue,\n    onBlur: function onBlur(e) {\n      onInputChangedEnd(e.target.value);\n    },\n    onKeyDown: function onKeyDown(e) {\n      if (e.key == 'Enter') onInputChangedEnd(state);\n    }\n  })), !onInputChangedEnd && React.createElement(\"input\", Object.assign({}, restProps, {\n    className: restProps === null || restProps === void 0 ? void 0 : restProps.className,\n    style: restProps.style,\n    value: props.value,\n    onChange: changeValue\n  })));\n});\nvar _initialState = {\n  contrast: 1,\n  blur: 0,\n  brightness: 1,\n  grayscale: 0,\n  invert: 0,\n  saturate: 1,\n  sepia: 0\n};\nvar BasicFilter = memo(function (_ref) {\n  var labels = _ref.labels,\n    color = _ref.color,\n    _ref$initialState = _ref.initialState,\n    initialState = _ref$initialState === void 0 ? _initialState : _ref$initialState,\n    _ref$changeFilter = _ref.changeFilter,\n    changeFilter = _ref$changeFilter === void 0 ? function () {} : _ref$changeFilter;\n  var _useState = useState(initialState),\n    state = _useState[0],\n    setState = _useState[1];\n  useEffect(function () {\n    if (initialState) {\n      setState(JSON.parse(JSON.stringify(_extends({}, state, initialState))));\n    } else {\n      setState(_initialState);\n    }\n  }, [initialState]);\n  function onUpdateContrast(contrast) {\n    changeFilter(_extends({}, state, {\n      contrast: contrast\n    }));\n  }\n  function onUpdateBrightness(brightness) {\n    changeFilter(_extends({}, state, {\n      brightness: brightness\n    }));\n  }\n  function onUpdateGrayscale(grayscale) {\n    changeFilter(_extends({}, state, {\n      grayscale: grayscale\n    }));\n  }\n  function onUpdateSaturate(saturate) {\n    changeFilter(_extends({}, state, {\n      saturate: saturate\n    }));\n  }\n  function onUpdateSepia(sepia) {\n    changeFilter(_extends({}, state, {\n      sepia: sepia\n    }));\n  }\n  function onUpdateBlur(blur) {\n    changeFilter(_extends({}, state, {\n      blur: blur\n    }));\n  }\n  return React.createElement(\"div\", null, React.createElement(\"div\", {\n    style: {\n      display: 'flex',\n      width: '100%',\n      justifyContent: 'space-between'\n    }\n  }, React.createElement(\"p\", {\n    className: \"item-panel\"\n  }, labels['Contrast']), React.createElement(\"p\", {\n    className: \"item-panel\"\n  }, (+state.contrast).toFixed(2))), React.createElement(\"div\", {\n    className: 'flex-row-start'\n  }, React.createElement(Input, {\n    className: \"input-range\",\n    onChangedDelayed: onUpdateContrast,\n    onChangedValue: function onChangedValue(value) {\n      setState(_extends({}, state, {\n        contrast: value\n      }));\n    },\n    style: {\n      maxWidth: '100%',\n      width: '100%',\n      color: color\n    },\n    type: \"range\",\n    min: \"0\",\n    max: \"5\",\n    step: \"0.01\",\n    value: state.contrast\n  })), React.createElement(\"div\", {\n    style: {\n      display: 'flex',\n      width: '100%',\n      justifyContent: 'space-between'\n    }\n  }, React.createElement(\"p\", {\n    className: \"item-panel\"\n  }, labels['Brightness']), React.createElement(\"p\", {\n    className: \"item-panel\"\n  }, (+state.brightness).toFixed(2))), React.createElement(\"div\", {\n    className: 'flex-row-start'\n  }, React.createElement(Input, {\n    className: \"input-range\",\n    onChangedDelayed: onUpdateBrightness,\n    onChangedValue: function onChangedValue(value) {\n      setState(_extends({}, state, {\n        brightness: value\n      }));\n    },\n    style: {\n      maxWidth: '100%',\n      width: '100%',\n      color: color\n    },\n    type: \"range\",\n    min: \"0\",\n    max: \"5\",\n    step: \"0.01\",\n    value: state.brightness\n  })), React.createElement(\"div\", {\n    style: {\n      display: 'flex',\n      width: '100%',\n      justifyContent: 'space-between'\n    }\n  }, React.createElement(\"p\", {\n    className: \"item-panel\"\n  }, labels['Grayscale']), React.createElement(\"p\", {\n    className: \"item-panel\"\n  }, (+state.grayscale).toFixed(2))), React.createElement(\"div\", {\n    className: 'flex-row-start'\n  }, React.createElement(Input, {\n    className: \"input-range\",\n    onChangedDelayed: onUpdateGrayscale,\n    onChangedValue: function onChangedValue(value) {\n      setState(_extends({}, state, {\n        grayscale: value\n      }));\n    },\n    style: {\n      maxWidth: '100%',\n      width: '100%',\n      color: color\n    },\n    type: \"range\",\n    min: \"0\",\n    max: \"5\",\n    step: \"0.01\",\n    value: state.grayscale\n  })), React.createElement(\"div\", {\n    style: {\n      display: 'flex',\n      width: '100%',\n      justifyContent: 'space-between'\n    }\n  }, React.createElement(\"p\", {\n    className: \"item-panel\"\n  }, labels['Saturate']), React.createElement(\"p\", {\n    className: \"item-panel\"\n  }, (+state.saturate).toFixed(2))), React.createElement(\"div\", {\n    className: 'flex-row-start'\n  }, React.createElement(Input, {\n    className: \"input-range\",\n    onChangedDelayed: onUpdateSaturate,\n    onChangedValue: function onChangedValue(value) {\n      setState(_extends({}, state, {\n        saturate: value\n      }));\n    },\n    style: {\n      maxWidth: '100%',\n      width: '100%',\n      color: color\n    },\n    type: \"range\",\n    min: \"0\",\n    max: \"5\",\n    step: \"0.01\",\n    value: state.saturate\n  })), React.createElement(\"div\", {\n    style: {\n      display: 'flex',\n      width: '100%',\n      justifyContent: 'space-between'\n    }\n  }, React.createElement(\"p\", {\n    className: \"item-panel\"\n  }, labels['Sepia']), React.createElement(\"p\", {\n    className: \"item-panel\"\n  }, (+state.sepia).toFixed(2))), React.createElement(\"div\", {\n    className: 'flex-row-start'\n  }, React.createElement(Input, {\n    className: \"input-range\",\n    onChangedDelayed: onUpdateSepia,\n    onChangedValue: function onChangedValue(value) {\n      setState(_extends({}, state, {\n        sepia: value\n      }));\n    },\n    style: {\n      maxWidth: '100%',\n      width: '100%',\n      color: color\n    },\n    type: \"range\",\n    min: \"0\",\n    max: \"5\",\n    step: \"0.01\",\n    value: state.sepia\n  })), React.createElement(\"div\", {\n    style: {\n      display: 'flex',\n      width: '100%',\n      justifyContent: 'space-between'\n    }\n  }, React.createElement(\"p\", {\n    className: \"item-panel\"\n  }, labels['Blur']), React.createElement(\"p\", {\n    className: \"item-panel\"\n  }, (+state.blur).toFixed(2))), React.createElement(\"div\", {\n    className: 'flex-row-start'\n  }, React.createElement(Input, {\n    className: \"input-range\",\n    onChangedDelayed: onUpdateBlur,\n    onChangedValue: function onChangedValue(value) {\n      setState(_extends({}, state, {\n        blur: value\n      }));\n    },\n    style: {\n      maxWidth: '100%',\n      width: '100%',\n      color: color\n    },\n    type: \"range\",\n    min: \"0\",\n    max: \"5\",\n    step: \"0.01\",\n    value: state.blur\n  })));\n});\n(function () {\n  var lastTime = 0;\n  var vendors = [\"ms\", \"moz\", \"webkit\", \"o\"];\n  for (var x = 0; x < vendors.length && !window.requestAnimationFrame; ++x) {\n    window.requestAnimationFrame = window[vendors[x] + \"RequestAnimationFrame\"];\n    window.cancelAnimationFrame = window[vendors[x] + \"CancelAnimationFrame\"] || window[vendors[x] + \"CancelRequestAnimationFrame\"];\n  }\n  if (!window.requestAnimationFrame) window.requestAnimationFrame = function (callback, element) {\n    var currTime = new Date().getTime();\n    var timeToCall = Math.max(0, 16 - (currTime - lastTime));\n    var id = window.setTimeout(function () {\n      callback(currTime + timeToCall);\n    }, timeToCall);\n    lastTime = currTime + timeToCall;\n    return id;\n  };\n  if (!window.cancelAnimationFrame) window.cancelAnimationFrame = function (id) {\n    clearTimeout(id);\n  };\n})();\n(function () {\n  if (typeof window.CustomEvent === \"function\") return false;\n  function CustomEvent(event, params) {\n    params = params || {\n      bubbles: false,\n      cancelable: false,\n      detail: undefined\n    };\n    var evt = document.createEvent(\"CustomEvent\");\n    evt.initCustomEvent(event, params.bubbles, params.cancelable, params.detail);\n    return evt;\n  }\n  CustomEvent.prototype = window.Event.prototype;\n  window.CustomEvent = CustomEvent;\n})();\n(function (window) {\n  try {\n    new CustomEvent(\"test\");\n    return false;\n  } catch (e) {}\n  function MouseEvent(eventType, params) {\n    params = params || {\n      bubbles: false,\n      cancelable: false\n    };\n    var mouseEvent = document.createEvent(\"MouseEvent\");\n    mouseEvent.initMouseEvent(eventType, params.bubbles, params.cancelable, window, 0, 0, 0, 0, 0, false, false, false, false, 0, null);\n    return mouseEvent;\n  }\n  MouseEvent.prototype = Event.prototype;\n  window.MouseEvent = MouseEvent;\n})(window);\nvar Handle = function Handle(position, constraints, cursor, eventBus) {\n  var self = this;\n  this.position = position;\n  this.constraints = constraints;\n  this.cursor = cursor;\n  this.eventBus = eventBus;\n  this.el = document.createElement(\"div\");\n  this.el.className = \"croppr-handle\";\n  this.el.style.cursor = cursor;\n  this.el.addEventListener(\"mousedown\", onMouseDown);\n  function onMouseDown(e) {\n    e.stopPropagation();\n    document.addEventListener(\"mouseup\", onMouseUp);\n    document.addEventListener(\"mousemove\", onMouseMove);\n    self.eventBus.dispatchEvent(new CustomEvent(\"handlestart\", {\n      detail: {\n        handle: self\n      }\n    }));\n  }\n  function onMouseUp(e) {\n    e.stopPropagation();\n    document.removeEventListener(\"mouseup\", onMouseUp);\n    document.removeEventListener(\"mousemove\", onMouseMove);\n    self.eventBus.dispatchEvent(new CustomEvent(\"handleend\", {\n      detail: {\n        handle: self\n      }\n    }));\n  }\n  function onMouseMove(e) {\n    e.stopPropagation();\n    self.eventBus.dispatchEvent(new CustomEvent(\"handlemove\", {\n      detail: {\n        mouseX: e.clientX,\n        mouseY: e.clientY\n      }\n    }));\n  }\n};\nvar Box = /*#__PURE__*/function () {\n  function Box(x1, y1, x2, y2) {\n    this.x1 = x1;\n    this.y1 = y1;\n    this.x2 = x2;\n    this.y2 = y2;\n  }\n  var _proto = Box.prototype;\n  _proto.set = function set(x1, y1, x2, y2) {\n    if (x1 === void 0) {\n      x1 = null;\n    }\n    if (y1 === void 0) {\n      y1 = null;\n    }\n    if (x2 === void 0) {\n      x2 = null;\n    }\n    if (y2 === void 0) {\n      y2 = null;\n    }\n    this.x1 = x1 == null ? this.x1 : x1;\n    this.y1 = y1 == null ? this.y1 : y1;\n    this.x2 = x2 == null ? this.x2 : x2;\n    this.y2 = y2 == null ? this.y2 : y2;\n    return this;\n  };\n  _proto.width = function width() {\n    return Math.abs(this.x2 - this.x1);\n  };\n  _proto.height = function height() {\n    return Math.abs(this.y2 - this.y1);\n  };\n  _proto.resize = function resize(newWidth, newHeight, origin) {\n    if (origin === void 0) {\n      origin = [0, 0];\n    }\n    var fromX = this.x1 + this.width() * origin[0];\n    var fromY = this.y1 + this.height() * origin[1];\n    this.x1 = fromX - newWidth * origin[0];\n    this.y1 = fromY - newHeight * origin[1];\n    this.x2 = this.x1 + newWidth;\n    this.y2 = this.y1 + newHeight;\n    return this;\n  };\n  _proto.scale = function scale(factor, origin) {\n    if (origin === void 0) {\n      origin = [0, 0];\n    }\n    var newWidth = this.width() * factor;\n    var newHeight = this.height() * factor;\n    this.resize(newWidth, newHeight, origin);\n    return this;\n  };\n  _proto.move = function move(x, y) {\n    if (x === void 0) {\n      x = null;\n    }\n    if (y === void 0) {\n      y = null;\n    }\n    var width = this.width();\n    var height = this.height();\n    x = x === null ? this.x1 : x;\n    y = y === null ? this.y1 : y;\n    this.x1 = x;\n    this.y1 = y;\n    this.x2 = x + width;\n    this.y2 = y + height;\n    return this;\n  };\n  _proto.getRelativePoint = function getRelativePoint(point) {\n    if (point === void 0) {\n      point = [0, 0];\n    }\n    var x = this.width() * point[0];\n    var y = this.height() * point[1];\n    return [x, y];\n  };\n  _proto.getAbsolutePoint = function getAbsolutePoint(point) {\n    if (point === void 0) {\n      point = [0, 0];\n    }\n    var x = this.x1 + this.width() * point[0];\n    var y = this.y1 + this.height() * point[1];\n    return [x, y];\n  };\n  _proto.constrainToRatio = function constrainToRatio(ratio, origin, grow) {\n    if (origin === void 0) {\n      origin = [0, 0];\n    }\n    if (grow === void 0) {\n      grow = \"height\";\n    }\n    if (ratio === null) {\n      return;\n    }\n    var width = this.width();\n    var height = this.height();\n    switch (grow) {\n      case \"height\":\n        this.resize(this.width(), this.width() * ratio, origin);\n        break;\n      case \"width\":\n        this.resize(this.height() * 1 / ratio, this.height(), origin);\n        break;\n      default:\n        this.resize(this.width(), this.width() * ratio, origin);\n    }\n    return this;\n  };\n  _proto.constrainToBoundary = function constrainToBoundary(boundaryWidth, boundaryHeight, origin) {\n    if (origin === void 0) {\n      origin = [0, 0];\n    }\n    var _this$getAbsolutePoin = this.getAbsolutePoint(origin),\n      originX = _this$getAbsolutePoin[0],\n      originY = _this$getAbsolutePoin[1];\n    var maxIfLeft = originX;\n    var maxIfTop = originY;\n    var maxIfRight = boundaryWidth - originX;\n    var maxIfBottom = boundaryHeight - originY;\n    var directionX = -2 * origin[0] + 1;\n    var directionY = -2 * origin[1] + 1;\n    var maxWidth = null,\n      maxHeight = null;\n    switch (directionX) {\n      case -1:\n        maxWidth = maxIfLeft;\n        break;\n      case 0:\n        maxWidth = Math.min(maxIfLeft, maxIfRight) * 2;\n        break;\n      case +1:\n        maxWidth = maxIfRight;\n        break;\n    }\n    switch (directionY) {\n      case -1:\n        maxHeight = maxIfTop;\n        break;\n      case 0:\n        maxHeight = Math.min(maxIfTop, maxIfBottom) * 2;\n        break;\n      case +1:\n        maxHeight = maxIfBottom;\n        break;\n    }\n    if (this.width() > maxWidth) {\n      var factor = maxWidth / this.width();\n      this.scale(factor, origin);\n    }\n    if (this.height() > maxHeight) {\n      var _factor = maxHeight / this.height();\n      this.scale(_factor, origin);\n    }\n    return this;\n  };\n  _proto.constrainToSize = function constrainToSize(maxWidth, maxHeight, minWidth, minHeight, origin, ratio) {\n    if (maxWidth === void 0) {\n      maxWidth = null;\n    }\n    if (maxHeight === void 0) {\n      maxHeight = null;\n    }\n    if (minWidth === void 0) {\n      minWidth = null;\n    }\n    if (minHeight === void 0) {\n      minHeight = null;\n    }\n    if (origin === void 0) {\n      origin = [0, 0];\n    }\n    if (ratio === void 0) {\n      ratio = null;\n    }\n    if (ratio) {\n      if (ratio > 1) {\n        maxWidth = maxHeight * 1 / ratio;\n        minHeight = minHeight * ratio;\n      } else if (ratio < 1) {\n        maxHeight = maxWidth * ratio;\n        minWidth = minHeight * 1 / ratio;\n      }\n    }\n    if (maxWidth && this.width() > maxWidth) {\n      var newWidth = maxWidth,\n        newHeight = ratio === null ? this.height() : maxHeight;\n      this.resize(newWidth, newHeight, origin);\n    }\n    if (maxHeight && this.height() > maxHeight) {\n      var _newWidth = ratio === null ? this.width() : maxWidth,\n        _newHeight = maxHeight;\n      this.resize(_newWidth, _newHeight, origin);\n    }\n    if (minWidth && this.width() < minWidth) {\n      var _newWidth2 = minWidth,\n        _newHeight2 = ratio === null ? this.height() : minHeight;\n      this.resize(_newWidth2, _newHeight2, origin);\n    }\n    if (minHeight && this.height() < minHeight) {\n      var _newWidth3 = ratio === null ? this.width() : minWidth,\n        _newHeight3 = minHeight;\n      this.resize(_newWidth3, _newHeight3, origin);\n    }\n    return this;\n  };\n  return Box;\n}();\nfunction enableTouch(element) {\n  element.addEventListener(\"touchstart\", simulateMouseEvent);\n  element.addEventListener(\"touchend\", simulateMouseEvent);\n  element.addEventListener(\"touchmove\", simulateMouseEvent);\n}\nfunction simulateMouseEvent(e) {\n  e.preventDefault();\n  var touch = e.changedTouches[0];\n  var eventMap = {\n    touchstart: \"mousedown\",\n    touchmove: \"mousemove\",\n    touchend: \"mouseup\"\n  };\n  touch.target.dispatchEvent(new MouseEvent(eventMap[e.type], {\n    bubbles: true,\n    cancelable: true,\n    view: window,\n    clientX: touch.clientX,\n    clientY: touch.clientY,\n    screenX: touch.screenX,\n    screenY: touch.screenY\n  }));\n}\nvar HANDLES = [{\n  position: [0.0, 0.0],\n  constraints: [1, 0, 0, 1],\n  cursor: \"nw-resize\"\n}, {\n  position: [0.5, 0.0],\n  constraints: [1, 0, 0, 0],\n  cursor: \"n-resize\"\n}, {\n  position: [1.0, 0.0],\n  constraints: [1, 1, 0, 0],\n  cursor: \"ne-resize\"\n}, {\n  position: [1.0, 0.5],\n  constraints: [0, 1, 0, 0],\n  cursor: \"e-resize\"\n}, {\n  position: [1.0, 1.0],\n  constraints: [0, 1, 1, 0],\n  cursor: \"se-resize\"\n}, {\n  position: [0.5, 1.0],\n  constraints: [0, 0, 1, 0],\n  cursor: \"s-resize\"\n}, {\n  position: [0.0, 1.0],\n  constraints: [0, 0, 1, 1],\n  cursor: \"sw-resize\"\n}, {\n  position: [0.0, 0.5],\n  constraints: [0, 0, 0, 1],\n  cursor: \"w-resize\"\n}];\nvar CropprCore = /*#__PURE__*/function () {\n  function CropprCore(element, options, deferred) {\n    var _this = this;\n    if (deferred === void 0) {\n      deferred = false;\n    }\n    this.options = CropprCore.parseOptions(options || {});\n    if (!element.nodeName) {\n      element = document.querySelector(element);\n      if (element == null) {\n        throw \"Unable to find element.\";\n      }\n    }\n    if (!element.getAttribute(\"src\")) {\n      throw \"Image src not provided.\";\n    }\n    this._initialized = false;\n    this._restore = {\n      parent: element.parentNode,\n      element: element\n    };\n    if (!deferred) {\n      if (element.width === 0 || element.height === 0) {\n        element.onload = function () {\n          _this.initialize(element);\n        };\n      } else {\n        this.initialize(element);\n      }\n    }\n  }\n  var _proto = CropprCore.prototype;\n  _proto.initialize = function initialize(element) {\n    this.createDOM(element);\n    this.options.convertToPixels(this.cropperEl);\n    this.attachHandlerEvents();\n    this.attachRegionEvents();\n    this.attachOverlayEvents();\n    this.box = this.initializeBox(this.options);\n    this.redraw();\n    this._initialized = true;\n    if (this.options.onInitialize !== null) {\n      this.options.onInitialize(this);\n    }\n  };\n  _proto.createDOM = function createDOM(targetEl) {\n    this.containerEl = document.createElement(\"div\");\n    this.containerEl.className = \"croppr-container\";\n    this.eventBus = this.containerEl;\n    enableTouch(this.containerEl);\n    this.cropperEl = document.createElement(\"div\");\n    this.cropperEl.className = \"croppr\";\n    this.imageEl = document.createElement(\"img\");\n    this.imageEl.setAttribute(\"src\", targetEl.getAttribute(\"src\"));\n    this.imageEl.setAttribute(\"alt\", targetEl.getAttribute(\"alt\"));\n    this.imageEl.className = \"croppr-image\";\n    this.imageClippedEl = this.imageEl.cloneNode();\n    this.imageClippedEl.className = \"croppr-imageClipped\";\n    this.regionEl = document.createElement(\"div\");\n    this.regionEl.innerHTML = new Array(9).fill(1).map(function () {\n      return \"<div style=\\\"border: 1px dashed #fafafa\\\"></div>\";\n    }).join(\"\");\n    this.regionEl.className = \"croppr-region\";\n    this.overlayEl = document.createElement(\"div\");\n    this.overlayEl.className = \"croppr-overlay\";\n    var handleContainerEl = document.createElement(\"div\");\n    handleContainerEl.className = \"croppr-handleContainer\";\n    this.handles = [];\n    for (var i = 0; i < HANDLES.length; i++) {\n      var handle = new Handle(HANDLES[i].position, HANDLES[i].constraints, HANDLES[i].cursor, this.eventBus);\n      this.handles.push(handle);\n      handleContainerEl.appendChild(handle.el);\n    }\n    this.cropperEl.appendChild(this.imageEl);\n    this.cropperEl.appendChild(this.imageClippedEl);\n    this.cropperEl.appendChild(this.regionEl);\n    this.cropperEl.appendChild(this.overlayEl);\n    this.cropperEl.appendChild(handleContainerEl);\n    this.containerEl.appendChild(this.cropperEl);\n    targetEl.parentElement.replaceChild(this.containerEl, targetEl);\n  };\n  _proto.setImage = function setImage(src) {\n    var _this2 = this;\n    this.imageEl.onload = function () {\n      _this2.box = _this2.initializeBox(_this2.options);\n      _this2.redraw();\n    };\n    this.imageEl.src = src;\n    this.imageClippedEl.src = src;\n    return this;\n  };\n  _proto.destroy = function destroy() {\n    this._restore.parent.replaceChild(this._restore.element, this.containerEl);\n  };\n  _proto.initializeBox = function initializeBox(opts) {\n    var width = opts.startSize.width;\n    var height = opts.startSize.height;\n    var box = new Box(0, 0, width, height);\n    box.constrainToRatio(opts.aspectRatio, [0.5, 0.5]);\n    var min = opts.minSize;\n    var max = opts.maxSize;\n    box.constrainToSize(max.width, max.height, min.width, min.height, [0.5, 0.5], opts.aspectRatio);\n    var parentWidth = this.cropperEl.offsetWidth;\n    var parentHeight = this.cropperEl.offsetHeight;\n    box.constrainToBoundary(parentWidth, parentHeight, [0.5, 0.5]);\n    var x = this.cropperEl.offsetWidth / 2 - box.width() / 2;\n    var y = this.cropperEl.offsetHeight / 2 - box.height() / 2;\n    box.move(x, y);\n    return box;\n  };\n  _proto.redraw = function redraw() {\n    var _this3 = this;\n    var width = Math.round(this.box.width()),\n      height = Math.round(this.box.height()),\n      x1 = Math.round(this.box.x1),\n      y1 = Math.round(this.box.y1),\n      x2 = Math.round(this.box.x2),\n      y2 = Math.round(this.box.y2);\n    window.requestAnimationFrame(function () {\n      _this3.regionEl.style.transform = \"translate(\" + x1 + \"px, \" + y1 + \"px)\";\n      _this3.regionEl.style.width = width + \"px\";\n      _this3.regionEl.style.height = height + \"px\";\n      _this3.imageClippedEl.style.clip = \"rect(\" + y1 + \"px, \" + x2 + \"px, \" + y2 + \"px, \" + x1 + \"px)\";\n      var center = _this3.box.getAbsolutePoint([0.5, 0.5]);\n      var xSign = center[0] - _this3.cropperEl.offsetWidth / 2 >> 31;\n      var ySign = center[1] - _this3.cropperEl.offsetHeight / 2 >> 31;\n      var quadrant = (xSign ^ ySign) + ySign + ySign + 4;\n      var foregroundHandleIndex = -2 * quadrant + 8;\n      for (var i = 0; i < _this3.handles.length; i++) {\n        var handle = _this3.handles[i];\n        var handleWidth = handle.el.offsetWidth;\n        var handleHeight = handle.el.offsetHeight;\n        var left = x1 + width * handle.position[0] - handleWidth / 2;\n        var top = y1 + height * handle.position[1] - handleHeight / 2;\n        handle.el.style.transform = \"translate(\" + Math.round(left) + \"px, \" + Math.round(top) + \"px)\";\n        handle.el.style.zIndex = foregroundHandleIndex == i ? 5 : 4;\n      }\n    });\n  };\n  _proto.attachHandlerEvents = function attachHandlerEvents() {\n    var eventBus = this.eventBus;\n    eventBus.addEventListener(\"handlestart\", this.onHandleMoveStart.bind(this));\n    eventBus.addEventListener(\"handlemove\", this.onHandleMoveMoving.bind(this));\n    eventBus.addEventListener(\"handleend\", this.onHandleMoveEnd.bind(this));\n  };\n  _proto.attachRegionEvents = function attachRegionEvents() {\n    var eventBus = this.eventBus;\n    this.regionEl.addEventListener(\"mousedown\", onMouseDown);\n    eventBus.addEventListener(\"regionstart\", this.onRegionMoveStart.bind(this));\n    eventBus.addEventListener(\"regionmove\", this.onRegionMoveMoving.bind(this));\n    eventBus.addEventListener(\"regionend\", this.onRegionMoveEnd.bind(this));\n    function onMouseDown(e) {\n      e.stopPropagation();\n      document.addEventListener(\"mouseup\", onMouseUp);\n      document.addEventListener(\"mousemove\", onMouseMove);\n      eventBus.dispatchEvent(new CustomEvent(\"regionstart\", {\n        detail: {\n          mouseX: e.clientX,\n          mouseY: e.clientY\n        }\n      }));\n    }\n    function onMouseMove(e) {\n      e.stopPropagation();\n      eventBus.dispatchEvent(new CustomEvent(\"regionmove\", {\n        detail: {\n          mouseX: e.clientX,\n          mouseY: e.clientY\n        }\n      }));\n    }\n    function onMouseUp(e) {\n      e.stopPropagation();\n      document.removeEventListener(\"mouseup\", onMouseUp);\n      document.removeEventListener(\"mousemove\", onMouseMove);\n      eventBus.dispatchEvent(new CustomEvent(\"regionend\", {\n        detail: {\n          mouseX: e.clientX,\n          mouseY: e.clientY\n        }\n      }));\n    }\n  };\n  _proto.attachOverlayEvents = function attachOverlayEvents() {\n    var SOUTHEAST_HANDLE_IDX = 4;\n    var self = this;\n    var tmpBox = null;\n    this.overlayEl.addEventListener(\"mousedown\", onMouseDown);\n    function onMouseDown(e) {\n      e.stopPropagation();\n      document.addEventListener(\"mouseup\", onMouseUp);\n      document.addEventListener(\"mousemove\", onMouseMove);\n      var container = self.cropperEl.getBoundingClientRect();\n      var mouseX = e.clientX - container.left;\n      var mouseY = e.clientY - container.top;\n      tmpBox = self.box;\n      self.box = new Box(mouseX, mouseY, mouseX + 1, mouseY + 1);\n      self.eventBus.dispatchEvent(new CustomEvent(\"handlestart\", {\n        detail: {\n          handle: self.handles[SOUTHEAST_HANDLE_IDX]\n        }\n      }));\n    }\n    function onMouseMove(e) {\n      e.stopPropagation();\n      self.eventBus.dispatchEvent(new CustomEvent(\"handlemove\", {\n        detail: {\n          mouseX: e.clientX,\n          mouseY: e.clientY\n        }\n      }));\n    }\n    function onMouseUp(e) {\n      e.stopPropagation();\n      document.removeEventListener(\"mouseup\", onMouseUp);\n      document.removeEventListener(\"mousemove\", onMouseMove);\n      if (self.box.width() === 1 && self.box.height() === 1) {\n        self.box = tmpBox;\n        return;\n      }\n      self.eventBus.dispatchEvent(new CustomEvent(\"handleend\", {\n        detail: {\n          mouseX: e.clientX,\n          mouseY: e.clientY\n        }\n      }));\n    }\n  };\n  _proto.onHandleMoveStart = function onHandleMoveStart(e) {\n    var handle = e.detail.handle;\n    var originPoint = [1 - handle.position[0], 1 - handle.position[1]];\n    var _this$box$getAbsolute = this.box.getAbsolutePoint(originPoint),\n      originX = _this$box$getAbsolute[0],\n      originY = _this$box$getAbsolute[1];\n    this.activeHandle = {\n      handle: handle,\n      originPoint: originPoint,\n      originX: originX,\n      originY: originY\n    };\n    if (this.options.onCropStart !== null) {\n      this.options.onCropStart(this.getValue());\n    }\n  };\n  _proto.onHandleMoveMoving = function onHandleMoveMoving(e) {\n    var _e$detail = e.detail,\n      mouseX = _e$detail.mouseX,\n      mouseY = _e$detail.mouseY;\n    var container = this.cropperEl.getBoundingClientRect();\n    mouseX = mouseX - container.left;\n    mouseY = mouseY - container.top;\n    if (mouseX < 0) {\n      mouseX = 0;\n    } else if (mouseX > container.width) {\n      mouseX = container.width;\n    }\n    if (mouseY < 0) {\n      mouseY = 0;\n    } else if (mouseY > container.height) {\n      mouseY = container.height;\n    }\n    var origin = this.activeHandle.originPoint.slice();\n    var originX = this.activeHandle.originX;\n    var originY = this.activeHandle.originY;\n    var handle = this.activeHandle.handle;\n    var TOP_MOVABLE = handle.constraints[0] === 1;\n    var RIGHT_MOVABLE = handle.constraints[1] === 1;\n    var BOTTOM_MOVABLE = handle.constraints[2] === 1;\n    var LEFT_MOVABLE = handle.constraints[3] === 1;\n    var MULTI_AXIS = (LEFT_MOVABLE || RIGHT_MOVABLE) && (TOP_MOVABLE || BOTTOM_MOVABLE);\n    var x1 = LEFT_MOVABLE || RIGHT_MOVABLE ? originX : this.box.x1;\n    var x2 = LEFT_MOVABLE || RIGHT_MOVABLE ? originX : this.box.x2;\n    var y1 = TOP_MOVABLE || BOTTOM_MOVABLE ? originY : this.box.y1;\n    var y2 = TOP_MOVABLE || BOTTOM_MOVABLE ? originY : this.box.y2;\n    x1 = LEFT_MOVABLE ? mouseX : x1;\n    x2 = RIGHT_MOVABLE ? mouseX : x2;\n    y1 = TOP_MOVABLE ? mouseY : y1;\n    y2 = BOTTOM_MOVABLE ? mouseY : y2;\n    var isFlippedX = false,\n      isFlippedY = false;\n    if (LEFT_MOVABLE || RIGHT_MOVABLE) {\n      isFlippedX = LEFT_MOVABLE ? mouseX > originX : mouseX < originX;\n    }\n    if (TOP_MOVABLE || BOTTOM_MOVABLE) {\n      isFlippedY = TOP_MOVABLE ? mouseY > originY : mouseY < originY;\n    }\n    if (isFlippedX) {\n      var tmp = x1;\n      x1 = x2;\n      x2 = tmp;\n      origin[0] = 1 - origin[0];\n    }\n    if (isFlippedY) {\n      var _tmp = y1;\n      y1 = y2;\n      y2 = _tmp;\n      origin[1] = 1 - origin[1];\n    }\n    var box = new Box(x1, y1, x2, y2);\n    if (this.options.aspectRatio) {\n      var ratio = this.options.aspectRatio;\n      var isVerticalMovement = false;\n      if (MULTI_AXIS) {\n        isVerticalMovement = mouseY > box.y1 + ratio * box.width() || mouseY < box.y2 - ratio * box.width();\n      } else if (TOP_MOVABLE || BOTTOM_MOVABLE) {\n        isVerticalMovement = true;\n      }\n      var ratioMode = isVerticalMovement ? \"width\" : \"height\";\n      box.constrainToRatio(ratio, origin, ratioMode);\n    }\n    var min = this.options.minSize;\n    var max = this.options.maxSize;\n    box.constrainToSize(max.width, max.height, min.width, min.height, origin, this.options.aspectRatio);\n    var parentWidth = this.cropperEl.offsetWidth;\n    var parentHeight = this.cropperEl.offsetHeight;\n    box.constrainToBoundary(parentWidth, parentHeight, origin);\n    this.box = box;\n    this.redraw();\n    if (this.options.onCropMove !== null) {\n      this.options.onCropMove(this.getValue());\n    }\n  };\n  _proto.onHandleMoveEnd = function onHandleMoveEnd(e) {\n    if (this.options.onCropEnd !== null) {\n      this.options.onCropEnd(this.getValue());\n    }\n  };\n  _proto.onRegionMoveStart = function onRegionMoveStart(e) {\n    var _e$detail2 = e.detail,\n      mouseX = _e$detail2.mouseX,\n      mouseY = _e$detail2.mouseY;\n    var container = this.cropperEl.getBoundingClientRect();\n    mouseX = mouseX - container.left;\n    mouseY = mouseY - container.top;\n    this.currentMove = {\n      offsetX: mouseX - this.box.x1,\n      offsetY: mouseY - this.box.y1\n    };\n    if (this.options.onCropStart !== null) {\n      this.options.onCropStart(this.getValue());\n    }\n  };\n  _proto.onRegionMoveMoving = function onRegionMoveMoving(e) {\n    var _e$detail3 = e.detail,\n      mouseX = _e$detail3.mouseX,\n      mouseY = _e$detail3.mouseY;\n    var _this$currentMove = this.currentMove,\n      offsetX = _this$currentMove.offsetX,\n      offsetY = _this$currentMove.offsetY;\n    var container = this.cropperEl.getBoundingClientRect();\n    mouseX = mouseX - container.left;\n    mouseY = mouseY - container.top;\n    this.box.move(mouseX - offsetX, mouseY - offsetY);\n    if (this.box.x1 < 0) {\n      this.box.move(0, null);\n    }\n    if (this.box.x2 > container.width) {\n      this.box.move(container.width - this.box.width(), null);\n    }\n    if (this.box.y1 < 0) {\n      this.box.move(null, 0);\n    }\n    if (this.box.y2 > container.height) {\n      this.box.move(null, container.height - this.box.height());\n    }\n    this.redraw();\n    if (this.options.onCropMove !== null) {\n      this.options.onCropMove(this.getValue());\n    }\n  };\n  _proto.onRegionMoveEnd = function onRegionMoveEnd(e) {\n    if (this.options.onCropEnd !== null) {\n      this.options.onCropEnd(this.getValue());\n    }\n  };\n  _proto.getValue = function getValue(mode) {\n    if (mode === void 0) {\n      mode = null;\n    }\n    if (mode === null) {\n      mode = this.options.returnMode;\n    }\n    if (mode == \"real\") {\n      var actualWidth = this.imageEl.naturalWidth;\n      var actualHeight = this.imageEl.naturalHeight;\n      var _this$imageEl$getBoun = this.imageEl.getBoundingClientRect(),\n        elementWidth = _this$imageEl$getBoun.width,\n        elementHeight = _this$imageEl$getBoun.height;\n      var factorX = actualWidth / elementWidth;\n      var factorY = actualHeight / elementHeight;\n      return {\n        x: Math.round(this.box.x1 * factorX),\n        y: Math.round(this.box.y1 * factorY),\n        width: Math.round(this.box.width() * factorX),\n        height: Math.round(this.box.height() * factorY)\n      };\n    } else if (mode == \"ratio\") {\n      var _this$imageEl$getBoun2 = this.imageEl.getBoundingClientRect(),\n        _elementWidth = _this$imageEl$getBoun2.width,\n        _elementHeight = _this$imageEl$getBoun2.height;\n      return {\n        x: round(this.box.x1 / _elementWidth, 3),\n        y: round(this.box.y1 / _elementHeight, 3),\n        width: round(this.box.width() / _elementWidth, 3),\n        height: round(this.box.height() / _elementHeight, 3)\n      };\n    } else if (mode == \"raw\") {\n      return {\n        x: Math.round(this.box.x1),\n        y: Math.round(this.box.y1),\n        width: Math.round(this.box.width()),\n        height: Math.round(this.box.height())\n      };\n    }\n  };\n  CropprCore.parseOptions = function parseOptions(opts) {\n    var defaults = {\n      aspectRatio: null,\n      maxSize: {\n        width: null,\n        height: null\n      },\n      minSize: {\n        width: null,\n        height: null\n      },\n      startSize: {\n        width: 100,\n        height: 100,\n        unit: \"%\"\n      },\n      returnMode: \"real\",\n      onInitialize: null,\n      onCropStart: null,\n      onCropMove: null,\n      onCropEnd: null\n    };\n    var aspectRatio = null;\n    if (opts.aspectRatio !== undefined) {\n      if (typeof opts.aspectRatio === \"number\") {\n        aspectRatio = opts.aspectRatio;\n      } else if (opts.aspectRatio instanceof Array) {\n        aspectRatio = opts.aspectRatio[1] / opts.aspectRatio[0];\n      }\n    }\n    var maxSize = null;\n    if (opts.maxSize !== undefined && opts.maxSize !== null) {\n      maxSize = {\n        width: opts.maxSize[0] || null,\n        height: opts.maxSize[1] || null,\n        unit: opts.maxSize[2] || \"px\"\n      };\n    }\n    var minSize = null;\n    if (opts.minSize !== undefined && opts.minSize !== null) {\n      minSize = {\n        width: opts.minSize[0] || null,\n        height: opts.minSize[1] || null,\n        unit: opts.minSize[2] || \"px\"\n      };\n    }\n    var startSize = null;\n    if (opts.startSize !== undefined && opts.startSize !== null) {\n      startSize = {\n        width: opts.startSize[0] || null,\n        height: opts.startSize[1] || null,\n        unit: opts.startSize[2] || \"%\"\n      };\n    }\n    var onInitialize = null;\n    if (typeof opts.onInitialize === \"function\") {\n      onInitialize = opts.onInitialize;\n    }\n    var onCropStart = null;\n    if (typeof opts.onCropStart === \"function\") {\n      onCropStart = opts.onCropStart;\n    }\n    var onCropEnd = null;\n    if (typeof opts.onCropEnd === \"function\") {\n      onCropEnd = opts.onCropEnd;\n    }\n    var onCropMove = null;\n    if (typeof opts.onUpdate === \"function\") {\n      console.warn(\"Croppr.js: `onUpdate` is deprecated and will be removed in the next major release. Please use `onCropMove` or `onCropEnd` instead.\");\n      onCropMove = opts.onUpdate;\n    }\n    if (typeof opts.onCropMove === \"function\") {\n      onCropMove = opts.onCropMove;\n    }\n    var returnMode = null;\n    if (opts.returnMode !== undefined) {\n      var s = opts.returnMode.toLowerCase();\n      if ([\"real\", \"ratio\", \"raw\"].indexOf(s) === -1) {\n        throw \"Invalid return mode.\";\n      }\n      returnMode = s;\n    }\n    var convertToPixels = function convertToPixels(container) {\n      var width = container.offsetWidth;\n      var height = container.offsetHeight;\n      var sizeKeys = [\"maxSize\", \"minSize\", \"startSize\"];\n      for (var i = 0; i < sizeKeys.length; i++) {\n        var key = sizeKeys[i];\n        if (this[key] !== null) {\n          if (this[key].unit == \"%\") {\n            if (this[key].width !== null) {\n              this[key].width = this[key].width / 100 * width;\n            }\n            if (this[key].height !== null) {\n              this[key].height = this[key].height / 100 * height;\n            }\n          }\n          delete this[key].unit;\n        }\n      }\n    };\n    var defaultValue = function defaultValue(v, d) {\n      return v !== null ? v : d;\n    };\n    return {\n      aspectRatio: defaultValue(aspectRatio, defaults.aspectRatio),\n      maxSize: defaultValue(maxSize, defaults.maxSize),\n      minSize: defaultValue(minSize, defaults.minSize),\n      startSize: defaultValue(startSize, defaults.startSize),\n      returnMode: defaultValue(returnMode, defaults.returnMode),\n      onInitialize: defaultValue(onInitialize, defaults.onInitialize),\n      onCropStart: defaultValue(onCropStart, defaults.onCropStart),\n      onCropMove: defaultValue(onCropMove, defaults.onCropMove),\n      onCropEnd: defaultValue(onCropEnd, defaults.onCropEnd),\n      convertToPixels: convertToPixels\n    };\n  };\n  return CropprCore;\n}();\nfunction round(value, decimals) {\n  return Number(Math.round(value + \"e\" + decimals) + \"e-\" + decimals);\n}\nvar Croppr = /*#__PURE__*/function (_CropprCore) {\n  _inheritsLoose(Croppr, _CropprCore);\n  function Croppr(element, options, _deferred) {\n    if (_deferred === void 0) {\n      _deferred = false;\n    }\n    return _CropprCore.call(this, element, options, _deferred) || this;\n  }\n  var _proto = Croppr.prototype;\n  _proto.getValue = function getValue(mode) {\n    return _CropprCore.prototype.getValue.call(this, mode);\n  };\n  _proto.setImage = function setImage(src) {\n    return _CropprCore.prototype.setImage.call(this, src);\n  };\n  _proto.destroy = function destroy() {\n    return _CropprCore.prototype.destroy.call(this);\n  };\n  _proto.moveTo = function moveTo(x, y) {\n    this.box.move(x, y);\n    this.redraw();\n    if (this.options.onCropEnd !== null) {\n      this.options.onCropEnd(this.getValue());\n    }\n    return this;\n  };\n  _proto.resizeTo = function resizeTo(width, height, origin) {\n    if (origin === void 0) {\n      origin = [0.5, 0.5];\n    }\n    this.box.resize(width, height, origin);\n    var parentWidth = this.cropperEl.offsetWidth;\n    var parentHeight = this.cropperEl.offsetHeight;\n    this.box.constrainToBoundary(parentWidth, parentHeight, [0.5, 0.5]);\n    this.redraw();\n    if (this.options.onCropEnd !== null) {\n      this.options.onCropEnd(this.getValue());\n    }\n    return this;\n  };\n  _proto.scaleBy = function scaleBy(factor, origin) {\n    if (origin === void 0) {\n      origin = [0.5, 0.5];\n    }\n    this.box.scale(factor, origin);\n    this.redraw();\n    if (this.options.onCropEnd !== null) {\n      this.options.onCropEnd(this.getValue());\n    }\n    return this;\n  };\n  _proto.reset = function reset(newOptions) {\n    if (newOptions) {\n      this.options = _extends({}, this.options, {\n        newOptions: newOptions\n      });\n    }\n    this.box = this.initializeBox(this.options);\n    this.redraw();\n    if (this.options.onCropEnd !== null) {\n      this.options.onCropEnd(this.getValue());\n    }\n    return this;\n  };\n  _proto.enableVisibility = function enableVisibility(state) {\n    var croppContainer = document.querySelector(\".croppr-container\");\n    if (!croppContainer) throw new Error(\"THere is not any croppr\");\n    if (state) {\n      croppContainer.style.display = \"block\";\n    } else {\n      croppContainer.style.display = \"none\";\n    }\n  };\n  return Croppr;\n}(CropprCore);\nvar CropprWrapper = memo(function (_ref) {\n  var src = _ref.src,\n    size = _ref.size,\n    croppUpdate = _ref.croppUpdate;\n  var _useState = useState(),\n    imageSrc = _useState[0],\n    setImageSrc = _useState[1];\n  var _useState2 = useState({\n      width: 150,\n      height: 150\n    }),\n    croppSize = _useState2[0],\n    setCroppSize = _useState2[1];\n  var croppr = useRef(null);\n  var mount = useRef();\n  useEffect(function () {\n    if (size) {\n      setCroppSize(_extends({}, size));\n      if (croppr.current) croppr.current.resizeTo(size.width, size.height);\n    }\n  }, [size]);\n  useEffect(function () {\n    if (src) {\n      setImageSrc(src);\n    }\n  }, [src]);\n  useEffect(function () {\n    if (mount.current && imageSrc) {\n      croppr.current = new Croppr('#croppr', {\n        minSize: [32, 32, 'px'],\n        startSize: [croppSize.width, croppSize.height, 'px'],\n        onInitialize: function onInitialize(data) {\n          croppUpdate(data === null || data === void 0 ? void 0 : data.getValue());\n        },\n        onCropEnd: function onCropEnd(data) {\n          croppUpdate(data);\n        }\n      });\n    }\n    return function () {\n      var _croppr$current;\n      return croppr === null || croppr === void 0 ? void 0 : (_croppr$current = croppr.current) === null || _croppr$current === void 0 ? void 0 : _croppr$current.destroy();\n    };\n  }, [mount.current, imageSrc]);\n  return React.createElement(\"div\", {\n    className: 'CropprWrapper'\n  }, React.createElement(\"img\", {\n    ref: mount,\n    src: imageSrc,\n    id: \"croppr\"\n  }));\n});\nvar _initialState$1 = {\n  quality: 92,\n  maxHeight: 1000,\n  maxWidth: 1000,\n  cropHeight: 150,\n  cropWidth: 150,\n  maintainAspectRatio: true,\n  format: 'jpeg',\n  arrayCopiedImages: [],\n  originImageSrc: ''\n};\nvar EditImage = memo(function (_ref) {\n  var onChangeFilters = function onChangeFilters(data) {\n    try {\n      var _temp8 = _catch(function () {\n        var newState = _cloneObject(state);\n        if (!newState.basicFilters) {\n          newState.basicFilters = data;\n        } else {\n          newState.basicFilters = _extends({}, newState.basicFilters, data);\n        }\n        return Promise.resolve(applyChanges(newState, false)).then(function () {});\n      }, function (e) {\n        console.log(\"🚀 ~ file: EditImage.tsx ~ line 259 ~ onChangeFilters ~ e\", e);\n      });\n      return Promise.resolve(_temp8 && _temp8.then ? _temp8.then(function () {}) : void 0);\n    } catch (e) {\n      return Promise.reject(e);\n    }\n  };\n  var onRestore = function onRestore() {\n    try {\n      try {\n        var newState = _cloneObject(state);\n        if (newState.arrayCopiedImages.length > 1) {\n          newState.arrayCopiedImages.pop();\n          var newValue = newState.arrayCopiedImages[newState.arrayCopiedImages.length - 1];\n          newState = _extends({}, state, {\n            arrayCopiedImages: newState.arrayCopiedImages,\n            maxHeight: newValue.height,\n            maxWidth: newValue.width,\n            quality: newValue.quality,\n            format: newValue.format,\n            originImageSrc: newValue.originImageSrc,\n            basicFilters: newValue.basicFilters\n          });\n          setState(newState);\n          setImageSrc(newValue.lastImage);\n        }\n      } catch (e) {\n        console.log('🚀 ~ file: edit-image.component.ts ~ line 126 ~ EditImageComponent ~ onRestore ~ e', e);\n      }\n      return Promise.resolve();\n    } catch (e) {\n      return Promise.reject(e);\n    }\n  };\n  var onChangeFormat = function onChangeFormat(e) {\n    try {\n      var newState = _extends({}, state, {\n        format: e.target.value\n      });\n      var _temp6 = _catch(function () {\n        setState(newState);\n        return Promise.resolve(applyChanges(newState, false)).then(function () {});\n      }, function (error) {\n        console.log(\"onChangeFormat ~ error\", error);\n      });\n      return Promise.resolve(_temp6 && _temp6.then ? _temp6.then(function () {}) : void 0);\n    } catch (e) {\n      return Promise.reject(e);\n    }\n  };\n  var onChangeSize = function onChangeSize(value, changeHeight) {\n    if (changeHeight === void 0) {\n      changeHeight = false;\n    }\n    try {\n      var m = Math.max(Math.min(value, 4000), 32);\n      var newState = _extends({}, state);\n      if (changeHeight) {\n        if (newState.maxHeight === m) return Promise.resolve();\n        newState.maxHeight = m;\n      } else {\n        if (newState.maxWidth === m) return Promise.resolve();\n        newState.maxWidth = m;\n      }\n      setState(newState);\n      var _temp4 = _catch(function () {\n        return Promise.resolve(applyChanges(newState, changeHeight)).then(function () {});\n      }, function (error) {\n        console.log(\"onChangeSize ~ error\", error);\n      });\n      return Promise.resolve(_temp4 && _temp4.then ? _temp4.then(function () {}) : void 0);\n    } catch (e) {\n      return Promise.reject(e);\n    }\n  };\n  var onUpdateQuality = function onUpdateQuality(quality) {\n    try {\n      quality = Math.max(Math.min(quality, 100), 1);\n      var newState = _extends({}, state, {\n        quality: quality\n      });\n      setState(newState);\n      var _temp2 = _catch(function () {\n        return Promise.resolve(applyChanges(newState, false)).then(function () {});\n      }, function (error) {\n        console.log(\"onUpdateQuality ~ error\", error);\n      });\n      return Promise.resolve(_temp2 && _temp2.then ? _temp2.then(function () {}) : void 0);\n    } catch (e) {\n      return Promise.reject(e);\n    }\n  };\n  var applyChanges = function applyChanges(stateIntance, changeHeight) {\n    if (changeHeight === void 0) {\n      changeHeight = false;\n    }\n    try {\n      var _temp10 = _catch(function () {\n        return Promise.resolve(convertImageUsingCanvas(state.originImageSrc, changeHeight, stateIntance)).then(function (_ref2) {\n          var newState = _ref2.state,\n            imageUri = _ref2.imageUri;\n          setImageSrc(imageUri);\n          setState(newState);\n        });\n      }, function (error) {\n        console.log(\"🚀 ~ file: EditImage.tsx ~ line 73 ~ applyChanges ~ error\", error);\n      });\n      return Promise.resolve(_temp10 && _temp10.then ? _temp10.then(function () {}) : void 0);\n    } catch (e) {\n      return Promise.reject(e);\n    }\n  };\n  var _ref$labels = _ref.labels,\n    labels = _ref$labels === void 0 ? {} : _ref$labels,\n    _ref$image = _ref.image,\n    image = _ref$image === void 0 ? '' : _ref$image,\n    _ref$color = _ref.color,\n    color = _ref$color === void 0 ? '#1e88e5' : _ref$color,\n    _ref$initialState = _ref.initialState,\n    initialState = _ref$initialState === void 0 ? _initialState$1 : _ref$initialState,\n    _ref$saveUpdates = _ref.saveUpdates,\n    saveUpdates = _ref$saveUpdates === void 0 ? function () {} : _ref$saveUpdates;\n  var _useState = useState(initialState),\n    state = _useState[0],\n    setState = _useState[1];\n  var _useState2 = useState(''),\n    imageSrc = _useState2[0],\n    setImageSrc = _useState2[1];\n  var _useState3 = useState(false),\n    showCrop = _useState3[0],\n    setShowCrop = _useState3[1];\n  var _useState4 = useState({\n      width: 150,\n      height: 150\n    }),\n    croppSize = _useState4[0],\n    setCroppSize = _useState4[1];\n  var _useState5 = useState(),\n    croppState = _useState5[0],\n    setCroppState = _useState5[1];\n  var isMobile = useRef(false);\n  var allFormats = ['webp', 'jpeg', 'png'];\n  useEffect(function () {\n    isMobile.current = window.innerWidth < 800;\n    setState(JSON.parse(JSON.stringify(_extends({}, state, initialState))));\n  }, [initialState]);\n  useEffect(function () {\n    setImageSrc(image);\n  }, [image]);\n  useEffect(function () {\n    if (!showCrop) {\n      setCroppSize({\n        width: 150,\n        height: 150\n      });\n    }\n  }, [showCrop]);\n  function onChangeCrop(width, height) {\n    if (width) {\n      setState(_extends({}, state, {\n        cropWidth: width\n      }));\n      setCroppSize(_extends({}, croppSize, {\n        width: width\n      }));\n    }\n    if (height) {\n      setState(_extends({}, state, {\n        cropHeight: height\n      }));\n      setCroppSize(_extends({}, croppSize, {\n        height: height\n      }));\n    }\n  }\n  function onCrop() {\n    var newState = _cloneObject(state);\n    var canvas = document.createElement('canvas');\n    return new Promise(function (resolve, reject) {\n      var ctx = canvas.getContext('2d');\n      var image = new Image();\n      image.src = imageSrc;\n      image.onload = function () {\n        var newWidth = croppState === null || croppState === void 0 ? void 0 : croppState.width;\n        var newHeight = croppState === null || croppState === void 0 ? void 0 : croppState.height;\n        canvas.height = newHeight;\n        canvas.width = newWidth;\n        ctx.drawImage(image, Math.abs(croppState === null || croppState === void 0 ? void 0 : croppState.x), Math.abs(croppState === null || croppState === void 0 ? void 0 : croppState.y), croppState === null || croppState === void 0 ? void 0 : croppState.width, croppState === null || croppState === void 0 ? void 0 : croppState.height, 0, 0, croppState === null || croppState === void 0 ? void 0 : croppState.width, croppState === null || croppState === void 0 ? void 0 : croppState.height);\n        return resolve(canvas.toDataURL(\"image/\" + newState.format, newState.quality));\n      };\n      image.onerror = function (e) {\n        reject(e);\n      };\n    }).then(function (dataUri) {\n      newState.maxWidth = canvas.width;\n      newState.maxHeight = canvas.height;\n      newState.originImageSrc = dataUri;\n      newState = saveState(newState, dataUri);\n      setState(newState);\n      setImageSrc(dataUri);\n      setShowCrop(false);\n    })[\"catch\"](function (e) {\n      console.log(e);\n    });\n  }\n  function onCroppUpdate(data) {\n    setCroppState(data);\n    setState(_extends({}, state, {\n      cropHeight: data.height,\n      cropWidth: data.width\n    }));\n  }\n  function onCloseEditPanel(saveChanges) {\n    if (saveChanges === void 0) {\n      saveChanges = false;\n    }\n    setShowCrop(false);\n    if (saveChanges) saveUpdates({\n      state: state,\n      imageSrc: imageSrc\n    });else saveUpdates(null);\n  }\n  var sizeImage = useMemo(function () {\n    if (imageSrc && imageSrc.length) {\n      return Math.ceil(3 / 4 * imageSrc.length / 1024);\n    } else {\n      return '';\n    }\n  }, [imageSrc]);\n  function _cloneObject(obj) {\n    return JSON.parse(JSON.stringify(obj));\n  }\n  return React.createElement(\"div\", {\n    className: \"EditImage\"\n  }, React.createElement(\"div\", {\n    id: \"popup\",\n    className: \"popup\"\n  }, React.createElement(\"div\", {\n    style: {\n      flexDirection: 'row',\n      'boxSizing': 'border-box',\n      display: 'flex',\n      'placeContent': 'center flex-end',\n      'alignItems': 'center',\n      padding: '0px 16px'\n    }\n  }, React.createElement(\"button\", {\n    className: \"icon-btn\",\n    onClick: function onClick() {\n      onCloseEditPanel(false);\n    }\n  }, React.createElement(\"span\", {\n    className: \"material-icons\"\n  }, \"clear\"))), React.createElement(\"div\", {\n    className: \"image-container\"\n  }, React.createElement(\"div\", {\n    className: \"image-holder-full\"\n  }, !showCrop && React.createElement(\"img\", {\n    id: \"image-full\",\n    src: imageSrc\n  }), showCrop && React.createElement(CropprWrapper, {\n    src: imageSrc,\n    size: croppSize,\n    croppUpdate: onCroppUpdate\n  })), React.createElement(\"div\", {\n    className: \"control-panel\"\n  }, React.createElement(TabContainer, {\n    lazy: true,\n    borderLine: true\n  }, React.createElement(TabItem, {\n    name: \"Basic\"\n  }, (!isMobile.current || isMobile.current && !showCrop) && React.createElement(React.Fragment, null, React.createElement(\"div\", {\n    style: {\n      display: 'flex',\n      width: '100%',\n      justifyContent: 'space-between'\n    }\n  }, React.createElement(\"p\", {\n    className: \"item-panel\"\n  }, labels['Quality']), React.createElement(\"p\", {\n    className: \"item-panel\"\n  }, state.quality + '%')), React.createElement(\"div\", {\n    className: 'flex-row-start'\n  }, React.createElement(Input, {\n    readOnly: showCrop,\n    disabled: showCrop,\n    className: \"input-range\",\n    onChangedDelayed: onUpdateQuality,\n    onChangedValue: function onChangedValue(value) {\n      setState(_extends({}, state, {\n        quality: value\n      }));\n    },\n    style: {\n      maxWidth: '100%',\n      width: '100%',\n      color: color\n    },\n    type: \"range\",\n    min: 1,\n    max: 100,\n    value: state.quality\n  })), React.createElement(\"div\", {\n    className: \"item-panel\",\n    style: {\n      display: 'flex',\n      width: '100%',\n      justifyContent: 'space-between'\n    }\n  }, labels['Max dimensions'], React.createElement(\"div\", {\n    style: {\n      display: 'flex',\n      alignItems: 'center'\n    }\n  }, React.createElement(\"input\", {\n    disabled: showCrop,\n    readOnly: showCrop,\n    type: \"checkbox\",\n    checked: state.maintainAspectRatio,\n    onChange: function onChange(e) {\n      return setState(_extends({}, state, {\n        maintainAspectRatio: e.target.checked\n      }));\n    },\n    style: {\n      color: color\n    }\n  }), React.createElement(\"span\", {\n    className: \"caption\"\n  }, labels['aspect-ratio']))), React.createElement(\"div\", {\n    className: 'flex-row-start',\n    style: {\n      marginTop: '10px',\n      justifyContent: 'space-between'\n    }\n  }, React.createElement(\"div\", {\n    className: \"form-field\",\n    style: {\n      maxWidth: '48%',\n      width: '48%'\n    }\n  }, React.createElement(\"label\", null, labels['max-width(px)']), React.createElement(Input, {\n    readOnly: showCrop,\n    disabled: showCrop,\n    placeholder: labels['max-width(px)'],\n    value: state.maxWidth,\n    onChangedValue: function onChangedValue(value) {\n      return setState(_extends({}, state, {\n        maxWidth: value\n      }));\n    },\n    type: \"number\",\n    min: 0,\n    max: 2000,\n    onInputChangedEnd: function onInputChangedEnd(value) {\n      onChangeSize(value, false);\n    }\n  })), React.createElement(\"div\", {\n    className: \"form-field\",\n    style: {\n      maxWidth: '48%',\n      width: '48%'\n    }\n  }, React.createElement(\"label\", null, labels['max-height(px)']), React.createElement(Input, {\n    readOnly: showCrop,\n    disabled: showCrop,\n    placeholder: labels['max-height(px)'],\n    value: state.maxHeight,\n    onChangedValue: function onChangedValue(value) {\n      return setState(_extends({}, state, {\n        maxHeight: value\n      }));\n    },\n    type: \"number\",\n    min: 0,\n    max: 2000,\n    onInputChangedEnd: function onInputChangedEnd(value) {\n      onChangeSize(value, true);\n    }\n  }))), React.createElement(\"p\", {\n    className: \"item-panel\"\n  }, labels['Format']), React.createElement(\"div\", {\n    className: 'flex-row-start',\n    style: {\n      marginTop: '10px',\n      justifyContent: 'space-between'\n    }\n  }, React.createElement(\"div\", {\n    className: \"form-field\",\n    style: {\n      width: '100%'\n    }\n  }, React.createElement(\"select\", {\n    disabled: showCrop,\n    value: state.format,\n    onChange: onChangeFormat\n  }, allFormats.map(function (formatItem, index) {\n    return React.createElement(\"option\", {\n      key: index,\n      value: formatItem\n    }, formatItem);\n  }))))), React.createElement(\"div\", {\n    className: 'flex-row-start',\n    style: {\n      marginTop: '5px',\n      justifyContent: 'space-between'\n    }\n  }, React.createElement(\"span\", {\n    style: {\n      display: 'flex',\n      alignItems: 'center'\n    }\n  }, React.createElement(\"input\", {\n    type: \"checkbox\",\n    onChange: function onChange(e) {\n      setShowCrop(e.target.checked);\n    },\n    checked: showCrop,\n    style: {\n      color: color,\n      marginBottom: '3px'\n    }\n  }), React.createElement(\"span\", {\n    className: \"item-panel\",\n    style: {\n      marginLeft: '4px'\n    }\n  }, labels['Crop']))), showCrop && React.createElement(React.Fragment, null, React.createElement(\"div\", {\n    className: 'flex-row-start',\n    style: {\n      marginTop: '10px',\n      justifyContent: 'space-between'\n    }\n  }, React.createElement(\"div\", {\n    className: \"form-field\",\n    style: {\n      maxWidth: '48%',\n      width: '48%'\n    }\n  }, React.createElement(\"label\", null, labels['width(px)']), React.createElement(Input, {\n    type: \"number\",\n    min: 0,\n    value: state.cropWidth,\n    onChangedValue: function onChangedValue(value) {\n      return setState(_extends({}, state, {\n        cropWidth: value\n      }));\n    },\n    onInputChangedEnd: function onInputChangedEnd(value) {\n      onChangeCrop(+value, null);\n    },\n    placeholder: labels['width(px)']\n  })), React.createElement(\"div\", {\n    className: \"form-field\",\n    style: {\n      maxWidth: '48%',\n      width: '48%'\n    }\n  }, React.createElement(\"label\", null, labels['height(px)']), React.createElement(Input, {\n    type: \"number\",\n    min: 0,\n    value: state.cropHeight,\n    onInputChangedEnd: function onInputChangedEnd(value) {\n      onChangeCrop(null, +value);\n    },\n    onChangedValue: function onChangedValue(value) {\n      return setState(_extends({}, state, {\n        cropHeight: value\n      }));\n    },\n    placeholder: labels['height(px)']\n  }))), React.createElement(\"p\", {\n    style: {\n      marginBottom: '4px !important'\n    }\n  }, React.createElement(\"button\", {\n    title: \"Cut the image\",\n    className: \"icon-btn\",\n    onClick: onCrop\n  }, React.createElement(\"span\", {\n    className: \"material-icons\"\n  }, \" crop \"))))), React.createElement(TabItem, {\n    disabled: showCrop,\n    name: \"Filters\"\n  }, React.createElement(BasicFilter, {\n    color: color,\n    labels: labels,\n    initialState: state.basicFilters,\n    changeFilter: onChangeFilters\n  }))), React.createElement(\"button\", {\n    title: labels['Undo'],\n    disabled: state.arrayCopiedImages.length <= 1,\n    style: {\n      position: 'absolute',\n      right: '10px',\n      top: '30px'\n    },\n    className: \"icon-btn\",\n    onClick: onRestore\n  }, React.createElement(\"span\", {\n    className: \"material-icons\"\n  }, \" refresh \")), React.createElement(\"div\", {\n    className: 'flex-row-start',\n    style: {\n      marginTop: '10px',\n      justifyContent: 'space-between',\n      alignItems: 'center'\n    }\n  }, React.createElement(\"button\", {\n    className: \"save-btn\",\n    onClick: function onClick() {\n      onCloseEditPanel(true);\n    }\n  }, labels['Save']), sizeImage && React.createElement(\"p\", {\n    className: \"caption image-caption\",\n    style: {\n      color: sizeImage > 120 ? '#f44336' : 'unset',\n      fontWeight: sizeImage > 120 ? '500' : 'unset'\n    }\n  }, \"size: \", sizeImage, \"Kb \\xA0 \", state.format))))));\n});\nvar initialConfig = {\n  language: 'en',\n  objectFit: 'cover',\n  hideDeleteBtn: false,\n  hideDownloadBtn: false,\n  hideEditBtn: false,\n  hideAddBtn: false\n};\nvar ReactImagePickerEditor = memo(function (_ref) {\n  var handleReaderLoaded = function handleReaderLoaded(readerEvt) {\n    try {\n      var binaryString = readerEvt.target.result;\n      var base64textString = btoa(binaryString);\n      var newState = _extends({}, state);\n      var newImageSrc = urlImage.current + base64textString;\n      newState.originImageSrc = urlImage.current + base64textString;\n      var _temp4 = function () {\n        if (configuration.compressInitial) {\n          newState = _extends({}, newState, {\n            quality: Math.min(configuration.compressInitial || 92, 100),\n            maintainAspectRatio: true,\n            format: 'jpeg'\n          });\n          return Promise.resolve(convertImageUsingCanvas(newState.originImageSrc, false, newState, {\n            getDimFromImage: true\n          })).then(function (result) {\n            setState(result.state);\n            setImageSrc(result.imageUri);\n            imageChanged(result.imageUri);\n            setLoadImage(true);\n          });\n        } else {\n          var img = document.createElement('img');\n          img.src = newImageSrc;\n          img.onload = function () {\n            newState.arrayCopiedImages = [];\n            newState.maxHeight = img.height;\n            newState.maxWidth = img.width;\n            newState.format = fileType.current.split('image/')[1];\n            newState.arrayCopiedImages.push({\n              lastImage: newImageSrc,\n              width: img.width,\n              height: img.height,\n              quality: newState.quality,\n              format: fileType.current.split('image/')[1],\n              originImageSrc: newState.originImageSrc\n            });\n            setState(newState);\n            setImageSrc(newImageSrc);\n            imageChanged(newImageSrc);\n            setLoadImage(true);\n          };\n        }\n      }();\n      return Promise.resolve(_temp4 && _temp4.then ? _temp4.then(function () {}) : void 0);\n    } catch (e) {\n      return Promise.reject(e);\n    }\n  };\n  var _ref$config = _ref.config,\n    config = _ref$config === void 0 ? {} : _ref$config,\n    _ref$imageSrcProp = _ref.imageSrcProp,\n    imageSrcProp = _ref$imageSrcProp === void 0 ? '' : _ref$imageSrcProp,\n    _ref$color = _ref.color,\n    color = _ref$color === void 0 ? '#1e88e5' : _ref$color,\n    _ref$imageChanged = _ref.imageChanged,\n    imageChanged = _ref$imageChanged === void 0 ? function () {} : _ref$imageChanged;\n  var _useState = useState({\n      quality: 92,\n      maxHeight: 1000,\n      maxWidth: 1000,\n      cropHeight: 150,\n      cropWidth: 150,\n      maintainAspectRatio: true,\n      format: 'jpeg',\n      arrayCopiedImages: [],\n      originImageSrc: ''\n    }),\n    state = _useState[0],\n    setState = _useState[1];\n  var _useState2 = useState(''),\n    imageSrc = _useState2[0],\n    setImageSrc = _useState2[1];\n  var _useState3 = useState(false),\n    loadImage = _useState3[0],\n    setLoadImage = _useState3[1];\n  var _useState4 = useState(false),\n    showEditPanel = _useState4[0],\n    setShowEditPanel = _useState4[1];\n  var _useState5 = useState(labelEn),\n    labels = _useState5[0],\n    setLabels = _useState5[1];\n  var _useState6 = useState(initialConfig),\n    configuration = _useState6[0],\n    setConfiguration = _useState6[1];\n  var imagePicker = useRef(null);\n  var fileType = useRef('');\n  var urlImage = useRef('');\n  var uuidFilePicker = Date.now().toString(20);\n  var imageName = useRef('donload');\n  useEffect(function () {\n    appendLinkIconsToHead();\n    processConfig();\n  }, [config]);\n  useEffect(function () {\n    (function () {\n      try {\n        var _temp2 = function () {\n          if (imageSrcProp) {\n            return Promise.resolve(parseToBase64(imageSrcProp)).then(function (result) {\n              var newState = result.state;\n              newState.originImageSrc = imageSrcProp;\n              newState.arrayCopiedImages.push({\n                lastImage: result.imageUri,\n                width: newState.maxWidth,\n                height: newState.maxHeight,\n                quality: newState.quality,\n                format: newState.format,\n                originImageSrc: imageSrcProp\n              });\n              setImageSrc(result.imageUri);\n              setState(newState);\n              setLoadImage(true);\n            });\n          } else {\n            var newState = _extends({}, state);\n            newState.originImageSrc = null;\n            newState.arrayCopiedImages = [];\n            newState = _extends({}, newState, {\n              format: 'jpeg',\n              maxHeight: 1000,\n              maxWidth: 1000,\n              cropHeight: 150,\n              cropWidth: 150,\n              maintainAspectRatio: true,\n              basicFilters: undefined\n            });\n            setLoadImage(false);\n            setImageSrc(null);\n            setState(newState);\n          }\n        }();\n        return _temp2 && _temp2.then ? _temp2.then(function () {}) : void 0;\n      } catch (e) {\n        Promise.reject(e);\n      }\n    })();\n  }, [imageSrcProp]);\n  function processConfig() {\n    var dataConf = _extends({}, configuration, config);\n    setConfiguration(dataConf);\n    if (config.language != undefined) {\n      if (config.language == 'en') {\n        setLabels(_extends({}, labelEn));\n      }\n      if (config.language == 'es') {\n        setLabels(_extends({}, labelEs));\n      }\n      if (config.language == 'fr') {\n        setLabels(_extends({}, labelFr));\n      }\n      if (config.language == 'de') {\n        setLabels(_extends({}, labelDe));\n      }\n    }\n  }\n  function appendLinkIconsToHead() {\n    var head = document.head;\n    var linkIcons = head.querySelector('#ngp-image-picker-icons-id');\n    if (linkIcons) return;\n    var link = document.createElement('link');\n    link.href = 'https://fonts.googleapis.com/icon?family=Material+Icons';\n    link.rel = 'stylesheet';\n    link.id = 'ngp-image-picker-icons-id';\n    head.appendChild(link);\n  }\n  function onUpload(event) {\n    var _imagePicker$current;\n    event.preventDefault();\n    imagePicker === null || imagePicker === void 0 ? void 0 : (_imagePicker$current = imagePicker.current) === null || _imagePicker$current === void 0 ? void 0 : _imagePicker$current.click();\n  }\n  function handleFileSelect(event) {\n    var _event$target;\n    var files = (_event$target = event.target) === null || _event$target === void 0 ? void 0 : _event$target.files;\n    if (files) {\n      var file = files[0];\n      imageName.current = file.name.split('.')[0];\n      fileType.current = file.type;\n      if (!fileType.current.includes('image')) return;\n      urlImage.current = \"data:\" + file.type + \";base64,\";\n      if (file) {\n        setState(_extends({}, state, {\n          format: fileType.current.split('image/')[1]\n        }));\n        var reader = new FileReader();\n        reader.onload = handleReaderLoaded.bind(this);\n        reader.readAsBinaryString(file);\n      }\n    }\n  }\n  var sizeImage = useMemo(function () {\n    if (imageSrc && imageSrc.length) {\n      return Math.ceil(3 / 4 * imageSrc.length / 1024);\n    } else {\n      return '';\n    }\n  }, [imageSrc]);\n  function parseToBase64(imageUrl) {\n    var newState = _extends({}, state);\n    var types = imageUrl.split('.');\n    var type = types[types.length - 1];\n    if (type && (type == 'png' || type == 'jpeg' || type == 'webp')) {\n      type = type;\n    } else {\n      type = 'jpeg';\n    }\n    newState.format = type;\n    return new Promise(function (resolve, reject) {\n      var img = new Image();\n      img.crossOrigin = 'Anonymous';\n      newState.maxHeight = img.height;\n      newState.maxWidth = img.width;\n      img.onload = function () {\n        var canvas = document.createElement('canvas');\n        var ctx = canvas.getContext('2d');\n        var ratio = 1.0;\n        canvas.width = img.width * ratio;\n        canvas.height = img.height * ratio;\n        ctx.drawImage(img, 0, 0, canvas.width, canvas.height);\n        var dataURI = canvas.toDataURL(\"image/\" + type, newState.quality);\n        return resolve({\n          dataUri: dataURI,\n          width: canvas.width,\n          height: canvas.height\n        });\n      };\n      img.onerror = function (e) {\n        return reject(e.message || \"Error loading the src = \" + imageUrl);\n      };\n      img.src = imageUrl;\n    }).then(function (data) {\n      newState = _extends({}, newState, {\n        maxHeight: data.height,\n        maxWidth: data.width\n      });\n      return {\n        imageUri: data.dataUri,\n        state: newState\n      };\n    });\n  }\n  function onOpenEditPanel() {\n    setShowEditPanel(true);\n  }\n  function onCloseEditPanel(data) {\n    setShowEditPanel(false);\n    if (data) {\n      setState(data.state);\n      setImageSrc(data.imageSrc);\n      imageChanged(data.imageSrc);\n    }\n  }\n  function onRemove() {\n    setImageSrc(null);\n    setLoadImage(false);\n    imageChanged(null);\n    var newState = _extends({}, state, {\n      originImageSrc: '',\n      format: 'jpeg',\n      maxHeight: 1000,\n      maxWidth: 1000,\n      cropHeight: 150,\n      cropWidth: 150,\n      maintainAspectRatio: true,\n      arrayCopiedImages: [],\n      basicFilters: undefined,\n      quality: 92\n    });\n    setState(newState);\n    setShowEditPanel(false);\n  }\n  return React.createElement(\"div\", {\n    className: \"ReactImagePickerEditor\"\n  }, !loadImage && React.createElement(\"div\", {\n    className: \"place-image\"\n  }, React.createElement(\"div\", {\n    className: \"image-holder\",\n    style: {\n      width: configuration.width,\n      height: configuration.height,\n      borderRadius: configuration.borderRadius,\n      aspectRatio: configuration.aspectRatio + ''\n    }\n  }, React.createElement(\"button\", {\n    title: labels['Upload a image'],\n    className: \"icon-btn image-upload-btn\",\n    onClick: onUpload\n  }, React.createElement(\"span\", {\n    className: \"material-icons\"\n  }, \"add_a_photo\")), React.createElement(\"input\", {\n    ref: imagePicker,\n    type: \"file\",\n    style: {\n      \"display\": \"none\"\n    },\n    id: 'filePicker-' + uuidFilePicker,\n    onChange: handleFileSelect\n  }))), loadImage && React.createElement(\"div\", {\n    className: \"place-image\"\n  }, React.createElement(\"div\", {\n    className: \"image-holder-loaded\",\n    style: {\n      width: configuration.width,\n      height: configuration.height,\n      borderRadius: configuration.borderRadius,\n      aspectRatio: configuration.aspectRatio + ''\n    }\n  }, React.createElement(\"img\", {\n    src: imageSrc,\n    alt: \"image-loaded\",\n    style: {\n      borderRadius: configuration.borderRadius,\n      objectFit: configuration.objectFit\n    }\n  }), React.createElement(\"div\", {\n    className: \"curtain\",\n    onClick: onUpload\n  }, React.createElement(\"button\", {\n    title: labels['Upload a image']\n  }, React.createElement(\"span\", {\n    className: \"material-icons\"\n  }, \"add_a_photo\"))), React.createElement(\"input\", {\n    ref: imagePicker,\n    type: \"file\",\n    style: {\n      \"display\": \"none\"\n    },\n    id: 'filePicker-' + uuidFilePicker,\n    onChange: handleFileSelect\n  })), sizeImage && React.createElement(\"p\", {\n    className: \"caption image-caption\",\n    style: {\n      color: sizeImage > 120 ? '#f44336' : 'unset',\n      fontWeight: sizeImage > 120 ? '500' : 'unset'\n    }\n  }, \"size: \", sizeImage, \"Kb \\xA0 \", state.format), React.createElement(\"div\", {\n    style: {\n      flexDirection: 'row',\n      'boxSizing': 'border-box',\n      display: 'flex',\n      'placeContent': 'flex-start',\n      'alignItems': 'flex-start'\n    },\n    className: \"editing-bar-btn\"\n  }, !configuration.hideAddBtn && React.createElement(\"button\", {\n    className: \"icon-btn\",\n    id: \"upload-img\",\n    title: labels['Upload a image'],\n    onClick: onUpload\n  }, React.createElement(\"span\", {\n    className: \"material-icons\"\n  }, \"add_a_photo\")), !configuration.hideEditBtn && React.createElement(\"button\", {\n    className: \"icon-btn\",\n    id: \"edit-img\",\n    title: labels['Open the editor panel'],\n    onClick: onOpenEditPanel\n  }, React.createElement(\"span\", {\n    className: \"material-icons\"\n  }, \"edit\")), !configuration.hideDownloadBtn && React.createElement(\"a\", {\n    id: \"download-img\",\n    title: labels['Download the image'],\n    href: imageSrc,\n    download: imageName.current\n  }, React.createElement(\"span\", {\n    className: \"material-icons\"\n  }, \"cloud_download\")), !configuration.hideDeleteBtn && React.createElement(\"button\", {\n    className: \"icon-btn\",\n    id: \"delete-img\",\n    title: labels['Remove'],\n    onClick: function onClick() {\n      return onRemove();\n    }\n  }, React.createElement(\"span\", {\n    className: \"material-icons\"\n  }, \"delete\")))), showEditPanel && React.createElement(EditImage, {\n    saveUpdates: onCloseEditPanel,\n    labels: labels,\n    color: color,\n    image: imageSrc,\n    initialState: state\n  }));\n});\nexport default ReactImagePickerEditor;","map":{"version":3,"mappings":"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","names":["MAX_BUFFER_UNDO_MEMORY","convertImageUsingCanvas","dataSrc","changeHeight","state","options","Promise","resolve","_","img","document","createElement","src","crossOrigin","quality","maintainRatio","maintainAspectRatio","onload","canvas","ctx","getContext","ratio","width","height","maxWidth","maxHeight","getDimFromImage","basicFilters","filter","processFilter","drawImage","type","format","dataURI","toDataURL","dataUri","then","data","imageUri","saveState","Object","keys","map","key","includes","join","lastImage","arrayCopiedImages","length","push","originImageSrc","JSON","parse","stringify","_iteratorSymbol","Symbol","iterator","_asyncIteratorSymbol","asyncIterator","_catch","body","recover","result","e","TabContainer","memo","activeIndex","children","backgroundColor","color","indicatorStyle","onTabChange","index","transitionMs","borderLine","fontColor","lazy","useState","header","setHeader","activeTab","setActiveTab","tabContainerRef","useRef","useEffect","tabsItems","Array","checkChildrens","tabs","label","el","props","name","icon","disabled","Error","React","ref","className","style","borderBottom","onClick","tabEl","transform","overflow","transition","visibility","position","TabItem","padding","Input","onInputChangedEnd","onChangedDelayed","onChangedValue","delayMs","restProps","value","setState","timerRef","mountRef","flagRef","current","setTimeout","clearTimeout","changeValue","target","checked","Fragment","onChange","onBlur","onKeyDown","_initialState","contrast","blur","brightness","grayscale","invert","saturate","sepia","BasicFilter","labels","initialState","changeFilter","onUpdateContrast","onUpdateBrightness","onUpdateGrayscale","onUpdateSaturate","onUpdateSepia","onUpdateBlur","display","justifyContent","toFixed","min","max","step","lastTime","vendors","x","window","requestAnimationFrame","cancelAnimationFrame","callback","element","currTime","Date","getTime","timeToCall","Math","id","CustomEvent","event","params","bubbles","cancelable","detail","undefined","evt","createEvent","initCustomEvent","prototype","Event","MouseEvent","eventType","mouseEvent","initMouseEvent","Handle","constraints","cursor","eventBus","self","addEventListener","onMouseDown","stopPropagation","onMouseUp","onMouseMove","dispatchEvent","handle","removeEventListener","mouseX","clientX","mouseY","clientY","Box","x1","y1","x2","y2","set","abs","resize","newWidth","newHeight","origin","fromX","fromY","scale","factor","move","y","getRelativePoint","point","getAbsolutePoint","constrainToRatio","grow","constrainToBoundary","boundaryWidth","boundaryHeight","originX","originY","maxIfLeft","maxIfTop","maxIfRight","maxIfBottom","directionX","directionY","constrainToSize","minWidth","minHeight","enableTouch","simulateMouseEvent","preventDefault","touch","changedTouches","eventMap","touchstart","touchmove","touchend","view","screenX","screenY","HANDLES","CropprCore","deferred","parseOptions","nodeName","querySelector","getAttribute","_initialized","_restore","parent","parentNode","_this","initialize","createDOM","convertToPixels","cropperEl","attachHandlerEvents","attachRegionEvents","attachOverlayEvents","box","initializeBox","redraw","onInitialize","targetEl","containerEl","imageEl","setAttribute","imageClippedEl","cloneNode","regionEl","innerHTML","fill","overlayEl","handleContainerEl","handles","i","appendChild","parentElement","replaceChild","setImage","_this2","destroy","opts","startSize","aspectRatio","minSize","maxSize","parentWidth","offsetWidth","parentHeight","offsetHeight","round","_this3","clip","center","xSign","ySign","quadrant","foregroundHandleIndex","handleWidth","handleHeight","left","top","zIndex","onHandleMoveStart","bind","onHandleMoveMoving","onHandleMoveEnd","onRegionMoveStart","onRegionMoveMoving","onRegionMoveEnd","SOUTHEAST_HANDLE_IDX","tmpBox","container","getBoundingClientRect","originPoint","activeHandle","onCropStart","getValue","slice","TOP_MOVABLE","RIGHT_MOVABLE","BOTTOM_MOVABLE","LEFT_MOVABLE","MULTI_AXIS","isFlippedX","isFlippedY","tmp","isVerticalMovement","ratioMode","onCropMove","onCropEnd","currentMove","offsetX","offsetY","mode","returnMode","actualWidth","naturalWidth","actualHeight","naturalHeight","elementWidth","elementHeight","factorX","factorY","defaults","unit","onUpdate","console","warn","s","toLowerCase","indexOf","sizeKeys","defaultValue","v","d","decimals","Number","Croppr","_deferred","_CropprCore","moveTo","resizeTo","scaleBy","reset","newOptions","enableVisibility","croppContainer","CropprWrapper","size","croppUpdate","imageSrc","setImageSrc","croppSize","setCroppSize","croppr","mount","_croppr$current","cropHeight","cropWidth","EditImage","onChangeFilters","newState","_cloneObject","applyChanges","log","onRestore","pop","newValue","onChangeFormat","error","onChangeSize","m","onUpdateQuality","stateIntance","image","saveUpdates","showCrop","setShowCrop","croppState","setCroppState","isMobile","allFormats","innerWidth","onChangeCrop","onCrop","reject","Image","onerror","onCroppUpdate","onCloseEditPanel","saveChanges","sizeImage","useMemo","ceil","obj","flexDirection","readOnly","alignItems","marginTop","placeholder","formatItem","marginBottom","marginLeft","title","right","fontWeight","initialConfig","language","objectFit","hideDeleteBtn","hideDownloadBtn","hideEditBtn","hideAddBtn","ReactImagePickerEditor","handleReaderLoaded","readerEvt","binaryString","base64textString","btoa","newImageSrc","urlImage","configuration","compressInitial","imageChanged","setLoadImage","fileType","split","config","imageSrcProp","loadImage","showEditPanel","setShowEditPanel","labelEn","setLabels","setConfiguration","imagePicker","uuidFilePicker","now","toString","imageName","appendLinkIconsToHead","processConfig","parseToBase64","dataConf","labelEs","labelFr","labelDe","head","linkIcons","link","href","rel","onUpload","click","handleFileSelect","files","_event$target","file","reader","FileReader","readAsBinaryString","imageUrl","types","message","onOpenEditPanel","onRemove","borderRadius","alt","download"],"sources":["E:\\Front End\\React\\Aiva Project\\aiva-project\\node_modules\\react-image-picker-editor\\src\\functions\\image-processing.ts","E:\\Front End\\React\\Aiva Project\\aiva-project\\node_modules\\react-image-picker-editor\\node_modules\\babel-plugin-transform-async-to-promises\\helpers.mjs","E:\\Front End\\React\\Aiva Project\\aiva-project\\node_modules\\react-image-picker-editor\\src\\components\\Tab\\Tab.tsx","E:\\Front End\\React\\Aiva Project\\aiva-project\\node_modules\\react-image-picker-editor\\src\\components\\Input\\Input.tsx","E:\\Front End\\React\\Aiva Project\\aiva-project\\node_modules\\react-image-picker-editor\\src\\components\\BasicFilters\\BasicFilter.tsx","E:\\Front End\\React\\Aiva Project\\aiva-project\\node_modules\\react-image-picker-editor\\src\\functions\\croppr\\polyfills.ts","E:\\Front End\\React\\Aiva Project\\aiva-project\\node_modules\\react-image-picker-editor\\src\\functions\\croppr\\handle.ts","E:\\Front End\\React\\Aiva Project\\aiva-project\\node_modules\\react-image-picker-editor\\src\\functions\\croppr\\box.ts","E:\\Front End\\React\\Aiva Project\\aiva-project\\node_modules\\react-image-picker-editor\\src\\functions\\croppr\\touch.ts","E:\\Front End\\React\\Aiva Project\\aiva-project\\node_modules\\react-image-picker-editor\\src\\functions\\croppr\\core.ts","E:\\Front End\\React\\Aiva Project\\aiva-project\\node_modules\\react-image-picker-editor\\src\\functions\\croppr\\croppr.ts","E:\\Front End\\React\\Aiva Project\\aiva-project\\node_modules\\react-image-picker-editor\\src\\components\\CropprWrapper\\CropprWrapper.tsx","E:\\Front End\\React\\Aiva Project\\aiva-project\\node_modules\\react-image-picker-editor\\src\\components\\EditImage\\EditImage.tsx","E:\\Front End\\React\\Aiva Project\\aiva-project\\node_modules\\react-image-picker-editor\\src\\index.tsx"],"sourcesContent":["import { IState } from '../models/index.models';\n\nexport const MAX_BUFFER_UNDO_MEMORY = 25;\nlet rotate = 1;\n\nexport const convertImageUsingCanvas = (\n  dataSrc: string,\n  changeHeight = false,\n  state: IState,\n  options?: { getDimFromImage?: boolean; rotate?: number },\n): Promise<{ imageUri: string; state: any }> => {\n  return new Promise(async (resolve, _) => {\n    let img = document.createElement('img');\n    img.src = dataSrc + '';\n    img.crossOrigin = 'Anonymous';\n    let quality = state.quality / 100;\n    let maintainRatio = state.maintainAspectRatio;\n\n    img.onload = () => {\n      var canvas = document.createElement('canvas');\n      let ctx: CanvasRenderingContext2D | null | any = canvas.getContext('2d');\n      let ratio = img.width / img.height;\n      let width = state.maxWidth;\n      let height = state.maxHeight;\n\n      if (options?.getDimFromImage) {\n        width = img.width;\n        height = img.height;\n      }\n\n      if (maintainRatio) {\n        canvas.width = width;\n        canvas.height = width / ratio;\n        if (changeHeight) {\n          canvas.width = height * ratio;\n          canvas.height = height;\n        }\n      } else {\n        canvas.width = width;\n        canvas.height = height;\n      }\n      if (state.basicFilters) {\n        ctx.filter = processFilter(state.basicFilters);\n      }\n      ctx.drawImage(img, 0, 0, canvas.width, canvas.height);\n      let type = state.format;\n      var dataURI = canvas.toDataURL(`image/${type}`, quality);\n      // console.log(\"🚀 ~ file: image-processing.ts ~ line 48 ~ returnnewPromise ~ quality\", quality)\n      resolve({\n        dataUri: dataURI,\n        width: canvas.width,\n        height: canvas.height,\n      });\n    };\n  }).then((data: any) => {\n    state.maxHeight = data.height;\n    state.maxWidth = data.width;\n    return { imageUri: data.dataUri, state: saveState(state, data.dataUri) };\n  });\n\n  function processFilter(data: any) {\n    return Object.keys(data)\n      .map((key) => {\n        if (['blur'].includes(key)) {\n          return `${key}(${data[key]}px)`;\n        } else {\n          return `${key}(${data[key]})`;\n        }\n      })\n      .join('');\n  }\n};\n\nexport const dragElement = (element: any) => {\n  var pos1 = 0,\n    pos2 = 0,\n    pos3 = 0,\n    pos4 = 0;\n  if (document.getElementById(element.id + '-header')) {\n    /* if present, the header is where you move the DIV from:*/\n    let x: any = document.getElementById(element.id + '-header');\n    x.onmousedown = dragPressOn;\n    let y: any = document.getElementById(element.id + '-header');\n    y.ontouchstart = dragPressOn;\n  } else {\n    /* otherwise, move the DIV from anywhere inside the DIV:*/\n    element.ontouchstart = dragPressOn;\n    element.onmousedown = dragPressOn;\n  }\n\n  function dragPressOn(e: any) {\n    let popup: any = document.querySelector('#popup');\n    popup.style.overflowY = 'hidden';\n    e = e || window.event;\n    pos3 = e.clientX;\n    pos4 = e.clientY;\n    document.ontouchend = closeDragElement;\n    document.onmouseup = closeDragElement;\n    document.ontouchmove = elementDragTouch;\n    document.onmousemove = elementDragMouse;\n  }\n\n  function elementDragMouse(e: any) {\n    let holderImage = document.getElementById('image-full');\n    e = e || window.event;\n    pos1 = pos3 - e.clientX;\n    pos3 = e.clientX;\n    pos2 = pos4 - e.clientY;\n    pos4 = e.clientY;\n\n    let newTop = element.offsetTop - pos2;\n    let newLeft = element.offsetLeft - pos1;\n    let rectHolder = holderImage?.getBoundingClientRect();\n    let rectElemnt = element.getBoundingClientRect();\n    // console.log('====================================');\n    // console.log(rectElemnt,rectHolder);\n    // console.log('====================================');\n    newTop = Math.max(newTop, rectHolder?.top as number);\n    newTop = Math.min(\n      newTop,\n      (rectHolder?.bottom as number) - rectElemnt.height,\n    );\n    newLeft = Math.max(newLeft, rectHolder?.left as number);\n    newLeft = Math.min(\n      newLeft,\n      (rectHolder?.right as number) - rectElemnt.width,\n    );\n    element.style.top = newTop + 'px';\n    element.style.left = newLeft + 'px';\n  }\n\n  function elementDragTouch(e: any) {\n    let holderImage = document.getElementById('image-full');\n    e = e || window.event;\n\n    if (e?.changedTouches?.length) {\n      pos1 = pos3 - e.changedTouches[0]?.clientX;\n      pos3 = e.changedTouches[0]?.clientX;\n    }\n    if (e?.changedTouches?.length) {\n      pos2 = pos4 - e.changedTouches[0]?.clientY;\n      pos4 = e.changedTouches[0]?.clientY;\n    }\n\n    let newTop = element.offsetTop - pos2;\n    let newLeft = element.offsetLeft - pos1;\n    let rectHolder = holderImage?.getBoundingClientRect();\n    let rectElemnt = element.getBoundingClientRect();\n\n    // console.log('====================================');\n    // console.log(rectElemnt,rectHolder);\n    // console.log('====================================');\n\n    newTop = Math.max(newTop, rectHolder?.top as number);\n    newTop = Math.min(\n      newTop,\n      (rectHolder?.bottom as number) - rectElemnt.height,\n    );\n    newLeft = Math.max(newLeft, rectHolder?.left as number);\n    newLeft = Math.min(\n      newLeft,\n      (rectHolder?.right as number) - rectElemnt.width,\n    );\n    element.style.top = newTop + 'px';\n    element.style.left = newLeft + 'px';\n  }\n\n  function closeDragElement() {\n    /* stop moving when mouse button is released:*/\n    let popup: any = document.querySelector('#popup');\n    popup.style.overflowY = 'auto';\n    document.onmouseup = null;\n    document.onmousemove = null;\n    document.ontouchend = null;\n    document.ontouchmove = null;\n  }\n};\n\nexport const saveState = (state: IState, lastImage?: string): IState => {\n  if (state.arrayCopiedImages.length <= MAX_BUFFER_UNDO_MEMORY) {\n    state.arrayCopiedImages.push({\n      lastImage: lastImage as any,\n      width: state.maxWidth,\n      height: state.maxHeight,\n      quality: state.quality,\n      format: state.format,\n      originImageSrc: state.originImageSrc as any,\n      basicFilters: state.basicFilters,\n    });\n  } else {\n    state.arrayCopiedImages[state.arrayCopiedImages.length - 1] = {\n      lastImage: lastImage as any,\n      width: state.maxWidth,\n      height: state.maxHeight,\n      quality: state.quality,\n      format: state.format,\n      originImageSrc: state.originImageSrc as any,\n      basicFilters: state.basicFilters,\n    };\n  }\n  return JSON.parse(JSON.stringify(state));\n};\n","// A type of promise-like that resolves synchronously and supports only one observer\nexport const _Pact = /*#__PURE__*/(function() {\n\tfunction _Pact() {}\n\t_Pact.prototype.then = function(onFulfilled, onRejected) {\n\t\tconst result = new _Pact();\n\t\tconst state = this.s;\n\t\tif (state) {\n\t\t\tconst callback = state & 1 ? onFulfilled : onRejected;\n\t\t\tif (callback) {\n\t\t\t\ttry {\n\t\t\t\t\t_settle(result, 1, callback(this.v));\n\t\t\t\t} catch (e) {\n\t\t\t\t\t_settle(result, 2, e);\n\t\t\t\t}\n\t\t\t\treturn result;\n\t\t\t} else {\n\t\t\t\treturn this;\n\t\t\t}\n\t\t}\n\t\tthis.o = function(_this) {\n\t\t\ttry {\n\t\t\t\tconst value = _this.v;\n\t\t\t\tif (_this.s & 1) {\n\t\t\t\t\t_settle(result, 1, onFulfilled ? onFulfilled(value) : value);\n\t\t\t\t} else if (onRejected) {\n\t\t\t\t\t_settle(result, 1, onRejected(value));\n\t\t\t\t} else {\n\t\t\t\t\t_settle(result, 2, value);\n\t\t\t\t}\n\t\t\t} catch (e) {\n\t\t\t\t_settle(result, 2, e);\n\t\t\t}\n\t\t};\n\t\treturn result;\n\t}\n\treturn _Pact;\n})();\n\n// Settles a pact synchronously\nexport function _settle(pact, state, value) {\n\tif (!pact.s) {\n\t\tif (value instanceof _Pact) {\n\t\t\tif (value.s) {\n\t\t\t\tif (state & 1) {\n\t\t\t\t\tstate = value.s;\n\t\t\t\t}\n\t\t\t\tvalue = value.v;\n\t\t\t} else {\n\t\t\t\tvalue.o = _settle.bind(null, pact, state);\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t\tif (value && value.then) {\n\t\t\tvalue.then(_settle.bind(null, pact, state), _settle.bind(null, pact, 2));\n\t\t\treturn;\n\t\t}\n\t\tpact.s = state;\n\t\tpact.v = value;\n\t\tconst observer = pact.o;\n\t\tif (observer) {\n\t\t\tobserver(pact);\n\t\t}\n\t}\n}\n\nexport function _isSettledPact(thenable) {\n\treturn thenable instanceof _Pact && thenable.s & 1;\n}\n\n// Converts argument to a function that always returns a Promise\nexport function _async(f) {\n\treturn function() {\n\t\tfor (var args = [], i = 0; i < arguments.length; i++) {\n\t\t\targs[i] = arguments[i];\n\t\t}\n\t\ttry {\n\t\t\treturn Promise.resolve(f.apply(this, args));\n\t\t} catch(e) {\n\t\t\treturn Promise.reject(e);\n\t\t}\n\t}\n}\n\n// Awaits on a value that may or may not be a Promise (equivalent to the await keyword in ES2015, with continuations passed explicitly)\nexport function _await(value, then, direct) {\n\tif (direct) {\n\t\treturn then ? then(value) : value;\n\t}\n\tif (!value || !value.then) {\n\t\tvalue = Promise.resolve(value);\n\t}\n\treturn then ? value.then(then) : value;\n}\n\n// Awaits on a value that may or may not be a Promise, then ignores it\nexport function _awaitIgnored(value, direct) {\n\tif (!direct) {\n\t\treturn value && value.then ? value.then(_empty) : Promise.resolve();\n\t}\n}\n\n// Proceeds after a value has resolved, or proceeds immediately if the value is not thenable\nexport function _continue(value, then) {\n\treturn value && value.then ? value.then(then) : then(value);\n}\n\n// Proceeds after a value has resolved, or proceeds immediately if the value is not thenable\nexport function _continueIgnored(value) {\n\tif (value && value.then) {\n\t\treturn value.then(_empty);\n\t}\n}\n\n// Asynchronously iterate through an object that has a length property, passing the index as the first argument to the callback (even as the length property changes)\nexport function _forTo(array, body, check) {\n\tvar i = -1, pact, reject;\n\tfunction _cycle(result) {\n\t\ttry {\n\t\t\twhile (++i < array.length && (!check || !check())) {\n\t\t\t\tresult = body(i);\n\t\t\t\tif (result && result.then) {\n\t\t\t\t\tif (_isSettledPact(result)) {\n\t\t\t\t\t\tresult = result.v;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tresult.then(_cycle, reject || (reject = _settle.bind(null, pact = new _Pact(), 2)));\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (pact) {\n\t\t\t\t_settle(pact, 1, result);\n\t\t\t} else {\n\t\t\t\tpact = result;\n\t\t\t}\n\t\t} catch (e) {\n\t\t\t_settle(pact || (pact = new _Pact()), 2, e);\n\t\t}\n\t}\n\t_cycle();\n\treturn pact;\n}\n\n// Asynchronously iterate through an object's properties (including properties inherited from the prototype)\n// Uses a snapshot of the object's properties\nexport function _forIn(target, body, check) {\n\tvar keys = [];\n\tfor (var key in target) {\n\t\tkeys.push(key);\n\t}\n\treturn _forTo(keys, function(i) { return body(keys[i]); }, check);\n}\n\n// Asynchronously iterate through an object's own properties (excluding properties inherited from the prototype)\n// Uses a snapshot of the object's properties\nexport function _forOwn(target, body, check) {\n\tvar keys = [];\n\tfor (var key in target) {\n\t\tif (Object.prototype.hasOwnProperty.call(target, key)) {\n\t\t\tkeys.push(key);\n\t\t}\n\t}\n\treturn _forTo(keys, function(i) { return body(keys[i]); }, check);\n}\n\nexport const _iteratorSymbol = /*#__PURE__*/ typeof Symbol !== \"undefined\" ? (Symbol.iterator || (Symbol.iterator = Symbol(\"Symbol.iterator\"))) : \"@@iterator\";\n\n// Asynchronously iterate through an object's values\n// Uses for...of if the runtime supports it, otherwise iterates until length on a copy\nexport function _forOf(target, body, check) {\n\tif (typeof target[_iteratorSymbol] === \"function\") {\n\t\tvar iterator = target[_iteratorSymbol](), step, pact, reject;\n\t\tfunction _cycle(result) {\n\t\t\ttry {\n\t\t\t\twhile (!(step = iterator.next()).done && (!check || !check())) {\n\t\t\t\t\tresult = body(step.value);\n\t\t\t\t\tif (result && result.then) {\n\t\t\t\t\t\tif (_isSettledPact(result)) {\n\t\t\t\t\t\t\tresult = result.v;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tresult.then(_cycle, reject || (reject = _settle.bind(null, pact = new _Pact(), 2)));\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (pact) {\n\t\t\t\t\t_settle(pact, 1, result);\n\t\t\t\t} else {\n\t\t\t\t\tpact = result;\n\t\t\t\t}\n\t\t\t} catch (e) {\n\t\t\t\t_settle(pact || (pact = new _Pact()), 2, e);\n\t\t\t}\n\t\t}\n\t\t_cycle();\n\t\tif (iterator.return) {\n\t\t\tvar _fixup = function(value) {\n\t\t\t\ttry {\n\t\t\t\t\tif (!step.done) {\n\t\t\t\t\t\titerator.return();\n\t\t\t\t\t}\n\t\t\t\t} catch(e) {\n\t\t\t\t}\n\t\t\t\treturn value;\n\t\t\t}\n\t\t\tif (pact && pact.then) {\n\t\t\t\treturn pact.then(_fixup, function(e) {\n\t\t\t\t\tthrow _fixup(e);\n\t\t\t\t});\n\t\t\t}\n\t\t\t_fixup();\n\t\t}\n\t\treturn pact;\n\t}\n\t// No support for Symbol.iterator\n\tif (!(\"length\" in target)) {\n\t\tthrow new TypeError(\"Object is not iterable\");\n\t}\n\t// Handle live collections properly\n\tvar values = [];\n\tfor (var i = 0; i < target.length; i++) {\n\t\tvalues.push(target[i]);\n\t}\n\treturn _forTo(values, function(i) { return body(values[i]); }, check);\n}\n\nexport const _asyncIteratorSymbol = /*#__PURE__*/ typeof Symbol !== \"undefined\" ? (Symbol.asyncIterator || (Symbol.asyncIterator = Symbol(\"Symbol.asyncIterator\"))) : \"@@asyncIterator\";\n\n// Asynchronously iterate on a value using it's async iterator if present, or its synchronous iterator if missing\nexport function _forAwaitOf(target, body, check) {\n\tif (typeof target[_asyncIteratorSymbol] === \"function\") {\n\t\tvar pact = new _Pact();\n\t\tvar iterator = target[_asyncIteratorSymbol]();\n\t\titerator.next().then(_resumeAfterNext).then(void 0, _reject);\n\t\treturn pact;\n\t\tfunction _resumeAfterBody(result) {\n\t\t\tif (check && check()) {\n\t\t\t\treturn _settle(pact, 1, iterator.return ? iterator.return().then(function() { return result; }) : result);\n\t\t\t}\n\t\t\titerator.next().then(_resumeAfterNext).then(void 0, _reject);\n\t\t}\n\t\tfunction _resumeAfterNext(step) {\n\t\t\tif (step.done) {\n\t\t\t\t_settle(pact, 1);\n\t\t\t} else {\n\t\t\t\tPromise.resolve(body(step.value)).then(_resumeAfterBody).then(void 0, _reject);\n\t\t\t}\n\t\t}\n\t\tfunction _reject(error) {\n\t\t\t_settle(pact, 2, iterator.return ? iterator.return().then(function() { return error; }) : error);\n\t\t}\n\t}\n\treturn Promise.resolve(_forOf(target, function(value) { return Promise.resolve(value).then(body); }, check));\n}\n\n// Asynchronously implement a generic for loop\nexport function _for(test, update, body) {\n\tvar stage;\n\tfor (;;) {\n\t\tvar shouldContinue = test();\n\t\tif (_isSettledPact(shouldContinue)) {\n\t\t\tshouldContinue = shouldContinue.v;\n\t\t}\n\t\tif (!shouldContinue) {\n\t\t\treturn result;\n\t\t}\n\t\tif (shouldContinue.then) {\n\t\t\tstage = 0;\n\t\t\tbreak;\n\t\t}\n\t\tvar result = body();\n\t\tif (result && result.then) {\n\t\t\tif (_isSettledPact(result)) {\n\t\t\t\tresult = result.s;\n\t\t\t} else {\n\t\t\t\tstage = 1;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tif (update) {\n\t\t\tvar updateValue = update();\n\t\t\tif (updateValue && updateValue.then && !_isSettledPact(updateValue)) {\n\t\t\t\tstage = 2;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\tvar pact = new _Pact();\n\tvar reject = _settle.bind(null, pact, 2);\n\t(stage === 0 ? shouldContinue.then(_resumeAfterTest) : stage === 1 ? result.then(_resumeAfterBody) : updateValue.then(_resumeAfterUpdate)).then(void 0, reject);\n\treturn pact;\n\tfunction _resumeAfterBody(value) {\n\t\tresult = value;\n\t\tdo {\n\t\t\tif (update) {\n\t\t\t\tupdateValue = update();\n\t\t\t\tif (updateValue && updateValue.then && !_isSettledPact(updateValue)) {\n\t\t\t\t\tupdateValue.then(_resumeAfterUpdate).then(void 0, reject);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\t\t\tshouldContinue = test();\n\t\t\tif (!shouldContinue || (_isSettledPact(shouldContinue) && !shouldContinue.v)) {\n\t\t\t\t_settle(pact, 1, result);\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif (shouldContinue.then) {\n\t\t\t\tshouldContinue.then(_resumeAfterTest).then(void 0, reject);\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tresult = body();\n\t\t\tif (_isSettledPact(result)) {\n\t\t\t\tresult = result.v;\n\t\t\t}\n\t\t} while (!result || !result.then);\n\t\tresult.then(_resumeAfterBody).then(void 0, reject);\n\t}\n\tfunction _resumeAfterTest(shouldContinue) {\n\t\tif (shouldContinue) {\n\t\t\tresult = body();\n\t\t\tif (result && result.then) {\n\t\t\t\tresult.then(_resumeAfterBody).then(void 0, reject);\n\t\t\t} else {\n\t\t\t\t_resumeAfterBody(result);\n\t\t\t}\n\t\t} else {\n\t\t\t_settle(pact, 1, result);\n\t\t}\n\t}\n\tfunction _resumeAfterUpdate() {\n\t\tif (shouldContinue = test()) {\n\t\t\tif (shouldContinue.then) {\n\t\t\t\tshouldContinue.then(_resumeAfterTest).then(void 0, reject);\n\t\t\t} else {\n\t\t\t\t_resumeAfterTest(shouldContinue);\n\t\t\t}\n\t\t} else {\n\t\t\t_settle(pact, 1, result);\n\t\t}\n\t}\n}\n\n// Asynchronously implement a do ... while loop\nexport function _do(body, test) {\n\tvar awaitBody;\n\tdo {\n\t\tvar result = body();\n\t\tif (result && result.then) {\n\t\t\tif (_isSettledPact(result)) {\n\t\t\t\tresult = result.v;\n\t\t\t} else {\n\t\t\t\tawaitBody = true;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tvar shouldContinue = test();\n\t\tif (_isSettledPact(shouldContinue)) {\n\t\t\tshouldContinue = shouldContinue.v;\n\t\t}\n\t\tif (!shouldContinue) {\n\t\t\treturn result;\n\t\t}\n\t} while (!shouldContinue.then);\n\tconst pact = new _Pact();\n\tconst reject = _settle.bind(null, pact, 2);\n\t(awaitBody ? result.then(_resumeAfterBody) : shouldContinue.then(_resumeAfterTest)).then(void 0, reject);\n\treturn pact;\n\tfunction _resumeAfterBody(value) {\n\t\tresult = value;\n\t\tfor (;;) {\n\t\t\tshouldContinue = test();\n\t\t\tif (_isSettledPact(shouldContinue)) {\n\t\t\t\tshouldContinue = shouldContinue.v;\n\t\t\t}\n\t\t\tif (!shouldContinue) {\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tif (shouldContinue.then) {\n\t\t\t\tshouldContinue.then(_resumeAfterTest).then(void 0, reject);\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tresult = body();\n\t\t\tif (result && result.then) {\n\t\t\t\tif (_isSettledPact(result)) {\n\t\t\t\t\tresult = result.v;\n\t\t\t\t} else {\n\t\t\t\t\tresult.then(_resumeAfterBody).then(void 0, reject);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t_settle(pact, 1, result);\n\t}\n\tfunction _resumeAfterTest(shouldContinue) {\n\t\tif (shouldContinue) {\n\t\t\tdo {\n\t\t\t\tresult = body();\n\t\t\t\tif (result && result.then) {\n\t\t\t\t\tif (_isSettledPact(result)) {\n\t\t\t\t\t\tresult = result.v;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tresult.then(_resumeAfterBody).then(void 0, reject);\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tshouldContinue = test();\n\t\t\t\tif (_isSettledPact(shouldContinue)) {\n\t\t\t\t\tshouldContinue = shouldContinue.v;\n\t\t\t\t}\n\t\t\t\tif (!shouldContinue) {\n\t\t\t\t\t_settle(pact, 1, result);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t} while (!shouldContinue.then);\n\t\t\tshouldContinue.then(_resumeAfterTest).then(void 0, reject);\n\t\t} else {\n\t\t\t_settle(pact, 1, result);\n\t\t}\n\t}\n}\n\n// Asynchronously implement a switch statement\nexport function _switch(discriminant, cases) {\n\tvar dispatchIndex = -1;\n\tvar awaitBody;\n\touter: {\n\t\tfor (var i = 0; i < cases.length; i++) {\n\t\t\tvar test = cases[i][0];\n\t\t\tif (test) {\n\t\t\t\tvar testValue = test();\n\t\t\t\tif (testValue && testValue.then) {\n\t\t\t\t\tbreak outer;\n\t\t\t\t}\n\t\t\t\tif (testValue === discriminant) {\n\t\t\t\t\tdispatchIndex = i;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\t// Found the default case, set it as the pending dispatch case\n\t\t\t\tdispatchIndex = i;\n\t\t\t}\n\t\t}\n\t\tif (dispatchIndex !== -1) {\n\t\t\tdo {\n\t\t\t\tvar body = cases[dispatchIndex][1];\n\t\t\t\twhile (!body) {\n\t\t\t\t\tdispatchIndex++;\n\t\t\t\t\tbody = cases[dispatchIndex][1];\n\t\t\t\t}\n\t\t\t\tvar result = body();\n\t\t\t\tif (result && result.then) {\n\t\t\t\t\tawaitBody = true;\n\t\t\t\t\tbreak outer;\n\t\t\t\t}\n\t\t\t\tvar fallthroughCheck = cases[dispatchIndex][2];\n\t\t\t\tdispatchIndex++;\n\t\t\t} while (fallthroughCheck && !fallthroughCheck());\n\t\t\treturn result;\n\t\t}\n\t}\n\tconst pact = new _Pact();\n\tconst reject = _settle.bind(null, pact, 2);\n\t(awaitBody ? result.then(_resumeAfterBody) : testValue.then(_resumeAfterTest)).then(void 0, reject);\n\treturn pact;\n\tfunction _resumeAfterTest(value) {\n\t\tfor (;;) {\n\t\t\tif (value === discriminant) {\n\t\t\t\tdispatchIndex = i;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tif (++i === cases.length) {\n\t\t\t\tif (dispatchIndex !== -1) {\n\t\t\t\t\tbreak;\n\t\t\t\t} else {\n\t\t\t\t\t_settle(pact, 1, result);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\t\t\ttest = cases[i][0];\n\t\t\tif (test) {\n\t\t\t\tvalue = test();\n\t\t\t\tif (value && value.then) {\n\t\t\t\t\tvalue.then(_resumeAfterTest).then(void 0, reject);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tdispatchIndex = i;\n\t\t\t}\n\t\t}\n\t\tdo {\n\t\t\tvar body = cases[dispatchIndex][1];\n\t\t\twhile (!body) {\n\t\t\t\tdispatchIndex++;\n\t\t\t\tbody = cases[dispatchIndex][1];\n\t\t\t}\n\t\t\tvar result = body();\n\t\t\tif (result && result.then) {\n\t\t\t\tresult.then(_resumeAfterBody).then(void 0, reject);\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tvar fallthroughCheck = cases[dispatchIndex][2];\n\t\t\tdispatchIndex++;\n\t\t} while (fallthroughCheck && !fallthroughCheck());\n\t\t_settle(pact, 1, result);\n\t}\n\tfunction _resumeAfterBody(result) {\n\t\tfor (;;) {\n\t\t\tvar fallthroughCheck = cases[dispatchIndex][2];\n\t\t\tif (!fallthroughCheck || fallthroughCheck()) {\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tdispatchIndex++;\n\t\t\tvar body = cases[dispatchIndex][1];\n\t\t\twhile (!body) {\n\t\t\t\tdispatchIndex++;\n\t\t\t\tbody = cases[dispatchIndex][1];\n\t\t\t}\n\t\t\tresult = body();\n\t\t\tif (result && result.then) {\n\t\t\t\tresult.then(_resumeAfterBody).then(void 0, reject);\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t\t_settle(pact, 1, result);\n\t}\n}\n\n// Asynchronously call a function and pass the result to explicitly passed continuations\nexport function _call(body, then, direct) {\n\tif (direct) {\n\t\treturn then ? then(body()) : body();\n\t}\n\ttry {\n\t\tvar result = Promise.resolve(body());\n\t\treturn then ? result.then(then) : result;\n\t} catch (e) {\n\t\treturn Promise.reject(e);\n\t}\n}\n\n// Asynchronously call a function and swallow the result\nexport function _callIgnored(body, direct) {\n\treturn _call(body, _empty, direct);\n}\n\n// Asynchronously call a function and pass the result to explicitly passed continuations\nexport function _invoke(body, then) {\n\tvar result = body();\n\tif (result && result.then) {\n\t\treturn result.then(then);\n\t}\n\treturn then(result);\n}\n\n// Asynchronously call a function and swallow the result\nexport function _invokeIgnored(body) {\n\tvar result = body();\n\tif (result && result.then) {\n\t\treturn result.then(_empty);\n\t}\n}\n\n// Asynchronously call a function and send errors to recovery continuation\nexport function _catch(body, recover) {\n\ttry {\n\t\tvar result = body();\n\t} catch(e) {\n\t\treturn recover(e);\n\t}\n\tif (result && result.then) {\n\t\treturn result.then(void 0, recover);\n\t}\n\treturn result;\n}\n\n// Asynchronously await a promise and pass the result to a finally continuation\nexport function _finallyRethrows(body, finalizer) {\n\ttry {\n\t\tvar result = body();\n\t} catch (e) {\n\t\treturn finalizer(true, e);\n\t}\n\tif (result && result.then) {\n\t\treturn result.then(finalizer.bind(null, false), finalizer.bind(null, true));\n\t}\n\treturn finalizer(false, result);\n}\n\n// Asynchronously await a promise and invoke a finally continuation that always overrides the result\nexport function _finally(body, finalizer) {\n\ttry {\n\t\tvar result = body();\n\t} catch (e) {\n\t\treturn finalizer();\n\t}\n\tif (result && result.then) {\n\t\treturn result.then(finalizer, finalizer);\n\t}\n\treturn finalizer();\n}\n\n// Rethrow or return a value from a finally continuation\nexport function _rethrow(thrown, value) {\n\tif (thrown)\n\t\tthrow value;\n\treturn value;\n}\n\n// Empty function to implement break and other control flow that ignores asynchronous results\nexport function _empty() {\n}\n\n// Sentinel value for early returns in generators \nexport const _earlyReturn = /*#__PURE__*/ {};\n\n// Asynchronously call a function and send errors to recovery continuation, skipping early returns\nexport function _catchInGenerator(body, recover) {\n\treturn _catch(body, function(e) {\n\t\tif (e === _earlyReturn) {\n\t\t\tthrow e;\n\t\t}\n\t\treturn recover(e);\n\t});\n}\n\n// Asynchronous generator class; accepts the entrypoint of the generator, to which it passes itself when the generator should start\nexport const _AsyncGenerator = /*#__PURE__*/(function() {\n\tfunction _AsyncGenerator(entry) {\n\t\tthis._entry = entry;\n\t\tthis._pact = null;\n\t\tthis._resolve = null;\n\t\tthis._return = null;\n\t\tthis._promise = null;\n\t}\n\n\tfunction _wrapReturnedValue(value) {\n\t\treturn { value: value, done: true };\n\t}\n\tfunction _wrapYieldedValue(value) {\n\t\treturn { value: value, done: false };\n\t}\n\n\t_AsyncGenerator.prototype._yield = function(value) {\n\t\t// Yield the value to the pending next call\n\t\tthis._resolve(value && value.then ? value.then(_wrapYieldedValue) : _wrapYieldedValue(value));\n\t\t// Return a pact for an upcoming next/return/throw call\n\t\treturn this._pact = new _Pact();\n\t};\n\t_AsyncGenerator.prototype.next = function(value) {\n\t\t// Advance the generator, starting it if it has yet to be started\n\t\tconst _this = this;\n\t\treturn _this._promise = new Promise(function (resolve) {\n\t\t\tconst _pact = _this._pact;\n\t\t\tif (_pact === null) {\n\t\t\t\tconst _entry = _this._entry;\n\t\t\t\tif (_entry === null) {\n\t\t\t\t\t// Generator is started, but not awaiting a yield expression\n\t\t\t\t\t// Abandon the next call!\n\t\t\t\t\treturn resolve(_this._promise);\n\t\t\t\t}\n\t\t\t\t// Start the generator\n\t\t\t\t_this._entry = null;\n\t\t\t\t_this._resolve = resolve;\n\t\t\t\tfunction returnValue(value) {\n\t\t\t\t\t_this._resolve(value && value.then ? value.then(_wrapReturnedValue) : _wrapReturnedValue(value));\n\t\t\t\t\t_this._pact = null;\n\t\t\t\t\t_this._resolve = null;\n\t\t\t\t}\n\t\t\t\tvar result = _entry(_this);\n\t\t\t\tif (result && result.then) {\n\t\t\t\t\tresult.then(returnValue, function(error) {\n\t\t\t\t\t\tif (error === _earlyReturn) {\n\t\t\t\t\t\t\treturnValue(_this._return);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tconst pact = new _Pact();\n\t\t\t\t\t\t\t_this._resolve(pact);\n\t\t\t\t\t\t\t_this._pact = null;\n\t\t\t\t\t\t\t_this._resolve = null;\n\t\t\t\t\t\t\t_resolve(pact, 2, error);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\treturnValue(result);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\t// Generator is started and a yield expression is pending, settle it\n\t\t\t\t_this._pact = null;\n\t\t\t\t_this._resolve = resolve;\n\t\t\t\t_settle(_pact, 1, value);\n\t\t\t}\n\t\t});\n\t};\n\t_AsyncGenerator.prototype.return = function(value) {\n\t\t// Early return from the generator if started, otherwise abandons the generator\n\t\tconst _this = this;\n\t\treturn _this._promise = new Promise(function (resolve) {\n\t\t\tconst _pact = _this._pact;\n\t\t\tif (_pact === null) {\n\t\t\t\tif (_this._entry === null) {\n\t\t\t\t\t// Generator is started, but not awaiting a yield expression\n\t\t\t\t\t// Abandon the return call!\n\t\t\t\t\treturn resolve(_this._promise);\n\t\t\t\t}\n\t\t\t\t// Generator is not started, abandon it and return the specified value\n\t\t\t\t_this._entry = null;\n\t\t\t\treturn resolve(value && value.then ? value.then(_wrapReturnedValue) : _wrapReturnedValue(value));\n\t\t\t}\n\t\t\t// Settle the yield expression with a rejected \"early return\" value\n\t\t\t_this._return = value;\n\t\t\t_this._resolve = resolve;\n\t\t\t_this._pact = null;\n\t\t\t_settle(_pact, 2, _earlyReturn);\n\t\t});\n\t};\n\t_AsyncGenerator.prototype.throw = function(error) {\n\t\t// Inject an exception into the pending yield expression\n\t\tconst _this = this;\n\t\treturn _this._promise = new Promise(function (resolve, reject) {\n\t\t\tconst _pact = _this._pact;\n\t\t\tif (_pact === null) {\n\t\t\t\tif (_this._entry === null) {\n\t\t\t\t\t// Generator is started, but not awaiting a yield expression\n\t\t\t\t\t// Abandon the throw call!\n\t\t\t\t\treturn resolve(_this._promise);\n\t\t\t\t}\n\t\t\t\t// Generator is not started, abandon it and return a rejected Promise containing the error\n\t\t\t\t_this._entry = null;\n\t\t\t\treturn reject(error);\n\t\t\t}\n\t\t\t// Settle the yield expression with the value as a rejection\n\t\t\t_this._resolve = resolve;\n\t\t\t_this._pact = null;\n\t\t\t_settle(_pact, 2, error);\n\t\t});\n\t};\n\n\t_AsyncGenerator.prototype[_asyncIteratorSymbol] = function() {\n\t\treturn this;\n\t};\n\t\n\treturn _AsyncGenerator;\n})();\n","/* eslint-disable react-hooks/exhaustive-deps */\nimport React, { memo, ReactNode, useEffect, useState } from \"react\"\nimport './styles.scss'\nimport { useRef } from 'react';\n\nexport interface TabContainerProp {\n  children: Array<{ props: any }> | { props: any };\n  activeIndex?: number;\n  backgroundColor?: string;\n  color?: string;\n  indicatorStyle?: 'simple' | 'bottomLine' | 'button'\n  onTabChange?: Function,\n  lazy?: boolean;\n  transitionMs?: number;\n  borderLine?: boolean;\n  fontColor?: string;\n}\n\ninterface TabHeader {\n  label: string;\n  icon?: JSX.Element | string | null | undefined;\n  disabled?: boolean\n}\n\nconst TabContainer = memo(({\n  activeIndex = 0,\n  children,\n  backgroundColor = 'inherit',\n  color = '#428CFF',\n  indicatorStyle = 'bottomLine',\n  onTabChange = (index: number) => { },\n  transitionMs = 375,\n  borderLine = false,\n  fontColor = 'inherit',\n  lazy = false }:\n  TabContainerProp) => {\n\n  const [header, setHeader] = useState<Array<TabHeader>>([]);\n  const [activeTab, setActiveTab] = useState(activeIndex);\n  const tabContainerRef = useRef(null)\n\n  useEffect(() => {\n    const tabsItems = children instanceof Array ? children : [children];\n    checkChildrens(tabsItems);\n    const tabs = tabsItems.map(el => ({ label: el.props.name, icon: el.props.icon, disabled: el.props.disabled }))\n    if (activeIndex > tabs.length - 1 || activeIndex < 0)\n      throw new Error(`Invalid range for activeIndex ${activeIndex}`);\n    setHeader(tabs);\n  }, [children])\n\n  useEffect(() => {\n    const tabsItems = children instanceof Array ? children : [children];\n    if (activeIndex > tabsItems.length - 1 || activeIndex < 0)\n      throw new Error(`Invalid range for activeIndex ${activeIndex}`);\n    setActiveTab(tabsItems[activeIndex]?.props?.disabled ? 0 : activeIndex);\n  }, [activeIndex])\n\n  useEffect(() => {\n    if (header && header.length) {\n      onTabChange(activeTab);\n    }\n  }, [activeTab])\n\n  function checkChildrens(data: any[]) {\n    try {\n      data.map((el: any) => {\n        if (!el.props.name)\n          throw new Error('Inside of TabContainer component only can be rendered TabItem component, and its need a name prop')\n        return true;\n      })\n    } catch (e) {\n      throw new Error(\"The TabContainer Component must has a TabItem as child component\");\n    }\n\n  }\n\n  const tabsItems = children instanceof Array ? children : [children];\n\n  return <div ref={tabContainerRef} className=\"tab-pp\">\n    <div className=\"header\" style={{ backgroundColor: backgroundColor, borderBottom: borderLine ? '1px solid #323232' : 'undet' }}>\n      {header.map((el, index) => (\n        <button onClick={() => {\n          if (el.disabled) return;\n          setActiveTab(index)\n        }} key={el.label}\n          style={{\n            color: index == activeTab && (indicatorStyle === 'simple' || indicatorStyle === 'bottomLine') ? color : fontColor,\n            backgroundColor: index == activeTab && (indicatorStyle === 'button') ? color : 'inherit',\n          }}\n          className={index == activeTab ? `itemlabel ${indicatorStyle} active` : 'itemlabel'}\n          disabled={el.disabled}\n        >\n          {el.icon} {el.label}\n          {indicatorStyle === 'bottomLine' && (<div style={{ backgroundColor: color }}></div>)}\n        </button>\n      ))}\n    </div>\n    <div className=\"body\">\n      {tabsItems.map((tabEl, index) => {\n        if (index < activeTab) {\n          return (<div style={{\n            transform: 'translate3d(-100%, 0px, 0px)',\n            height: '0px',\n            overflow: 'hidden',\n            transition: `transform ${transitionMs / 1000}s ease`\n          }} key={index} className={'body-content'}>\n            {!lazy && tabEl}\n          </div>)\n        }\n        if (index > activeTab) {\n          return (<div style={{\n            transform: 'translate3d(100%, 0px, 0px)',\n            height: '0px',\n            overflow: 'hidden',\n            transition: `transform ${transitionMs / 1000}s ease`\n          }} key={index} className={'body-content'}>\n            {!lazy && tabEl}\n          </div>)\n        }\n        else {\n          return (<div style={{\n            visibility: 'inherit',\n            overflow: 'auto',\n            height: 'auto',\n            position: 'relative',\n            transition: `transform ${transitionMs / 1000}s ease`\n          }} key={index} className={'body-content'}>\n            {tabEl}\n          </div>)\n        }\n      })}\n\n    </div>\n\n  </div>\n})\n\nexport const TabItem = memo(({ name, children, icon = null, type = 'TabItem', disabled = false }:\n  {\n    name: string;\n    children: ReactNode, icon?: JSX.Element | string | null | undefined;\n    disabled?: boolean\n    type?: string\n  }) => {\n  return <div style={{ padding: '1rem 0.5rem' }}>\n    {children}\n  </div>\n})\n\nexport default TabContainer\n","import React, { memo, useRef } from 'react'\nimport { useState, useEffect } from 'react';\n\ninterface InputProps extends React.InputHTMLAttributes<any> {\n  onInputChangedEnd?: Function\n  onChangedDelayed?: Function\n  onChangedValue?: Function\n  delayMs?: number\n}\n\nconst Input = memo((props: React.InputHTMLAttributes<any> | InputProps) => {\n\n  const { onInputChangedEnd, onChangedDelayed, onChangedValue, delayMs, ...restProps } = props as any;\n  const [state, setState] = useState<any>(props.value);\n  const timerRef = useRef<any>();\n  const mountRef = useRef<boolean>(true);\n  const flagRef = useRef<boolean>(false);\n\n  // useEffect(() => {\n  //   if (['checkbox', 'radio'].includes(props.type as string)) {\n  //     setState(props.checked);\n  //   } else {\n  //     setState(props.value);\n  //     console.log(\"Here in the prop\")\n  //   }\n  // }, [props.value])\n\n  useEffect(() => {\n    if (!onChangedDelayed) return;\n    if (mountRef.current) {\n      mountRef.current = false;\n      return;\n    }\n\n    if (flagRef.current) {\n      return;\n    }\n    timerRef.current = setTimeout(() => {\n      flagRef.current = true;\n      clearTimeout(timerRef.current);\n      onChangedDelayed(state);\n      flagRef.current = false;\n    }, delayMs || 100)\n\n    return () => {\n      clearTimeout(timerRef.current);\n    }\n\n  }, [state])\n\n  function changeValue(e: any) {\n    if (['checkbox', 'radio'].includes(props.type as string)) {\n      setState(e.target.checked)\n      onChangedValue && onChangedValue(e.target.checked);\n\n    } else {\n      setState(e.target.value)\n      onChangedValue && onChangedValue(e.target.value);\n    }\n  }\n\n  return (\n    <React.Fragment>\n      {\n        onInputChangedEnd && <input {...restProps} className={restProps?.className} style={restProps.style}\n          value={props.value}\n          onChange={changeValue}\n          onBlur={(e) => { onInputChangedEnd(e.target.value) }}\n          onKeyDown={(e) => {\n            if (e.key == 'Enter') onInputChangedEnd(state)\n          }}\n        />\n      }\n      {\n        !onInputChangedEnd && <input {...restProps} className={restProps?.className} style={restProps.style}\n          value={props.value}\n          onChange={changeValue}\n        />\n      }\n    </React.Fragment>)\n})\n\nexport default Input\n","\nimport React, { memo, useEffect, useState } from 'react'\nimport { IBasicFilterState } from '../../models/index.models';\nimport Input from '../Input/Input';\n\nexport interface BasicFilterProps {\n  labels: any;\n  color: string;\n  initialState: IBasicFilterState | undefined | null,\n  changeFilter: Function\n}\nconst _initialState: IBasicFilterState = {\n  contrast: 1,\n  blur: 0,\n  brightness: 1,\n  grayscale: 0,\n  invert: 0,\n  saturate: 1,\n  sepia: 0,\n}\n\n\nconst BasicFilter = memo(({ labels, color, initialState = _initialState, changeFilter = () => { } }: BasicFilterProps) => {\n  const [state, setState] = useState<IBasicFilterState>(initialState as any)\n\n  useEffect(() => {\n    if (initialState) {\n      setState(JSON.parse(JSON.stringify({ ...state, ...initialState })));\n    } else {\n      setState(_initialState)\n    }\n  }, [initialState])\n\n  function onUpdateContrast(contrast: number) {\n    changeFilter({ ...state, contrast })\n  }\n\n  function onUpdateBrightness(brightness: number) {\n    changeFilter({ ...state, brightness })\n  }\n\n  function onUpdateGrayscale(grayscale: number) {\n    changeFilter({ ...state, grayscale })\n  }\n  function onUpdateSaturate(saturate: number) {\n    changeFilter({ ...state, saturate })\n  }\n  function onUpdateSepia(sepia: number) {\n    changeFilter({ ...state, sepia })\n  }\n  function onUpdateBlur(blur: number) {\n    changeFilter({ ...state, blur })\n  }\n\n  return <div>\n    <div style={{ display: 'flex', width: '100%', justifyContent: 'space-between' }}>\n      <p className=\"item-panel\">{labels['Contrast']}</p>\n      <p className=\"item-panel\">{(+state.contrast).toFixed(2)}</p>\n    </div>\n\n    <div className='flex-row-start'>\n      <Input\n        className=\"input-range\"\n        onChangedDelayed={onUpdateContrast}\n        onChangedValue={(value: number) => { setState({ ...state, contrast: value }) }}\n        style={{\n          maxWidth: '100%', width: '100%', color: color\n        }}\n        type=\"range\"\n        min=\"0\"\n        max=\"5\"\n        step=\"0.01\"\n        value={state.contrast} />\n    </div>\n\n    <div style={{ display: 'flex', width: '100%', justifyContent: 'space-between' }}>\n      <p className=\"item-panel\">{labels['Brightness']}</p>\n      <p className=\"item-panel\">{(+state.brightness).toFixed(2)}</p>\n    </div>\n\n    <div className='flex-row-start'>\n      <Input\n        className=\"input-range\"\n        onChangedDelayed={onUpdateBrightness}\n        onChangedValue={(value: number) => { setState({ ...state, brightness: value }) }}\n        style={{\n          maxWidth: '100%', width: '100%', color: color\n        }}\n        type=\"range\"\n        min=\"0\"\n        max=\"5\"\n        step=\"0.01\"\n        value={state.brightness} />\n    </div>\n\n    <div style={{ display: 'flex', width: '100%', justifyContent: 'space-between' }}>\n      <p className=\"item-panel\">{labels['Grayscale']}</p>\n      <p className=\"item-panel\">{(+state.grayscale).toFixed(2)}</p>\n    </div>\n\n    <div className='flex-row-start'>\n      <Input\n        className=\"input-range\"\n        onChangedDelayed={onUpdateGrayscale}\n        onChangedValue={(value: number) => { setState({ ...state, grayscale: value }) }}\n        style={{\n          maxWidth: '100%', width: '100%', color: color\n        }}\n        type=\"range\"\n        min=\"0\"\n        max=\"5\"\n        step=\"0.01\"\n        value={state.grayscale} />\n    </div>\n    <div style={{ display: 'flex', width: '100%', justifyContent: 'space-between' }}>\n      <p className=\"item-panel\">{labels['Saturate']}</p>\n      <p className=\"item-panel\">{(+state.saturate).toFixed(2)}</p>\n    </div>\n\n    <div className='flex-row-start'>\n      <Input\n        className=\"input-range\"\n        onChangedDelayed={onUpdateSaturate}\n        onChangedValue={(value: number) => { setState({ ...state, saturate: value }) }}\n        style={{\n          maxWidth: '100%', width: '100%', color: color\n        }}\n        type=\"range\"\n        min=\"0\"\n        max=\"5\"\n        step=\"0.01\"\n        value={state.saturate} />\n    </div>\n\n    <div style={{ display: 'flex', width: '100%', justifyContent: 'space-between' }}>\n      <p className=\"item-panel\">{labels['Sepia']}</p>\n      <p className=\"item-panel\">{(+state.sepia).toFixed(2)}</p>\n    </div>\n\n    <div className='flex-row-start'>\n      <Input\n        className=\"input-range\"\n        onChangedDelayed={onUpdateSepia}\n        onChangedValue={(value: number) => { setState({ ...state, sepia: value }) }}\n        style={{\n          maxWidth: '100%', width: '100%', color: color\n        }}\n        type=\"range\"\n        min=\"0\"\n        max=\"5\"\n        step=\"0.01\"\n        value={state.sepia} />\n    </div>\n\n    <div style={{ display: 'flex', width: '100%', justifyContent: 'space-between' }}>\n      <p className=\"item-panel\">{labels['Blur']}</p>\n      <p className=\"item-panel\">{(+state.blur).toFixed(2)}</p>\n    </div>\n\n    <div className='flex-row-start'>\n      <Input\n        className=\"input-range\"\n        onChangedDelayed={onUpdateBlur}\n        onChangedValue={(value: number) => { setState({ ...state, blur: value }) }}\n        style={{\n          maxWidth: '100%', width: '100%', color: color\n        }}\n        type=\"range\"\n        min=\"0\"\n        max=\"5\"\n        step=\"0.01\"\n        value={state.blur} />\n    </div>\n  </div>\n})\n\nexport default BasicFilter\n","/**\n * POLYFILLS\n */\n\n// Request Animation Frame polyfill\n(function () {\n  var lastTime = 0;\n  var vendors = [\"ms\", \"moz\", \"webkit\", \"o\"];\n  for (var x = 0; x < vendors.length && !window.requestAnimationFrame; ++x) {\n    window.requestAnimationFrame = window[vendors[x] + \"RequestAnimationFrame\"];\n    window.cancelAnimationFrame =\n      window[vendors[x] + \"CancelAnimationFrame\"] ||\n      window[vendors[x] + \"CancelRequestAnimationFrame\"];\n  }\n\n  if (!window.requestAnimationFrame)\n    window.requestAnimationFrame = function (callback: any, element: any) {\n      var currTime = new Date().getTime();\n      var timeToCall = Math.max(0, 16 - (currTime - lastTime));\n      var id = window.setTimeout(function () {\n        callback(currTime + timeToCall);\n      }, timeToCall);\n      lastTime = currTime + timeToCall;\n      return id;\n    } as any;\n\n  if (!window.cancelAnimationFrame)\n    window.cancelAnimationFrame = function (id) {\n      clearTimeout(id);\n    };\n})();\n\n// CustomEvents polyfill\n(function () {\n  if (typeof window.CustomEvent === \"function\") return false;\n\n  function CustomEvent(event: any, params: any) {\n    params = params || { bubbles: false, cancelable: false, detail: undefined };\n    var evt = document.createEvent(\"CustomEvent\");\n    evt.initCustomEvent(\n      event,\n      params.bubbles,\n      params.cancelable,\n      params.detail\n    );\n    return evt;\n  }\n\n  CustomEvent.prototype = window.Event.prototype;\n\n  window.CustomEvent = CustomEvent as any;\n})();\n\n// MouseEvents polyfill\n(function (window) {\n  try {\n    new CustomEvent(\"test\");\n    return false; // No need to polyfill\n  } catch (e) {\n    // Need to polyfill - fall through\n  }\n\n  // Polyfills DOM4 CustomEvent\n  function MouseEvent(eventType: any, params: any) {\n    params = params || { bubbles: false, cancelable: false };\n    var mouseEvent = document.createEvent(\"MouseEvent\");\n    mouseEvent.initMouseEvent(\n      eventType,\n      params.bubbles,\n      params.cancelable,\n      window,\n      0,\n      0,\n      0,\n      0,\n      0,\n      false,\n      false,\n      false,\n      false,\n      0,\n      null\n    );\n\n    return mouseEvent;\n  }\n\n  MouseEvent.prototype = Event.prototype;\n\n  window.MouseEvent = MouseEvent as any;\n})(window);\n","/**\n * Handle component\n */\nexport default class Handle {\n  /**\n   * Creates a new Handle instance.\n   * @constructor\n   * @param {Array} position The x and y ratio position of the handle\n   *      within the crop region. Accepts a value between 0 to 1 in the order\n   *      of [X, Y].\n   * @param {Array} constraints Define the side of the crop region that\n   *      is to be affected by this handle. Accepts a value of 0 or 1 in the\n   *      order of [TOP, RIGHT, BOTTOM, LEFT].\n   * @param {String} cursor The CSS cursor of this handle.\n   * @param {Element} eventBus The element to dispatch events to.\n   */\n  position: any;\n  constraints: any;\n  cursor: any;\n  eventBus: any;\n  el: any;\n\n  constructor(position: any, constraints: any, cursor: any, eventBus: any) {\n    var self = this;\n    this.position = position;\n    this.constraints = constraints;\n    this.cursor = cursor;\n    this.eventBus = eventBus;\n\n    // Create DOM element\n    this.el = document.createElement(\"div\");\n    this.el.className = \"croppr-handle\";\n    this.el.style.cursor = cursor;\n\n    // Attach initial listener\n    this.el.addEventListener(\"mousedown\", onMouseDown);\n\n    function onMouseDown(e: any) {\n      e.stopPropagation();\n      document.addEventListener(\"mouseup\", onMouseUp);\n      document.addEventListener(\"mousemove\", onMouseMove);\n\n      // Notify parent\n      self.eventBus.dispatchEvent(\n        new CustomEvent(\"handlestart\", {\n          detail: { handle: self },\n        })\n      );\n    }\n\n    function onMouseUp(e: any) {\n      e.stopPropagation();\n      document.removeEventListener(\"mouseup\", onMouseUp);\n      document.removeEventListener(\"mousemove\", onMouseMove);\n\n      // Notify parent\n      self.eventBus.dispatchEvent(\n        new CustomEvent(\"handleend\", {\n          detail: { handle: self },\n        })\n      );\n    }\n\n    function onMouseMove(e: any) {\n      e.stopPropagation();\n\n      // Notify parent\n      self.eventBus.dispatchEvent(\n        new CustomEvent(\"handlemove\", {\n          detail: { mouseX: e.clientX, mouseY: e.clientY },\n        })\n      );\n    }\n  }\n}\n","/**\n * Box component\n */\nexport default class Box {\n  /**\n   * Creates a new Box instance.\n   * @constructor\n   * @param {Number} x1\n   * @param {Number} y1\n   * @param {Number} x2\n   * @param {Number} y2\n   */\n  x1: any;\n  y1: any;\n  x2: any;\n  y2: any;\n\n  constructor(x1: any, y1: any, x2: any, y2: any) {\n    this.x1 = x1;\n    this.y1 = y1;\n    this.x2 = x2;\n    this.y2 = y2;\n  }\n\n  /**\n   * Sets the new dimensions of the box.\n   * @param {Number} x1\n   * @param {Number} y1\n   * @param {Number} x2\n   * @param {Number} y2\n   */\n  set(x1 = null, y1 = null, x2 = null, y2 = null) {\n    this.x1 = x1 == null ? this.x1 : x1;\n    this.y1 = y1 == null ? this.y1 : y1;\n    this.x2 = x2 == null ? this.x2 : x2;\n    this.y2 = y2 == null ? this.y2 : y2;\n    return this;\n  }\n\n  /**\n   * Calculates the width of the box.\n   * @returns {Number}\n   */\n  width() {\n    return Math.abs(this.x2 - this.x1);\n  }\n\n  /**\n   * Calculates the height of the box.\n   * @returns {Number}\n   */\n  height() {\n    return Math.abs(this.y2 - this.y1);\n  }\n\n  /**\n   * Resizes the box to a new size.\n   * @param {Number} newWidth\n   * @param {Number} newHeight\n   * @param {Array} [origin] The origin point to resize from.\n   *      Defaults to [0, 0] (top left).\n   */\n  resize(newWidth: any, newHeight: any, origin = [0, 0]) {\n    const fromX = this.x1 + this.width() * origin[0];\n    const fromY = this.y1 + this.height() * origin[1];\n\n\n    this.x1 = fromX - newWidth * origin[0];\n    this.y1 = fromY - newHeight * origin[1];\n    this.x2 = this.x1 + newWidth;\n    this.y2 = this.y1 + newHeight;\n\n    return this;\n  }\n\n  /**\n   * Scale the box by a factor.\n   * @param {Number} factor\n   * @param {Array} [origin] The origin point to resize from.\n   *      Defaults to [0, 0] (top left).\n   */\n  scale(factor: any, origin = [0, 0]) {\n    const newWidth = this.width() * factor;\n    const newHeight = this.height() * factor;\n    this.resize(newWidth, newHeight, origin);\n    return this;\n  }\n\n  /**\n   * Move the box to the specified coordinates.\n   */\n  move(x = null, y = null) {\n    let width = this.width();\n    let height = this.height();\n    x = x === null ? this.x1 : x;\n    y = y === null ? this.y1 : y;\n\n    this.x1 = x;\n    this.y1 = y;\n    this.x2 = (x as any) + width;\n    this.y2 = (y as any) + height;\n    return this;\n  }\n\n  /**\n   * Get relative x and y coordinates of a given point within the box.\n   * @param {Array} point The x and y ratio position within the box.\n   * @returns {Array} The x and y coordinates [x, y].\n   */\n  getRelativePoint(point = [0, 0]) {\n    const x = this.width() * point[0];\n    const y = this.height() * point[1];\n    return [x, y];\n  }\n\n  /**\n   * Get absolute x and y coordinates of a given point within the box.\n   * @param {Array} point The x and y ratio position within the box.\n   * @returns {Array} The x and y coordinates [x, y].\n   */\n  getAbsolutePoint(point = [0, 0]) {\n    const x = this.x1 + this.width() * point[0];\n    const y = this.y1 + this.height() * point[1];\n    return [x, y];\n  }\n\n  /**\n   * Constrain the box to a fixed ratio.\n   * @param {Number} ratio\n   * @param {Array} [origin] The origin point to resize from.\n   *     Defaults to [0, 0] (top left).\n   * @param {String} [grow] The axis to grow to maintain the ratio.\n   *     Defaults to 'height'.\n   */\n  constrainToRatio(ratio: any, origin = [0, 0], grow = \"height\") {\n    if (ratio === null) {\n      return;\n    }\n    const width = this.width();\n    const height = this.height();\n    switch (grow) {\n      case \"height\": // Grow height only\n        this.resize(this.width(), this.width() * ratio, origin);\n        break;\n      case \"width\": // Grow width only\n        this.resize((this.height() * 1) / ratio, this.height(), origin);\n        break;\n      default: // Default: Grow height only\n        this.resize(this.width(), this.width() * ratio, origin);\n    }\n\n    return this;\n  }\n\n  /**\n   * Constrain the box within a boundary.\n   * @param {Number} boundaryWidth\n   * @param {Number} boundaryHeight\n   * @param {Array} [origin] The origin point to resize from.\n   *     Defaults to [0, 0] (top left).\n   */\n  constrainToBoundary(\n    boundaryWidth: any,\n    boundaryHeight: any,\n    origin = [0, 0]\n  ) {\n    // Calculate the maximum sizes for each direction of growth\n    const [originX, originY] = this.getAbsolutePoint(origin);\n    const maxIfLeft = originX;\n    const maxIfTop = originY;\n    const maxIfRight = boundaryWidth - originX;\n    const maxIfBottom = boundaryHeight - originY;\n\n    // Express the direction of growth in terms of left, both,\n    // and right as -1, 0, and 1 respectively. Ditto for top/both/down.\n    const directionX = -2 * origin[0] + 1;\n    const directionY = -2 * origin[1] + 1;\n\n    // Determine the max size to use according to the direction of growth.\n    let [maxWidth, maxHeight]: [any, any] = [null, null];\n    switch (directionX) {\n      case -1:\n        maxWidth = maxIfLeft;\n        break;\n      case 0:\n        maxWidth = (Math.min(maxIfLeft, maxIfRight) * 2) as any;\n        break;\n      case +1:\n        maxWidth = maxIfRight as any;\n        break;\n    }\n    switch (directionY) {\n      case -1:\n        maxHeight = maxIfTop;\n        break;\n      case 0:\n        maxHeight = (Math.min(maxIfTop, maxIfBottom) * 2) as any;\n        break;\n      case +1:\n        maxHeight = maxIfBottom as any;\n        break;\n    }\n\n    // Resize if the box exceeds the calculated max width/height.\n    if (this.width() > maxWidth) {\n      const factor = maxWidth / this.width();\n      this.scale(factor, origin);\n    }\n    if (this.height() > maxHeight) {\n      const factor = maxHeight / this.height();\n      this.scale(factor, origin);\n    }\n\n    return this;\n  }\n\n  /**\n   * Constrain the box to a maximum/minimum size.\n   * @param {Number} [maxWidth]\n   * @param {Number} [maxHeight]\n   * @param {Number} [minWidth]\n   * @param {Number} [minHeight]\n   * @param {Array} [origin] The origin point to resize from.\n   *     Defaults to [0, 0] (top left).\n   * @param {Number} [ratio] Ratio to maintain.\n   */\n  constrainToSize(\n    maxWidth: any = null,\n    maxHeight: any = null,\n    minWidth: any = null,\n    minHeight: any = null,\n    origin = [0, 0],\n    ratio: any = null\n  ) {\n    // Calculate new max/min widths & heights that constrains to the ratio\n    if (ratio) {\n      if (ratio > 1) {\n        maxWidth = (maxHeight * 1) / ratio;\n        minHeight = minHeight * ratio;\n      } else if (ratio < 1) {\n        maxHeight = maxWidth * ratio;\n        minWidth = (minHeight * 1) / ratio;\n      }\n    }\n\n    if (maxWidth && this.width() > maxWidth) {\n      const newWidth = maxWidth,\n        newHeight = ratio === null ? this.height() : maxHeight;\n      this.resize(newWidth, newHeight, origin);\n    }\n\n    if (maxHeight && this.height() > maxHeight) {\n      const newWidth = ratio === null ? this.width() : maxWidth,\n        newHeight = maxHeight;\n      this.resize(newWidth, newHeight, origin);\n    }\n\n    if (minWidth && this.width() < minWidth) {\n      const newWidth = minWidth,\n        newHeight = ratio === null ? this.height() : minHeight;\n      this.resize(newWidth, newHeight, origin);\n    }\n\n    if (minHeight && this.height() < minHeight) {\n      const newWidth = ratio === null ? this.width() : minWidth,\n        newHeight = minHeight;\n      this.resize(newWidth, newHeight, origin);\n    }\n\n    return this;\n  }\n}\n","/**\n * Croppr Touch\n * Enables support for touch devices by translating touch events to\n * mouse events.\n */\n\n/**\n * Binds an element's touch events to be simulated as mouse events.\n * @param {Element} element\n */\nexport default function enableTouch(element: any) {\n  element.addEventListener(\"touchstart\", simulateMouseEvent);\n  element.addEventListener(\"touchend\", simulateMouseEvent);\n  element.addEventListener(\"touchmove\", simulateMouseEvent);\n}\n\n/**\n * Translates a touch event to a mouse event.\n * @param {Event} e\n */\nfunction simulateMouseEvent(e: any) {\n  e.preventDefault();\n  const touch = e.changedTouches[0];\n  const eventMap = {\n    touchstart: \"mousedown\",\n    touchmove: \"mousemove\",\n    touchend: \"mouseup\",\n  };\n\n  touch.target.dispatchEvent(\n    new MouseEvent(eventMap[e.type], {\n      bubbles: true,\n      cancelable: true,\n      view: window,\n      clientX: touch.clientX,\n      clientY: touch.clientY,\n      screenX: touch.screenX,\n      screenY: touch.screenY,\n    })\n  );\n}\n","/**\n * CropprCore\n * Here lies the main logic.\n */\n\nimport Handle from \"./handle\";\nimport Box from \"./box\";\nimport enableTouch from \"./touch\";\n\n/**\n * Define a list of handles to create.\n *\n * @property {Array} position - The x and y ratio position of the handle within\n *      the crop region. Accepts a value between 0 to 1 in the order of [X, Y].\n * @property {Array} constraints - Define the side of the crop region that is to\n *      be affected by this handle. Accepts a value of 0 or 1 in the order of\n *      [TOP, RIGHT, BOTTOM, LEFT].\n * @property {String} cursor - The CSS cursor of this handle.\n */\nconst HANDLES = [\n  { position: [0.0, 0.0], constraints: [1, 0, 0, 1], cursor: \"nw-resize\" },\n  { position: [0.5, 0.0], constraints: [1, 0, 0, 0], cursor: \"n-resize\" },\n  { position: [1.0, 0.0], constraints: [1, 1, 0, 0], cursor: \"ne-resize\" },\n  { position: [1.0, 0.5], constraints: [0, 1, 0, 0], cursor: \"e-resize\" },\n  { position: [1.0, 1.0], constraints: [0, 1, 1, 0], cursor: \"se-resize\" },\n  { position: [0.5, 1.0], constraints: [0, 0, 1, 0], cursor: \"s-resize\" },\n  { position: [0.0, 1.0], constraints: [0, 0, 1, 1], cursor: \"sw-resize\" },\n  { position: [0.0, 0.5], constraints: [0, 0, 0, 1], cursor: \"w-resize\" },\n];\n\n/**\n * Core class for Croppr containing most of its functional logic.\n */\nexport default class CropprCore {\n  options: any;\n  _initialized: any;\n  _restore: any;\n  cropperEl: any;\n  box: any;\n  containerEl: any;\n  imageEl: any;\n  eventBus: any;\n  imageClippedEl: any;\n  regionEl: HTMLElement;\n  overlayEl: any;\n  handles: any;\n  activeHandle: any;\n  currentMove: any;\n\n  constructor(element: any, options: any, deferred = false) {\n    // console.log(\"🚀 ~ file: core.ts ~ line 51 ~ CropprCore ~ constructor ~ element\", element)\n    // Parse options\n    this.options = CropprCore.parseOptions(options || {});\n\n    // Get target img element\n    if (!element.nodeName) {\n      element = document.querySelector(element);\n      // console.log(\"🚀 ~ file: core.ts ~ line 58 ~ CropprCore ~ constructor ~ element\", element)\n      if (element == null) {\n        throw \"Unable to find element.\";\n      }\n    }\n    if (!element.getAttribute(\"src\")) {\n      throw \"Image src not provided.\";\n    }\n\n    // Define internal props\n    this._initialized = false;\n    this._restore = {\n      parent: element.parentNode,\n      element: element,\n    };\n\n    // Wait until image is loaded before proceeding\n    if (!deferred) {\n      if (element.width === 0 || element.height === 0) {\n        element.onload = () => {\n          this.initialize(element);\n        };\n      } else {\n        this.initialize(element);\n      }\n    }\n  }\n\n  /**\n   * Initialize the Croppr instance\n   */\n  initialize(element: any) {\n    // Create DOM elements\n    this.createDOM(element);\n\n    // Process option values\n    this.options.convertToPixels(this.cropperEl);\n\n    // Listen for events from children\n    this.attachHandlerEvents();\n    this.attachRegionEvents();\n    this.attachOverlayEvents();\n\n    // Bootstrap this cropper instance\n    this.box = this.initializeBox(this.options);\n    this.redraw();\n\n    // Set the initalized flag to true and call the callback\n    this._initialized = true;\n    if (this.options.onInitialize !== null) {\n      this.options.onInitialize(this);\n    }\n  }\n\n  /**\n   * Create Croppr's DOM elements\n   */\n  createDOM(targetEl: any) {\n    // Create main container and use it as the main event listeners\n    this.containerEl = document.createElement(\"div\");\n    this.containerEl.className = \"croppr-container\";\n    this.eventBus = this.containerEl;\n    enableTouch(this.containerEl);\n\n    // Create cropper element\n    this.cropperEl = document.createElement(\"div\");\n    this.cropperEl.className = \"croppr\";\n\n    // Create image element\n    this.imageEl = document.createElement(\"img\");\n    this.imageEl.setAttribute(\"src\", targetEl.getAttribute(\"src\"));\n    this.imageEl.setAttribute(\"alt\", targetEl.getAttribute(\"alt\"));\n    this.imageEl.className = \"croppr-image\";\n\n    // Create clipped image element\n    this.imageClippedEl = this.imageEl.cloneNode();\n    this.imageClippedEl.className = \"croppr-imageClipped\";\n\n    // Create region box element\n    this.regionEl = document.createElement(\"div\");\n    this.regionEl.innerHTML = new Array(9)\n      .fill(1)\n      .map(() => `<div style=\"border: 1px dashed #fafafa\"></div>`)\n      .join(\"\");\n    this.regionEl.className = \"croppr-region\";\n\n    // Create overlay element\n    this.overlayEl = document.createElement(\"div\");\n    this.overlayEl.className = \"croppr-overlay\";\n\n    // Create handles element\n    let handleContainerEl = document.createElement(\"div\");\n    handleContainerEl.className = \"croppr-handleContainer\";\n    this.handles = [];\n    for (let i = 0; i < HANDLES.length; i++) {\n      const handle = new Handle(\n        HANDLES[i].position,\n        HANDLES[i].constraints,\n        HANDLES[i].cursor,\n        this.eventBus\n      );\n      this.handles.push(handle);\n      handleContainerEl.appendChild(handle.el);\n    }\n\n    // And then we piece it all together!\n    this.cropperEl.appendChild(this.imageEl);\n    this.cropperEl.appendChild(this.imageClippedEl);\n    this.cropperEl.appendChild(this.regionEl);\n    this.cropperEl.appendChild(this.overlayEl);\n    this.cropperEl.appendChild(handleContainerEl);\n    this.containerEl.appendChild(this.cropperEl);\n\n    // And then finally insert it into the document\n    targetEl.parentElement.replaceChild(this.containerEl, targetEl);\n  }\n\n  /**\n   * Changes the image src.\n   * @param {String} src\n   */\n  setImage(src: any) {\n    // Add onload listener to reinitialize box\n    this.imageEl.onload = () => {\n      this.box = this.initializeBox(this.options);\n      this.redraw();\n    };\n\n    // Change image source\n    this.imageEl.src = src;\n    this.imageClippedEl.src = src;\n    return this;\n  }\n\n  /**\n   * Destroy the Croppr instance and replace with the original element.\n   */\n  destroy() {\n    this._restore.parent.replaceChild(this._restore.element, this.containerEl);\n  }\n\n  /**\n   * Create a new box region with a set of options.\n   * @param {Object} opts The options.\n   * @returns {Box}\n   */\n  initializeBox(opts: any) {\n    // Create initial box\n    const width = opts.startSize.width;\n    const height = opts.startSize.height;\n    let box = new Box(0, 0, width, height);\n    // console.log(\"🚀 ~ file: core.ts ~ line 202 ~ CropprCore ~ initializeBox ~ box\", box)\n\n    // Maintain ratio\n    box.constrainToRatio(opts.aspectRatio, [0.5, 0.5]);\n\n    // Maintain minimum/maximum size\n    const min = opts.minSize;\n    const max = opts.maxSize;\n    box.constrainToSize(\n      max.width,\n      max.height,\n      min.width,\n      min.height,\n      [0.5, 0.5],\n      opts.aspectRatio\n    );\n\n    // Constrain to boundary\n    const parentWidth = this.cropperEl.offsetWidth;\n    const parentHeight = this.cropperEl.offsetHeight;\n    box.constrainToBoundary(parentWidth, parentHeight, [0.5, 0.5]);\n\n    // // Move to center\n    const x = this.cropperEl.offsetWidth / 2 - box.width() / 2;\n    const y = this.cropperEl.offsetHeight / 2 - box.height() / 2;\n\n    // console.log(\"🚀 ~ file: core.ts ~ line 219 ~ CropprCore ~ initializeBox ~ this.cropperEl\", this.cropperEl.offsetWidth)\n    // console.log(\"🚀 ~ file: core.ts ~ line 223 ~ CropprCore ~ initializeBox ~ x, y\", x, y)\n    box.move(x as any, y as any);\n\n    return box;\n  }\n\n  /**\n   * Draw visuals (border, handles, etc) for the current box.\n   */\n  redraw() {\n    // Round positional values to prevent subpixel coordinates, which can\n    // result in element that is rendered blurly\n    const width = Math.round(this.box.width()),\n      height = Math.round(this.box.height()),\n      x1 = Math.round(this.box.x1),\n      y1 = Math.round(this.box.y1),\n      x2 = Math.round(this.box.x2),\n      y2 = Math.round(this.box.y2);\n\n    window.requestAnimationFrame(() => {\n      // Update region element\n      this.regionEl.style.transform = `translate(${x1}px, ${y1}px)`;\n      this.regionEl.style.width = width + \"px\";\n      this.regionEl.style.height = height + \"px\";\n\n      // Update clipped image element\n      this.imageClippedEl.style.clip = `rect(${y1}px, ${x2}px, ${y2}px, ${x1}px)`;\n\n      // Determine which handle to bring forward. The following code\n      // calculates the quadrant the box is in using bitwise operators.\n      // Reference: https://stackoverflow.com/questions/9718059\n      const center = this.box.getAbsolutePoint([0.5, 0.5]);\n      const xSign = (center[0] - this.cropperEl.offsetWidth / 2) >> 31;\n      const ySign = (center[1] - this.cropperEl.offsetHeight / 2) >> 31;\n      const quadrant = (xSign ^ ySign) + ySign + ySign + 4;\n\n      // The following equation calculates which handle index to bring\n      // forward. The equation is derived using algebra (if youre curious)\n      const foregroundHandleIndex = -2 * quadrant + 8;\n\n      // Update handle positions\n      for (let i = 0; i < this.handles.length; i++) {\n        let handle = this.handles[i];\n\n        // Calculate handle position\n        const handleWidth = handle.el.offsetWidth;\n        const handleHeight = handle.el.offsetHeight;\n        const left = x1 + width * handle.position[0] - handleWidth / 2;\n        const top = y1 + height * handle.position[1] - handleHeight / 2;\n\n        // Apply new position. The positional values are rounded to\n        // prevent subpixel positions which can result in a blurry element\n        handle.el.style.transform = `translate(${Math.round(\n          left\n        )}px, ${Math.round(top)}px)`;\n        handle.el.style.zIndex = foregroundHandleIndex == i ? 5 : 4;\n      }\n    });\n  }\n\n  /**\n   * Attach listeners for events emitted by the handles.\n   * Enables resizing of the region element.\n   */\n  attachHandlerEvents() {\n    const eventBus = this.eventBus;\n    eventBus.addEventListener(\"handlestart\", this.onHandleMoveStart.bind(this));\n    eventBus.addEventListener(\"handlemove\", this.onHandleMoveMoving.bind(this));\n    eventBus.addEventListener(\"handleend\", this.onHandleMoveEnd.bind(this));\n  }\n\n  /**\n   * Attach event listeners for the crop region element.\n   * Enables dragging/moving of the region element.\n   */\n  attachRegionEvents() {\n    const eventBus = this.eventBus;\n    const self = this;\n\n    this.regionEl.addEventListener(\"mousedown\", onMouseDown);\n    eventBus.addEventListener(\"regionstart\", this.onRegionMoveStart.bind(this));\n    eventBus.addEventListener(\"regionmove\", this.onRegionMoveMoving.bind(this));\n    eventBus.addEventListener(\"regionend\", this.onRegionMoveEnd.bind(this));\n\n    function onMouseDown(e: any) {\n      e.stopPropagation();\n      document.addEventListener(\"mouseup\", onMouseUp);\n      document.addEventListener(\"mousemove\", onMouseMove);\n\n      // Notify parent\n      eventBus.dispatchEvent(\n        new CustomEvent(\"regionstart\", {\n          detail: { mouseX: e.clientX, mouseY: e.clientY },\n        })\n      );\n    }\n\n    function onMouseMove(e: any) {\n      e.stopPropagation();\n\n      // Notify parent\n      eventBus.dispatchEvent(\n        new CustomEvent(\"regionmove\", {\n          detail: { mouseX: e.clientX, mouseY: e.clientY },\n        })\n      );\n    }\n\n    function onMouseUp(e: any) {\n      e.stopPropagation();\n      document.removeEventListener(\"mouseup\", onMouseUp);\n      document.removeEventListener(\"mousemove\", onMouseMove);\n\n      // Notify parent\n      eventBus.dispatchEvent(\n        new CustomEvent(\"regionend\", {\n          detail: { mouseX: e.clientX, mouseY: e.clientY },\n        })\n      );\n    }\n  }\n\n  /**\n   * Attach event listeners for the overlay element.\n   * Enables the creation of a new selection by dragging an empty area.\n   */\n  attachOverlayEvents() {\n    const SOUTHEAST_HANDLE_IDX = 4;\n    const self = this;\n    let tmpBox: any = null;\n    this.overlayEl.addEventListener(\"mousedown\", onMouseDown);\n\n    function onMouseDown(e: any) {\n      e.stopPropagation();\n      document.addEventListener(\"mouseup\", onMouseUp);\n      document.addEventListener(\"mousemove\", onMouseMove);\n\n      // Calculate mouse's position in relative to the container\n      const container = self.cropperEl.getBoundingClientRect();\n      const mouseX = e.clientX - container.left;\n      const mouseY = e.clientY - container.top;\n\n      // Create new box at mouse position\n      tmpBox = self.box;\n      self.box = new Box(mouseX, mouseY, mouseX + 1, mouseY + 1);\n\n      // Activate the bottom right handle\n      self.eventBus.dispatchEvent(\n        new CustomEvent(\"handlestart\", {\n          detail: { handle: self.handles[SOUTHEAST_HANDLE_IDX] },\n        })\n      );\n    }\n\n    function onMouseMove(e: any) {\n      e.stopPropagation();\n      self.eventBus.dispatchEvent(\n        new CustomEvent(\"handlemove\", {\n          detail: { mouseX: e.clientX, mouseY: e.clientY },\n        })\n      );\n    }\n\n    function onMouseUp(e: any) {\n      e.stopPropagation();\n      document.removeEventListener(\"mouseup\", onMouseUp);\n      document.removeEventListener(\"mousemove\", onMouseMove);\n\n      // If the new box has no width and height, it suggests that\n      // the user had just clicked on an empty area and did not drag\n      // a new box (ie. an accidental click). In this scenario, we\n      // simply replace it with the previous box.\n      if (self.box.width() === 1 && self.box.height() === 1) {\n        self.box = tmpBox;\n        return;\n      }\n\n      self.eventBus.dispatchEvent(\n        new CustomEvent(\"handleend\", {\n          detail: { mouseX: e.clientX, mouseY: e.clientY },\n        })\n      );\n    }\n  }\n\n  /**\n   * EVENT HANDLER\n   * Executes when user begins dragging a handle.\n   */\n  onHandleMoveStart(e: any) {\n    let handle = e.detail.handle;\n\n    // The origin point is the point where the box is scaled from.\n    // This is usually the opposite side/corner of the active handle.\n    const originPoint = [1 - handle.position[0], 1 - handle.position[1]];\n    let [originX, originY] = this.box.getAbsolutePoint(originPoint);\n\n    this.activeHandle = { handle, originPoint, originX, originY };\n\n    // Trigger callback\n    if (this.options.onCropStart !== null) {\n      this.options.onCropStart(this.getValue());\n    }\n  }\n\n  /**\n   * EVENT HANDLER\n   * Executes on handle move. Main logic to manage the movement of handles.\n   */\n  onHandleMoveMoving(e: any) {\n    let { mouseX, mouseY } = e.detail;\n\n    // Calculate mouse's position in relative to the container\n    let container = this.cropperEl.getBoundingClientRect();\n    mouseX = mouseX - container.left;\n    mouseY = mouseY - container.top;\n\n    // Ensure mouse is within the boundaries\n    if (mouseX < 0) {\n      mouseX = 0;\n    } else if (mouseX > container.width) {\n      mouseX = container.width;\n    }\n\n    if (mouseY < 0) {\n      mouseY = 0;\n    } else if (mouseY > container.height) {\n      mouseY = container.height;\n    }\n\n    // Bootstrap helper variables\n    let origin = this.activeHandle.originPoint.slice();\n    const originX = this.activeHandle.originX;\n    const originY = this.activeHandle.originY;\n    const handle = this.activeHandle.handle;\n    const TOP_MOVABLE = handle.constraints[0] === 1;\n    const RIGHT_MOVABLE = handle.constraints[1] === 1;\n    const BOTTOM_MOVABLE = handle.constraints[2] === 1;\n    const LEFT_MOVABLE = handle.constraints[3] === 1;\n    const MULTI_AXIS =\n      (LEFT_MOVABLE || RIGHT_MOVABLE) && (TOP_MOVABLE || BOTTOM_MOVABLE);\n\n    // Apply movement to respective sides according to the handle's\n    // constraint values.\n    let x1 = LEFT_MOVABLE || RIGHT_MOVABLE ? originX : this.box.x1;\n    let x2 = LEFT_MOVABLE || RIGHT_MOVABLE ? originX : this.box.x2;\n    let y1 = TOP_MOVABLE || BOTTOM_MOVABLE ? originY : this.box.y1;\n    let y2 = TOP_MOVABLE || BOTTOM_MOVABLE ? originY : this.box.y2;\n    x1 = LEFT_MOVABLE ? mouseX : x1;\n    x2 = RIGHT_MOVABLE ? mouseX : x2;\n    y1 = TOP_MOVABLE ? mouseY : y1;\n    y2 = BOTTOM_MOVABLE ? mouseY : y2;\n\n    // Check if the user dragged past the origin point. If it did,\n    // we set the flipped flag to true.\n    let [isFlippedX, isFlippedY] = [false, false];\n    if (LEFT_MOVABLE || RIGHT_MOVABLE) {\n      isFlippedX = LEFT_MOVABLE ? mouseX > originX : mouseX < originX;\n    }\n    if (TOP_MOVABLE || BOTTOM_MOVABLE) {\n      isFlippedY = TOP_MOVABLE ? mouseY > originY : mouseY < originY;\n    }\n\n    // If it is flipped, we swap the coordinates and flip the origin point.\n    if (isFlippedX) {\n      const tmp = x1;\n      x1 = x2;\n      x2 = tmp; // Swap x1 and x2\n      origin[0] = 1 - origin[0]; // Flip origin x point\n    }\n    if (isFlippedY) {\n      const tmp = y1;\n      y1 = y2;\n      y2 = tmp; // Swap y1 and y2\n      origin[1] = 1 - origin[1]; // Flip origin y point\n    }\n\n    // Create new box object\n    let box = new Box(x1, y1, x2, y2);\n\n    // Maintain aspect ratio\n    if (this.options.aspectRatio) {\n      const ratio = this.options.aspectRatio;\n      let isVerticalMovement = false;\n      if (MULTI_AXIS) {\n        isVerticalMovement =\n          mouseY > box.y1 + ratio * box.width() ||\n          mouseY < box.y2 - ratio * box.width();\n      } else if (TOP_MOVABLE || BOTTOM_MOVABLE) {\n        isVerticalMovement = true;\n      }\n      const ratioMode = isVerticalMovement ? \"width\" : \"height\";\n      box.constrainToRatio(ratio, origin, ratioMode);\n    }\n\n    // Maintain minimum/maximum size\n    const min = this.options.minSize;\n    const max = this.options.maxSize;\n    box.constrainToSize(\n      max.width,\n      max.height,\n      min.width,\n      min.height,\n      origin,\n      this.options.aspectRatio\n    );\n\n    // Constrain to boundary\n    const parentWidth = this.cropperEl.offsetWidth;\n    const parentHeight = this.cropperEl.offsetHeight;\n    box.constrainToBoundary(parentWidth, parentHeight, origin);\n\n    // Finally, update the visuals (border, handles, clipped image, etc)\n    this.box = box;\n    this.redraw();\n\n    // Trigger callback\n    if (this.options.onCropMove !== null) {\n      this.options.onCropMove(this.getValue());\n    }\n  }\n\n  /**\n   * EVENT HANDLER\n   * Executes on handle move end.\n   */\n  onHandleMoveEnd(e: any) {\n    // Trigger callback\n    if (this.options.onCropEnd !== null) {\n      this.options.onCropEnd(this.getValue());\n    }\n  }\n\n  /**\n   * EVENT HANDLER\n   * Executes when user starts moving the crop region.\n   */\n  onRegionMoveStart(e: any) {\n    let { mouseX, mouseY } = e.detail;\n\n    // Calculate mouse's position in relative to the container\n    let container = this.cropperEl.getBoundingClientRect();\n    mouseX = mouseX - container.left;\n    mouseY = mouseY - container.top;\n\n    this.currentMove = {\n      offsetX: mouseX - this.box.x1,\n      offsetY: mouseY - this.box.y1,\n    };\n\n    // Trigger callback\n    if (this.options.onCropStart !== null) {\n      this.options.onCropStart(this.getValue());\n    }\n  }\n\n  /**\n   * EVENT HANDLER\n   * Executes when user moves the crop region.\n   */\n  onRegionMoveMoving(e: any) {\n    let { mouseX, mouseY } = e.detail;\n    let { offsetX, offsetY } = this.currentMove;\n\n    // Calculate mouse's position in relative to the container\n    let container = this.cropperEl.getBoundingClientRect();\n    mouseX = mouseX - container.left;\n    mouseY = mouseY - container.top;\n\n    this.box.move(mouseX - offsetX, mouseY - offsetY);\n\n    // Ensure box is within the boundaries\n    if (this.box.x1 < 0) {\n      this.box.move(0, null);\n    }\n    if (this.box.x2 > container.width) {\n      this.box.move(container.width - this.box.width(), null);\n    }\n    if (this.box.y1 < 0) {\n      this.box.move(null, 0);\n    }\n    if (this.box.y2 > container.height) {\n      this.box.move(null, container.height - this.box.height());\n    }\n\n    // Update visuals\n    this.redraw();\n\n    // Trigger callback\n    if (this.options.onCropMove !== null) {\n      this.options.onCropMove(this.getValue());\n    }\n  }\n\n  /**\n   * EVENT HANDLER\n   * Executes when user stops moving the crop region (mouse up).\n   */\n  onRegionMoveEnd(e: any) {\n    // Trigger callback\n    if (this.options.onCropEnd !== null) {\n      this.options.onCropEnd(this.getValue());\n    }\n  }\n\n  /**\n   * Calculate the value of the crop region.\n   */\n  getValue(mode = null) {\n    if (mode === null) {\n      mode = this.options.returnMode;\n    }\n    if (mode == \"real\") {\n      const actualWidth = this.imageEl.naturalWidth;\n      const actualHeight = this.imageEl.naturalHeight;\n      const { width: elementWidth, height: elementHeight } =\n        this.imageEl.getBoundingClientRect();\n      const factorX = actualWidth / elementWidth;\n      const factorY = actualHeight / elementHeight;\n      return {\n        x: Math.round(this.box.x1 * factorX),\n        y: Math.round(this.box.y1 * factorY),\n        width: Math.round(this.box.width() * factorX),\n        height: Math.round(this.box.height() * factorY),\n      };\n    } else if (mode == \"ratio\") {\n      const { width: elementWidth, height: elementHeight } =\n        this.imageEl.getBoundingClientRect();\n      return {\n        x: round(this.box.x1 / elementWidth, 3),\n        y: round(this.box.y1 / elementHeight, 3),\n        width: round(this.box.width() / elementWidth, 3),\n        height: round(this.box.height() / elementHeight, 3),\n      };\n    } else if (mode == \"raw\") {\n      return {\n        x: Math.round(this.box.x1),\n        y: Math.round(this.box.y1),\n        width: Math.round(this.box.width()),\n        height: Math.round(this.box.height()),\n      };\n    }\n  }\n\n  /**\n   * Parse user options and set default values.\n   */\n  static parseOptions(opts: any) {\n    const defaults = {\n      aspectRatio: null,\n      maxSize: { width: null, height: null },\n      minSize: { width: null, height: null },\n      startSize: { width: 100, height: 100, unit: \"%\" },\n      returnMode: \"real\",\n      onInitialize: null,\n      onCropStart: null,\n      onCropMove: null,\n      onCropEnd: null,\n    };\n\n    // Parse aspect ratio\n    let aspectRatio = null;\n    if (opts.aspectRatio !== undefined) {\n      if (typeof opts.aspectRatio === \"number\") {\n        aspectRatio = opts.aspectRatio;\n      } else if (opts.aspectRatio instanceof Array) {\n        aspectRatio = opts.aspectRatio[1] / opts.aspectRatio[0];\n      }\n    }\n\n    // Parse max width/height\n    let maxSize = null;\n    if (opts.maxSize !== undefined && opts.maxSize !== null) {\n      maxSize = {\n        width: opts.maxSize[0] || null,\n        height: opts.maxSize[1] || null,\n        unit: opts.maxSize[2] || \"px\",\n      };\n    }\n\n    // Parse min width/height\n    let minSize = null;\n    if (opts.minSize !== undefined && opts.minSize !== null) {\n      minSize = {\n        width: opts.minSize[0] || null,\n        height: opts.minSize[1] || null,\n        unit: opts.minSize[2] || \"px\",\n      };\n    }\n\n    // Parse start size\n    let startSize = null;\n    if (opts.startSize !== undefined && opts.startSize !== null) {\n      startSize = {\n        width: opts.startSize[0] || null,\n        height: opts.startSize[1] || null,\n        unit: opts.startSize[2] || \"%\",\n      };\n    }\n\n    // Parse callbacks\n    let onInitialize = null;\n    if (typeof opts.onInitialize === \"function\") {\n      onInitialize = opts.onInitialize;\n    }\n\n    let onCropStart = null;\n    if (typeof opts.onCropStart === \"function\") {\n      onCropStart = opts.onCropStart;\n    }\n\n    let onCropEnd = null;\n    if (typeof opts.onCropEnd === \"function\") {\n      onCropEnd = opts.onCropEnd;\n    }\n\n    let onCropMove = null;\n    if (typeof opts.onUpdate === \"function\") {\n      // DEPRECATED: onUpdate is deprecated to create a more uniform\n      // callback API, such as: onCropStart, onCropMove, onCropEnd\n      console.warn(\n        \"Croppr.js: `onUpdate` is deprecated and will be removed in the next major release. Please use `onCropMove` or `onCropEnd` instead.\"\n      );\n      onCropMove = opts.onUpdate;\n    }\n    if (typeof opts.onCropMove === \"function\") {\n      onCropMove = opts.onCropMove;\n    }\n\n    // Parse returnMode value\n    let returnMode = null;\n    if (opts.returnMode !== undefined) {\n      const s = opts.returnMode.toLowerCase();\n      if ([\"real\", \"ratio\", \"raw\"].indexOf(s) === -1) {\n        throw \"Invalid return mode.\";\n      }\n      returnMode = s;\n    }\n\n    // Create function to convert % values to pixels\n    const convertToPixels = function (this: any, container: any) {\n      const width = container.offsetWidth;\n      const height = container.offsetHeight;\n\n      // Convert sizes\n      const sizeKeys = [\"maxSize\", \"minSize\", \"startSize\"];\n      for (let i = 0; i < sizeKeys.length; i++) {\n        const key = sizeKeys[i];\n        if (this[key] !== null) {\n          if (this[key].unit == \"%\") {\n            if (this[key].width !== null) {\n              this[key].width = (this[key].width / 100) * width;\n            }\n            if (this[key].height !== null) {\n              this[key].height = (this[key].height / 100) * height;\n            }\n          }\n          delete this[key].unit;\n        }\n      }\n    };\n\n    const defaultValue = (v: any, d: any) => (v !== null ? v : d);\n    return {\n      aspectRatio: defaultValue(aspectRatio, defaults.aspectRatio),\n      maxSize: defaultValue(maxSize, defaults.maxSize),\n      minSize: defaultValue(minSize, defaults.minSize),\n      startSize: defaultValue(startSize, defaults.startSize),\n      returnMode: defaultValue(returnMode, defaults.returnMode),\n      onInitialize: defaultValue(onInitialize, defaults.onInitialize),\n      onCropStart: defaultValue(onCropStart, defaults.onCropStart),\n      onCropMove: defaultValue(onCropMove, defaults.onCropMove),\n      onCropEnd: defaultValue(onCropEnd, defaults.onCropEnd),\n      convertToPixels: convertToPixels,\n    };\n  }\n}\n\n/**\n * HELPER FUNCTIONS\n */\n\nfunction round(value: any, decimals: any) {\n  return Number(Math.round((value + \"e\" + decimals) as any) + \"e-\" + decimals);\n}\n","/**\n * Croppr.js\n * https://github.com/jamesssooi/Croppr.js\n *\n * A JavaScript image cropper that's lightweight, awesome, and has\n * zero dependencies.\n *\n * (C) 2017 James Ooi. Released under the MIT License.\n */\n\nimport CropprCore from \"./core\";\n\n/**\n * This class is a wrapper for CropprCore that merely implements the main\n * interfaces for the Croppr instance. Look into CropprCore for all the\n * main logic.\n */\nexport default class Croppr extends CropprCore {\n  /**\n   * @constructor\n   * Calls the CropprCore's constructor.\n   */\n  constructor(element: any, options: any, _deferred = false) {\n    super(element, options, _deferred);\n  }\n\n  /**\n   * Gets the value of the crop region.\n   * @param {String} [mode] Which mode of calculation to use: 'real', 'ratio' or\n   *      'raw'.\n   */\n  getValue(mode?: any) {\n    return super.getValue(mode);\n  }\n\n  /**\n   * Changes the image src.\n   * @param {String} src\n   */\n  setImage(src: any) {\n    return super.setImage(src);\n  }\n\n  /**\n   * Destroys the Croppr instance\n   */\n  destroy() {\n    return super.destroy();\n  }\n\n  /**\n   * Moves the crop region to a specified coordinate.\n   * @param {Number} x\n   * @param {Number} y\n   */\n  moveTo(x: any, y: any) {\n    this.box.move(x, y);\n    this.redraw();\n\n    // Call the callback\n    if (this.options.onCropEnd !== null) {\n      this.options.onCropEnd(this.getValue());\n    }\n    return this;\n  }\n\n  /**\n   * Resizes the crop region to a specified width and height.\n   * @param {Number} width\n   * @param {Number} height\n   * @param {Array} origin The origin point to resize from.\n   *      Defaults to [0.5, 0.5] (center).\n   */\n  resizeTo(width: any, height: any, origin = [0.5, 0.5]) {\n    this.box.resize(width, height, origin);\n\n    //////////////////////////////////////////////////////////////////\n    const parentWidth = this.cropperEl.offsetWidth;\n    const parentHeight = this.cropperEl.offsetHeight;\n    this.box.constrainToBoundary(parentWidth, parentHeight, [0.5, 0.5]);\n    ///////////////////////////////////////////////////////////////////\n    this.redraw();\n\n    // Call the callback\n    if (this.options.onCropEnd !== null) {\n      this.options.onCropEnd(this.getValue());\n    }\n    return this;\n  }\n\n  /**\n   * Scale the crop region by a factor.\n   * @param {Number} factor\n   * @param {Array} origin The origin point to resize from.\n   *      Defaults to [0.5, 0.5] (center).\n   */\n  scaleBy(factor: any, origin = [0.5, 0.5]) {\n    this.box.scale(factor, origin);\n    this.redraw();\n\n    // Call the callback\n    if (this.options.onCropEnd !== null) {\n      this.options.onCropEnd(this.getValue());\n    }\n    return this;\n  }\n\n  /**\n   * Resets the crop region to the initial settings.\n   */\n  reset(newOptions?: any) {\n    if (newOptions) {\n      this.options = { ...this.options, newOptions };\n    }\n    this.box = this.initializeBox(this.options);\n    // console.log('🚀 ~ file: croppr.ts ~ line 110 ~ Croppr ~ reset ~ this.box', this.box);\n    this.redraw();\n\n    // Call the callback\n    if (this.options.onCropEnd !== null) {\n      this.options.onCropEnd(this.getValue());\n    }\n    return this;\n  }\n\n  enableVisibility(state: boolean) {\n    let croppContainer: HTMLElement | any =\n      document.querySelector(\".croppr-container\");\n    if (!croppContainer) throw new Error(\"THere is not any croppr\");\n    if (state) {\n      croppContainer.style.display = \"block\";\n    } else {\n      croppContainer.style.display = \"none\";\n    }\n  }\n}\n","import React, { memo, useEffect, useRef, useState } from 'react'\nimport Croppr from '../../functions/croppr/index';\n\nimport './croppr.scss';\n\nconst CropprWrapper = memo(({ src, size, croppUpdate }:\n  {\n    src: string,\n    size: any,\n    croppUpdate: (data: { x: number; y: number; width: number; height: number }) => void\n  }) => {\n  const [imageSrc, setImageSrc] = useState<string | undefined | null>()\n  const [croppSize, setCroppSize] = useState<{ width: number; height: number }>({ width: 150, height: 150 })\n  const croppr = useRef<Croppr | undefined | null>(null);\n  const mount = useRef<HTMLImageElement | undefined | null>();\n\n  useEffect(() => {\n    if (size) {\n      setCroppSize({ ...size });\n      if (croppr.current) croppr.current.resizeTo(size.width, size.height);\n    }\n  }, [size])\n\n  useEffect(() => {\n    if (src) {\n      setImageSrc(src);\n    }\n  }, [src])\n\n  useEffect(() => {\n    if (mount.current && imageSrc) {\n      croppr.current = new Croppr('#croppr', {\n        minSize: [32, 32, 'px'],\n        startSize: [croppSize.width, croppSize.height, 'px'],\n        onInitialize: (data: Croppr | any) => {\n          croppUpdate(data?.getValue());\n        },\n        onCropEnd: (data: { x: number; y: number; width: number; height: number }) => {\n          croppUpdate(data);\n        },\n      });\n    }\n    return () => (croppr?.current?.destroy())\n  }, [mount.current, imageSrc])\n\n\n  return <div className='CropprWrapper'>\n    <img ref={mount as any} src={imageSrc as string} id=\"croppr\" />\n  </div>\n\n})\n\nexport default CropprWrapper\n","\nimport React, { memo, useState, useEffect, useRef, useMemo } from 'react';\nimport { IBasicFilterState, IState } from '../../models/index.models';\n\nimport './EditImage.scss';\nimport TabContainer, { TabItem } from '../Tab/Tab';\nimport { convertImageUsingCanvas, dragElement, saveState } from '../../functions/image-processing';\nimport Input from '../Input/Input';\nimport BasicFilter from '../BasicFilters/BasicFilter';\nimport CropprWrapper from '../CropprWrapper/CropprWrapper';\n\nexport interface EditImageProps {\n  labels: any;\n  image: string | null | undefined;\n  color: string;\n  initialState: IState,\n  saveUpdates: Function\n}\nconst _initialState: IState = {\n  quality: 92,\n  maxHeight: 1000,\n  maxWidth: 1000,\n  cropHeight: 150,\n  cropWidth: 150,\n  maintainAspectRatio: true,\n  format: 'jpeg',\n  arrayCopiedImages: [],\n  originImageSrc: '',\n}\n\nconst EditImage = memo(({ labels = {}, image = '', color = '#1e88e5', initialState = _initialState, saveUpdates = () => { } }: EditImageProps) => {\n  const [state, setState] = useState<IState>(initialState)\n  const [imageSrc, setImageSrc] = useState<string | null>('')\n  const [showCrop, setShowCrop] = useState<boolean>(false);\n  const [croppSize, setCroppSize] = useState<{ width: number; height: number }>({ width: 150, height: 150 })\n  const [croppState, setCroppState] = useState<{ x: number; y: number; width: number; height: number } | undefined | null>()\n\n  const isMobile = useRef<boolean>(false);\n  const allFormats = ['webp', 'jpeg', 'png'];\n\n  useEffect(() => {\n    isMobile.current = window.innerWidth < 800;\n    setState(JSON.parse(JSON.stringify({ ...state, ...initialState })));\n  }, [initialState])\n\n  useEffect(() => {\n    setImageSrc(image)\n  }, [image])\n\n\n  useEffect(() => {\n    if (!showCrop) {\n      setCroppSize({ width: 150, height: 150 });\n    }\n  }, [showCrop])\n\n\n  async function applyChanges(stateIntance: IState, changeHeight = false) {\n    try {\n      const { state: newState, imageUri } = await convertImageUsingCanvas(state.originImageSrc as string, changeHeight, stateIntance);\n      setImageSrc(imageUri)\n      setState(newState);\n      // console.log(\"Here\", newState);\n    } catch (error) {\n      console.log(\"🚀 ~ file: EditImage.tsx ~ line 73 ~ applyChanges ~ error\", error)\n    }\n  }\n\n  async function onUpdateQuality(quality: number) {\n    quality = Math.max(Math.min(quality, 100), 1);\n    // console.log(\"🚀 ~ file: EditImage.tsx ~ line 73 ~ onUpdateQuality ~ quality\", quality)\n    const newState: IState = { ...state, quality }\n    setState(newState);\n    try {\n      await applyChanges(newState, false);\n    } catch (error) {\n      console.log(\"onUpdateQuality ~ error\", error)\n    }\n  }\n\n  async function onChangeSize(value: number, changeHeight = false) {\n    let m = Math.max(Math.min(value, 4000), 32);\n    const newState: IState = { ...state }\n\n    if (changeHeight) {\n      if (newState.maxHeight === m) return;\n      newState.maxHeight = m;\n    }\n    else {\n      if (newState.maxWidth === m) return;\n      newState.maxWidth = m;\n    }\n    setState(newState);\n    try {\n      await applyChanges(newState, changeHeight);\n    } catch (error) {\n      console.log(\"onChangeSize ~ error\", error)\n    }\n  }\n\n  async function onChangeFormat(e: any) {\n    const newState: IState = { ...state, format: e.target.value }\n    try {\n      setState(newState);\n      await applyChanges(newState, false);\n    } catch (error) {\n      console.log(\"onChangeFormat ~ error\", error)\n    }\n  }\n\n\n  function onChangeCrop(width: number | null, height: number | null) {\n    if (width) {\n      setState({ ...state, cropWidth: width })\n      setCroppSize({ ...croppSize, width: width });\n    }\n    if (height) {\n      setState({ ...state, cropHeight: height })\n      setCroppSize({ ...croppSize, height: height });\n    }\n  }\n\n  function onCrop() {\n    let newState: IState = _cloneObject(state)\n    const canvas = document.createElement('canvas');\n    return new Promise((resolve, reject) => {\n      let ctx: any = canvas.getContext('2d');\n      let image = new Image();\n      image.src = imageSrc as string;\n      image.onload = () => {\n        let newWidth: any = croppState?.width;\n        let newHeight: any = croppState?.height;\n        canvas.height = newHeight;\n        canvas.width = newWidth;\n        ctx.drawImage(\n          image,\n          Math.abs(croppState?.x as any),\n          Math.abs(croppState?.y as any),\n          croppState?.width,\n          croppState?.height,\n          0,\n          0,\n          croppState?.width,\n          croppState?.height,\n        );\n        return resolve(canvas.toDataURL(`image/${newState.format}`, newState.quality));\n      };\n      image.onerror = (e) => {\n        reject(e);\n      };\n    })\n      .then((dataUri: string) => {\n        newState.maxWidth = canvas.width;\n        newState.maxHeight = canvas.height;\n        newState.originImageSrc = dataUri;\n        newState = saveState(newState, dataUri)\n        setState(newState);\n        setImageSrc(dataUri);\n        setShowCrop(false);\n      })\n      .catch((e) => {\n        console.log(e);\n      });\n  }\n\n  function onCroppUpdate(data: { x: number; y: number; width: number; height: number }) {\n    setCroppState(data);\n    setState({ ...state, cropHeight: data.height, cropWidth: data.width });\n  }\n\n\n  function onCloseEditPanel(saveChanges: boolean = false) {\n    setShowCrop(false);\n    if (saveChanges) saveUpdates({ state: state, imageSrc: imageSrc });\n    else saveUpdates(null);\n  }\n\n  async function onRestore() {\n    try {\n      let newState: IState = _cloneObject(state);\n      if (newState.arrayCopiedImages.length > 1) {\n        newState.arrayCopiedImages.pop();\n        let newValue = newState.arrayCopiedImages[newState.arrayCopiedImages.length - 1];\n        newState = {\n          ...state,\n          arrayCopiedImages: newState.arrayCopiedImages,\n          maxHeight: newValue.height,\n          maxWidth: newValue.width,\n          quality: newValue.quality,\n          format: newValue.format,\n          originImageSrc: newValue.originImageSrc,\n          basicFilters: newValue.basicFilters as IBasicFilterState,\n        };\n        setState(newState);\n        setImageSrc(newValue.lastImage);\n      }\n    } catch (e) {\n      console.log('🚀 ~ file: edit-image.component.ts ~ line 126 ~ EditImageComponent ~ onRestore ~ e', e);\n    }\n  }\n\n  async function onChangeFilters(data: IBasicFilterState) {\n    try {\n      let newState: IState = _cloneObject(state);\n      if (!newState.basicFilters) {\n        newState.basicFilters = data;\n      } else {\n        newState.basicFilters = { ...newState.basicFilters, ...data };\n      }\n      await applyChanges(newState, false);\n    } catch (e) {\n      console.log(\"🚀 ~ file: EditImage.tsx ~ line 259 ~ onChangeFilters ~ e\", e)\n    }\n  }\n\n\n\n  const sizeImage = useMemo(() => {\n    if (imageSrc && imageSrc.length) {\n      return Math.ceil(((3 / 4) * imageSrc.length) / 1024);\n    } else {\n      return '';\n    }\n  }, [imageSrc])\n\n  function _cloneObject(obj: any): any {\n    return JSON.parse(JSON.stringify(obj))\n\n  }\n\n\n  return <div className=\"EditImage\">\n    <div id=\"popup\" className=\"popup\">\n      <div\n        style={{\n          flexDirection: 'row',\n          'boxSizing': 'border-box',\n          display: 'flex',\n          'placeContent': 'center flex-end',\n          'alignItems': 'center',\n          padding: '0px 16px'\n        }}>\n        <button className=\"icon-btn\" onClick={() => { onCloseEditPanel(false) }}>\n          <span className=\"material-icons\">clear</span>\n        </button>\n      </div>\n      <div className=\"image-container\">\n        <div className=\"image-holder-full\">\n          {!showCrop && <img id=\"image-full\" src={imageSrc as string} />}\n          {showCrop && <CropprWrapper src={imageSrc as string} size={croppSize} croppUpdate={onCroppUpdate} ></CropprWrapper>}\n        </div>\n\n        <div className=\"control-panel\">\n          <TabContainer lazy borderLine>\n            <TabItem name=\"Basic\">\n              {(!isMobile.current || (isMobile.current && !showCrop)) &&\n                (<React.Fragment><div style={{ display: 'flex', width: '100%', justifyContent: 'space-between' }}>\n                  <p className=\"item-panel\">{labels['Quality']}</p>\n                  <p className=\"item-panel\">{state.quality + '%'}</p>\n                </div>\n\n                  <div className='flex-row-start'>\n                    <Input readOnly={showCrop} disabled={showCrop}\n                      className=\"input-range\"\n                      onChangedDelayed={onUpdateQuality}\n                      onChangedValue={(value: number) => { setState({ ...state, quality: value }) }}\n                      style={{\n                        maxWidth: '100%', width: '100%', color: color\n                      }}\n                      type=\"range\"\n                      min={1}\n                      max={100}\n                      value={state.quality} />\n                  </div>\n\n                  <div className=\"item-panel\" style={{ display: 'flex', width: '100%', justifyContent: 'space-between' }}>\n                    {labels['Max dimensions']}\n                    <div style={{ display: 'flex', alignItems: 'center' }}>\n                      <input disabled={showCrop} readOnly={showCrop}\n                        type=\"checkbox\" checked={state.maintainAspectRatio}\n                        onChange={(e) => setState({ ...state, maintainAspectRatio: e.target.checked })}\n                        style={{ color: color }} />\n                      <span className=\"caption\">{labels['aspect-ratio']}</span>\n                    </div>\n                  </div>\n\n                  <div className='flex-row-start' style={{ marginTop: '10px', justifyContent: 'space-between' }}>\n                    <div className=\"form-field\" style={{ maxWidth: '48%', width: '48%' }}>\n                      <label>{labels['max-width(px)']}</label>\n                      <Input\n                        readOnly={showCrop}\n                        disabled={showCrop}\n                        placeholder={labels['max-width(px)']}\n                        value={state.maxWidth}\n                        onChangedValue={(value: number) => setState({ ...state, maxWidth: value })}\n                        type=\"number\"\n                        min={0}\n                        max={2000}\n                        onInputChangedEnd={(value: number) => { onChangeSize(value, false) }}\n                      />\n                    </div>\n\n\n                    <div className=\"form-field\" style={{ maxWidth: '48%', width: '48%' }}>\n                      <label>{labels['max-height(px)']}</label>\n                      <Input\n                        readOnly={showCrop}\n                        disabled={showCrop}\n                        placeholder={labels['max-height(px)']}\n                        value={state.maxHeight}\n                        onChangedValue={(value: number) => setState({ ...state, maxHeight: value })}\n                        type=\"number\"\n                        min={0}\n                        max={2000}\n                        onInputChangedEnd={(value: number) => { onChangeSize(value, true) }}\n                      />\n                    </div>\n                  </div>\n\n                  <p className=\"item-panel\">{labels['Format']}</p>\n                  <div className='flex-row-start' style={{ marginTop: '10px', justifyContent: 'space-between' }}>\n                    <div className=\"form-field\" style={{ width: '100%' }}>\n                      <select disabled={showCrop} value={state.format} onChange={onChangeFormat}>\n                        {allFormats.map((formatItem, index) => (\n                          <option key={index} value={formatItem}>{formatItem}</option>\n                        ))}\n                      </select>\n                    </div>\n                  </div>\n                </React.Fragment>)}\n\n              <div className='flex-row-start' style={{ marginTop: '5px', justifyContent: 'space-between' }}>\n                <span style={{ display: 'flex', alignItems: 'center' }}>\n                  <input\n                    type=\"checkbox\"\n                    onChange={(e) => { setShowCrop(e.target.checked) }}\n                    checked={showCrop}\n                    style={{ color: color, marginBottom: '3px' }}\n                  />\n                  <span className=\"item-panel\" style={{ marginLeft: '4px' }}>{labels['Crop']}</span>\n                </span>\n              </div>\n              {showCrop &&\n                <React.Fragment>\n                  <div className='flex-row-start' style={{ marginTop: '10px', justifyContent: 'space-between' }}>\n                    <div className=\"form-field\" style={{ maxWidth: '48%', width: '48%' }}>\n                      <label>{labels['width(px)']}</label>\n                      <Input type=\"number\"\n                        min={0}\n                        value={state.cropWidth}\n                        onChangedValue={(value: number) => setState({ ...state, cropWidth: value })}\n                        onInputChangedEnd={(value: number) => { onChangeCrop(+value, null) }}\n                        placeholder={labels['width(px)']} />\n                    </div>\n\n                    <div className=\"form-field\" style={{ maxWidth: '48%', width: '48%' }}>\n                      <label>{labels['height(px)']}</label>\n                      <Input type=\"number\"\n                        min={0}\n                        value={state.cropHeight}\n                        onInputChangedEnd={(value: number) => { onChangeCrop(null, +value) }}\n                        onChangedValue={(value: number) => setState({ ...state, cropHeight: value })}\n                        placeholder={labels['height(px)']} />\n                    </div>\n                  </div>\n\n                  <p style={{ marginBottom: '4px !important' }}>\n                    <button title=\"Cut the image\" className=\"icon-btn\" onClick={onCrop}>\n                      <span className=\"material-icons\"> crop </span>\n                    </button>\n                  </p>\n                </React.Fragment>\n              }\n            </TabItem>\n            <TabItem disabled={showCrop} name=\"Filters\">\n              <BasicFilter color={color} labels={labels} initialState={state.basicFilters} changeFilter={onChangeFilters}></BasicFilter>\n            </TabItem>\n          </TabContainer>\n          <button\n            title={labels['Undo']}\n            disabled={state.arrayCopiedImages.length <= 1}\n            style={{ position: 'absolute', right: '10px', top: '30px' }}\n            className=\"icon-btn\"\n            onClick={onRestore}\n          >\n            <span className=\"material-icons\"> refresh </span>\n          </button>\n          <div className='flex-row-start' style={{ marginTop: '10px', justifyContent: 'space-between', alignItems: 'center' }}>\n            <button className=\"save-btn\" onClick={() => { onCloseEditPanel(true) }}>{labels['Save']}</button>\n            {sizeImage && <p\n              className=\"caption image-caption\"\n              style={{\n                color: sizeImage > 120 ? '#f44336' : 'unset',\n                fontWeight: sizeImage > 120 ? '500' : 'unset'\n              }}\n            >\n              size: {sizeImage}Kb &nbsp; {state.format}\n            </p>\n            }\n          </div>\n\n        </div>\n      </div>\n    </div>\n  </div >\n})\n\n\nexport default EditImage\n\n\n","/* eslint-disable react-hooks/exhaustive-deps */\nimport React, { memo, useEffect, useMemo, useRef, useState } from \"react\"\nimport { ImagePickerConf, IState } from \"./models/index.models\";\nimport './styles.scss'\nimport labelEs from './i18n/es.json';\nimport labelEn from './i18n/en.json';\nimport labelFr from './i18n/fr.json';\nimport labelDe from './i18n/de.json';\nimport { convertImageUsingCanvas } from \"./functions/image-processing\";\nimport EditImage from \"./components/EditImage/EditImage\";\nexport * from './models/index.models';\n\nconst initialConfig: ImagePickerConf = {\n  language: 'en',\n  objectFit: 'cover',\n  hideDeleteBtn: false,\n  hideDownloadBtn: false,\n  hideEditBtn: false,\n  hideAddBtn: false,\n}\n\nconst ReactImagePickerEditor = memo(({ config = {}, imageSrcProp = '', color = '#1e88e5', imageChanged = () => { } }:\n  { config: ImagePickerConf, imageSrcProp?: string, color?: string; imageChanged?: Function; }) => {\n\n  const [state, setState] = useState<IState>({\n    quality: 92,\n    maxHeight: 1000,\n    maxWidth: 1000,\n    cropHeight: 150,\n    cropWidth: 150,\n    maintainAspectRatio: true,\n    format: 'jpeg',\n    arrayCopiedImages: [],\n    originImageSrc: '',\n  })\n  const [imageSrc, setImageSrc] = useState<string | null>('')\n  const [loadImage, setLoadImage] = useState<boolean>(false)\n  const [showEditPanel, setShowEditPanel] = useState<boolean>(false);\n  const [labels, setLabels] = useState<any>(labelEn);\n  const [configuration, setConfiguration] = useState<ImagePickerConf>(initialConfig)\n  const imagePicker = useRef<any>(null);\n  const fileType = useRef('')\n  const urlImage = useRef('')\n  const uuidFilePicker = Date.now().toString(20);\n  const imageName = useRef('donload');\n\n\n  useEffect(() => {\n    appendLinkIconsToHead();\n    processConfig();\n  }, [config])\n\n\n  useEffect(() => {\n    (async () => {\n      if (imageSrcProp) {\n        let result = await parseToBase64(imageSrcProp);\n        let newState: IState = result.state;\n        newState.originImageSrc = imageSrcProp;\n        newState.arrayCopiedImages.push({\n          lastImage: result.imageUri,\n          width: newState.maxWidth,\n          height: newState.maxHeight,\n          quality: newState.quality,\n          format: newState.format,\n          originImageSrc: imageSrcProp,\n        });\n        setImageSrc(result.imageUri)\n        setState(newState);\n        setLoadImage(true);\n      } else {\n        let newState = { ...state };\n        newState.originImageSrc = null;\n        newState.arrayCopiedImages = [];\n        newState = {\n          ...newState,\n          format: 'jpeg',\n          maxHeight: 1000,\n          maxWidth: 1000,\n          cropHeight: 150,\n          cropWidth: 150,\n          maintainAspectRatio: true,\n          basicFilters: undefined\n        };\n        setLoadImage(false);\n        setImageSrc(null);\n        setState(newState);\n      }\n    })()\n  }, [imageSrcProp])\n\n\n\n\n  function processConfig() {\n    let dataConf = { ...configuration, ...config };\n    setConfiguration(dataConf);\n    // console.log(\"🚀 ~ file: index.tsx ~ line 52 ~ processConfig ~ dataConf\", dataConf)\n\n    if (config.language != undefined) {\n      if (config.language == 'en') {\n        setLabels({ ...labelEn });\n      }\n      if (config.language == 'es') {\n        setLabels({ ...labelEs });\n      }\n      if (config.language == 'fr') {\n        setLabels({ ...labelFr });\n      }\n      if (config.language == 'de') {\n        setLabels({ ...labelDe });\n      }\n    }\n  }\n\n  function appendLinkIconsToHead() {\n    let head: HTMLElement = document.head;\n    let linkIcons: HTMLElement | null = head.querySelector('#ngp-image-picker-icons-id');\n    if (linkIcons) return;\n    let link = document.createElement('link');\n    link.href = 'https://fonts.googleapis.com/icon?family=Material+Icons';\n    link.rel = 'stylesheet';\n    link.id = 'ngp-image-picker-icons-id';\n    head.appendChild(link);\n  }\n\n\n  function onUpload(event: any) {\n    event.preventDefault();\n    imagePicker?.current?.click();\n  }\n\n  function handleFileSelect(this: typeof handleFileSelect, event: any) {\n    const files = event.target?.files;\n    if (files) {\n      const file = files[0];\n      imageName.current = file.name.split('.')[0];\n      fileType.current = file.type;\n      if (!fileType.current.includes('image')) return;\n      urlImage.current = `data:${file.type};base64,`;\n      if (file) {\n        setState({ ...state, format: fileType.current.split('image/')[1] })\n        const reader = new FileReader();\n        reader.onload = handleReaderLoaded.bind(this);\n        reader.readAsBinaryString(file);\n      }\n    }\n  }\n\n  async function handleReaderLoaded(readerEvt: any) {\n    const binaryString = readerEvt.target.result;\n    const base64textString = btoa(binaryString);\n    let newState = { ...state };\n    let newImageSrc = urlImage.current + base64textString;\n    newState.originImageSrc = urlImage.current + base64textString;\n    if (configuration.compressInitial) {\n      newState = {\n        ...newState,\n        quality: Math.min(configuration.compressInitial || 92, 100),\n        maintainAspectRatio: true,\n        format: 'jpeg',\n      };\n      let result = await convertImageUsingCanvas(newState.originImageSrc as string, false, newState, { getDimFromImage: true });\n      setState(result.state);\n      setImageSrc(result.imageUri);\n      imageChanged(result.imageUri);\n      setLoadImage(true);\n    } else {\n      let img = document.createElement('img');\n      img.src = newImageSrc;\n      img.onload = () => {\n        newState.arrayCopiedImages = [];\n        newState.maxHeight = img.height;\n        newState.maxWidth = img.width;\n        newState.format = fileType.current.split('image/')[1];\n        newState.arrayCopiedImages.push({\n          lastImage: newImageSrc,\n          width: img.width,\n          height: img.height,\n          quality: newState.quality,\n          format: fileType.current.split('image/')[1],\n          originImageSrc: newState.originImageSrc as string,\n        });\n        setState(newState);\n        setImageSrc(newImageSrc);\n        imageChanged(newImageSrc);\n        setLoadImage(true);\n      };\n    }\n  }\n\n  const sizeImage = useMemo(() => {\n    if (imageSrc && imageSrc.length) {\n      return Math.ceil(((3 / 4) * imageSrc.length) / 1024);\n    } else {\n      return '';\n    }\n  }, [imageSrc])\n\n  function parseToBase64(imageUrl: string): Promise<{ imageUri: string; state: IState }> {\n    let newState = { ...state };\n    let types = imageUrl.split('.');\n    let type = types[types.length - 1];\n    if (type && (type == 'png' || type == 'jpeg' || type == 'webp')) {\n      type = type;\n    } else {\n      type = 'jpeg';\n    }\n    newState.format = type;\n\n    return new Promise((resolve, reject) => {\n      let img = new Image();\n      img.crossOrigin = 'Anonymous';\n      newState.maxHeight = img.height;\n      newState.maxWidth = img.width;\n\n      img.onload = () => {\n        let canvas = document.createElement('canvas');\n        let ctx: any = canvas.getContext('2d');\n        let ratio = 1.0;\n        canvas.width = img.width * ratio;\n        canvas.height = img.height * ratio;\n        ctx.drawImage(img, 0, 0, canvas.width, canvas.height);\n        let dataURI = canvas.toDataURL(`image/${type}`, newState.quality);\n        return resolve({\n          dataUri: dataURI,\n          width: canvas.width,\n          height: canvas.height,\n        });\n      };\n      img.onerror = (e: any) => {\n        return reject(e.message || `Error loading the src = ${imageUrl}`)\n      }\n      img.src = imageUrl;\n    }).then((data: any) => {\n      newState = {\n        ...newState,\n        maxHeight: data.height,\n        maxWidth: data.width,\n      };\n      return { imageUri: data.dataUri, state: newState };\n    });\n  }\n\n  function onOpenEditPanel() {\n    setShowEditPanel(true);\n  }\n\n  function onCloseEditPanel(data: any) {\n    setShowEditPanel(false);\n    if (data) {\n      setState(data.state)\n      setImageSrc(data.imageSrc);\n      imageChanged(data.imageSrc);\n    }\n  }\n\n  function onRemove() {\n    setImageSrc(null);\n    setLoadImage(false);\n    imageChanged(null);\n    const newState: IState = {\n      ...state,\n      originImageSrc: '',\n      format: 'jpeg',\n      maxHeight: 1000,\n      maxWidth: 1000,\n      cropHeight: 150,\n      cropWidth: 150,\n      maintainAspectRatio: true,\n      arrayCopiedImages: [],\n      basicFilters: undefined,\n      quality: 92,\n    };\n    setState(newState);\n    setShowEditPanel(false)\n\n  }\n\n  return <div className=\"ReactImagePickerEditor\">\n    {!loadImage &&\n      <div className=\"place-image\">\n        <div className=\"image-holder\"\n          style={{\n            width: configuration.width,\n            height: configuration.height,\n            borderRadius: configuration.borderRadius,\n            aspectRatio: configuration.aspectRatio + '',\n          }}\n        >\n          <button title={labels['Upload a image']} className=\"icon-btn image-upload-btn\" onClick={onUpload}>\n            <span className=\"material-icons\">add_a_photo</span>\n          </button>\n\n          <input ref={imagePicker} type=\"file\" style={{ \"display\": \"none\" }} id={'filePicker-' + uuidFilePicker} onChange={handleFileSelect} />\n        </div>\n      </div >\n    }\n    {loadImage &&\n      <div className=\"place-image\">\n        <div className=\"image-holder-loaded\"\n          style={{\n            width: configuration.width,\n            height: configuration.height,\n            borderRadius: configuration.borderRadius,\n            aspectRatio: configuration.aspectRatio + '',\n          }}\n        >\n          <img\n            src={imageSrc as string}\n            alt=\"image-loaded\"\n            style={{\n              borderRadius: configuration.borderRadius,\n              objectFit: configuration.objectFit\n            }}\n          />\n          <div className=\"curtain\" onClick={onUpload}>\n            <button title={labels['Upload a image']} >\n              <span className=\"material-icons\">add_a_photo</span>\n            </button>\n          </div>\n          <input ref={imagePicker} type=\"file\" style={{ \"display\": \"none\" }} id={'filePicker-' + uuidFilePicker} onChange={handleFileSelect} />\n        </div>\n        {sizeImage &&\n          <p\n            className=\"caption image-caption\"\n            style={{\n              color: sizeImage > 120 ? '#f44336' : 'unset',\n              fontWeight: sizeImage > 120 ? '500' : 'unset'\n\n            }}\n          >\n            size: {sizeImage}Kb &nbsp; {state.format}\n          </p>}\n\n\n        <div\n          style={{\n            flexDirection: 'row', 'boxSizing': 'border-box',\n            display: 'flex',\n            'placeContent': 'flex-start',\n            'alignItems': 'flex-start'\n          }}\n          className=\"editing-bar-btn\"\n        >\n          {!configuration.hideAddBtn &&\n            <button\n              className=\"icon-btn\"\n              id=\"upload-img\"\n              title={labels['Upload a image']}\n              onClick={onUpload}\n            >\n              <span className=\"material-icons\">add_a_photo</span>\n            </button>\n          }\n\n          {!configuration.hideEditBtn &&\n            <button\n              className=\"icon-btn\"\n              id=\"edit-img\"\n              title={labels['Open the editor panel']}\n              onClick={onOpenEditPanel}\n            >\n              <span className=\"material-icons\">edit</span>\n            </button>\n          }\n          {!configuration.hideDownloadBtn &&\n            <a id=\"download-img\"\n              title={labels['Download the image']}\n              href={imageSrc as string}\n              download={imageName.current}\n            >\n              <span className=\"material-icons\">cloud_download</span>\n            </a>\n          }\n\n          {!configuration.hideDeleteBtn &&\n            <button className=\"icon-btn\" id=\"delete-img\" title={labels['Remove']} onClick={() => onRemove()} >\n              <span className=\"material-icons\">delete</span>\n            </button>\n          }\n\n        </div>\n      </div>\n    }\n    {showEditPanel &&\n      <EditImage saveUpdates={onCloseEditPanel}\n        labels={labels} color={color} image={imageSrc}\n        initialState={state}></EditImage>}\n  </div >\n})\n\nexport default ReactImagePickerEditor\n"]},"metadata":{},"sourceType":"module","externalDependencies":[]}